var DragDropTouch;function triggerEvent(e,t="",i=!1,r={}){if(null!==e&&"object"==typeof e&&1===e.nodeType&&"object"==typeof e.style&&"object"==typeof e.ownerDocument&&""!=t){r.plyr=this;var n=new CustomEvent(t,{bubbles:i,detail:r});e.dispatchEvent(n)}}function assurePlaybackState(e){e&&!this.embed.hasPlayed&&(this.embed.hasPlayed=!0),this.media.paused===e&&(this.media.paused=!e,triggerEvent.call(this,this.media,e?"play":"pause"))}!function(e,t){"use strict";var i;t(document).on("click",".upload-btn",(function(r){if(r.preventDefault(),i)i.open();else{var n=t(this);i=e.media({title:"Choose an image",multiple:!1}).open().on("select",(function(){var e=i.state().get("selection").first().toJSON();if("image"==e.type){var t=e.sizes.thumbnail||e.sizes.full;n.siblings("img").attr("src",t.url),n.prev().val(e.id)}else n.siblings("input").val(e.url)}))}})),void 0!==e&&void 0!==e.hooks&&e.hooks.addFilter("hook_orderby","loopblock",(function(t){var i=[{label:"Daily count",value:"day"},{label:"Weekly count",value:"week"},{label:"Monthly count",value:"month"},{label:"Yearly count",value:"year"},{label:"All count",value:"all"},{label:"User",value:"user"},{label:"User played",value:"user_played"},{label:"User likes",value:"user_likes"},{label:"User following",value:"user_following"},{label:"User verified",value:"user_verified"}];return i=e.hooks.applyFilters("hook_loop_orderby",i),t=t.concat(i)}))}(window.wp,jQuery),function(e){"use strict";var t=(Object.defineProperty(i.prototype,"dropEffect",{get:function(){return this._dropEffect},set:function(e){this._dropEffect=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"effectAllowed",{get:function(){return this._effectAllowed},set:function(e){this._effectAllowed=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"types",{get:function(){return Object.keys(this._data)},enumerable:!0,configurable:!0}),i.prototype.clearData=function(e){null!=e?delete this._data[e.toLowerCase()]:this._data={}},i.prototype.getData=function(e){return this._data[e.toLowerCase()]||""},i.prototype.setData=function(e,t){this._data[e.toLowerCase()]=t},i.prototype.setDragImage=function(e,t,i){var n=r._instance;n._imgCustom=e,n._imgOffset={x:t,y:i}},i);function i(){this._dropEffect="move",this._effectAllowed="all",this._data={}}e.DataTransfer=t;var r=(n.getInstance=function(){return n._instance},n.prototype._touchstart=function(e){var t=this;if(this._shouldHandle(e)){if(Date.now()-this._lastClick<n._DBLCLICK&&this._dispatchEvent(e,"dblclick",e.target))return e.preventDefault(),void this._reset();this._reset();var i=this._closestDraggable(e.target);i&&(this._dispatchEvent(e,"mousemove",e.target)||this._dispatchEvent(e,"mousedown",e.target)||(this._dragSource=i,this._ptDown=this._getPoint(e),(this._lastTouch=e).preventDefault(),setTimeout((function(){t._dragSource==i&&null==t._img&&t._dispatchEvent(e,"contextmenu",i)&&t._reset()}),n._CTXMENU),n._ISPRESSHOLDMODE&&(this._pressHoldInterval=setTimeout((function(){t._isDragEnabled=!0,t._touchmove(e)}),n._PRESSHOLDAWAIT))))}},n.prototype._touchmove=function(e){var t;this._shouldCancelPressHoldMove(e)?this._reset():(this._shouldHandleMove(e)||this._shouldHandlePressHoldMove(e))&&(t=this._getTarget(e),this._dispatchEvent(e,"mousemove",t)?(this._lastTouch=e).preventDefault():(this._dragSource&&!this._img&&this._shouldStartDragging(e)&&(this._dispatchEvent(e,"dragstart",this._dragSource),this._createImage(e),this._dispatchEvent(e,"dragenter",t)),this._img&&((this._lastTouch=e).preventDefault(),this._dispatchEvent(e,"drag",this._dragSource),t!=this._lastTarget&&(this._dispatchEvent(this._lastTouch,"dragleave",this._lastTarget),this._dispatchEvent(e,"dragenter",t),this._lastTarget=t),this._moveImage(e),this._isDropZone=this._dispatchEvent(e,"dragover",t))))},n.prototype._touchend=function(e){this._shouldHandle(e)&&(this._dispatchEvent(this._lastTouch,"mouseup",e.target)?e.preventDefault():(this._img||(this._dragSource=null,this._dispatchEvent(this._lastTouch,"click",e.target),this._lastClick=Date.now()),this._destroyImage(),this._dragSource&&(e.type.indexOf("cancel")<0&&this._isDropZone&&this._dispatchEvent(this._lastTouch,"drop",this._lastTarget),this._dispatchEvent(this._lastTouch,"dragend",this._dragSource),this._reset())))},n.prototype._shouldHandle=function(e){return e&&!e.defaultPrevented&&e.touches&&e.touches.length<2},n.prototype._shouldHandleMove=function(e){return!n._ISPRESSHOLDMODE&&this._shouldHandle(e)},n.prototype._shouldHandlePressHoldMove=function(e){return n._ISPRESSHOLDMODE&&this._isDragEnabled&&e&&e.touches&&e.touches.length},n.prototype._shouldCancelPressHoldMove=function(e){return n._ISPRESSHOLDMODE&&!this._isDragEnabled&&this._getDelta(e)>n._PRESSHOLDMARGIN},n.prototype._shouldStartDragging=function(e){return e=this._getDelta(e),n._THRESHOLD<e||n._ISPRESSHOLDMODE&&n._PRESSHOLDTHRESHOLD<=e},n.prototype._reset=function(){this._destroyImage(),this._dragSource=null,this._lastTouch=null,this._lastTarget=null,this._ptDown=null,this._isDragEnabled=!1,this._isDropZone=!1,this._dataTransfer=new t,clearInterval(this._pressHoldInterval)},n.prototype._getPoint=function(e,t){return e&&e.touches&&(e=e.touches[0]),{x:t?e.pageX:e.clientX,y:t?e.pageY:e.clientY}},n.prototype._getDelta=function(e){return n._ISPRESSHOLDMODE&&!this._ptDown?0:(e=this._getPoint(e),Math.abs(e.x-this._ptDown.x)+Math.abs(e.y-this._ptDown.y))},n.prototype._getTarget=function(e){e=this._getPoint(e);for(var t=document.elementFromPoint(e.x,e.y);t&&"none"==getComputedStyle(t).pointerEvents;)t=t.parentElement;return t},n.prototype._createImage=function(e){this._img&&this._destroyImage();var t,i=this._imgCustom||this._dragSource;this._img=i.cloneNode(!0),this._copyStyle(i,this._img),this._img.style.top=this._img.style.left="-9999px",this._imgCustom||(t=i.getBoundingClientRect(),i=this._getPoint(e),this._imgOffset={x:i.x-t.left,y:i.y-t.top},this._img.style.opacity=n._OPACITY.toString()),this._moveImage(e),document.body.appendChild(this._img)},n.prototype._destroyImage=function(){this._img&&this._img.parentElement&&this._img.parentElement.removeChild(this._img),this._img=null,this._imgCustom=null},n.prototype._moveImage=function(e){var t=this;requestAnimationFrame((function(){var i,r;t._img&&(i=t._getPoint(e,!0),(r=t._img.style).position="absolute",r.pointerEvents="none",r.zIndex="999999",r.left=Math.round(i.x-t._imgOffset.x)+"px",r.top=Math.round(i.y-t._imgOffset.y)+"px")}))},n.prototype._copyProps=function(e,t,i){for(var r=0;r<i.length;r++){var n=i[r];e[n]=t[n]}},n.prototype._copyStyle=function(e,t){var i,r;n._rmvAtts.forEach((function(e){t.removeAttribute(e)})),e instanceof HTMLCanvasElement&&(i=e,(r=t).width=i.width,r.height=i.height,r.getContext("2d").drawImage(i,0,0));for(var a=getComputedStyle(e),s=0;s<a.length;s++){var o=a[s];o.indexOf("transition")<0&&(t.style[o]=a[o])}for(t.style.pointerEvents="none",s=0;s<e.children.length;s++)this._copyStyle(e.children[s],t.children[s])},n.prototype._dispatchEvent=function(e,t,i){if(e&&i){var r=document.createEvent("Event"),a=e.touches?e.touches[0]:e;return r.initEvent(t,!0,!0),r.button=0,r.which=r.buttons=1,this._copyProps(r,e,n._kbdProps),this._copyProps(r,a,n._ptProps),r.dataTransfer=this._dataTransfer,i.dispatchEvent(r),r.defaultPrevented}return!1},n.prototype._closestDraggable=function(e){for(;e;e=e.parentElement)if(e.hasAttribute("draggable")&&e.draggable)return e;return null},n);function n(){if(this._lastClick=0,n._instance)throw"DragDropTouch instance already created.";var e,t,i,r,a,s=!1;document.addEventListener("test",(function(){}),{get passive(){return s=!0}}),navigator.maxTouchPoints&&(e=document,t=this._touchstart.bind(this),i=this._touchmove.bind(this),r=this._touchend.bind(this),a=!!s&&{passive:!1,capture:!1},e.addEventListener("touchstart",t,a),e.addEventListener("touchmove",i,a),e.addEventListener("touchend",r),e.addEventListener("touchcancel",r))}r._instance=new r,r._THRESHOLD=5,r._OPACITY=.5,r._DBLCLICK=500,r._CTXMENU=900,r._ISPRESSHOLDMODE=!1,r._PRESSHOLDAWAIT=400,r._PRESSHOLDMARGIN=25,r._PRESSHOLDTHRESHOLD=0,r._rmvAtts="id,class,style,draggable".split(","),r._kbdProps="altKey,ctrlKey,metaKey,shiftKey".split(","),r._ptProps="pageX,pageY,clientX,clientY,screenX,screenY,offsetX,offsetY".split(","),e.DragDropTouch=r}(DragDropTouch=DragDropTouch||{}),function(e,t){"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?module.exports=t():e.sortable=t()}(this,(function(){"use strict";var e,t,i=[],r=[],n=function(e,t,i){return void 0===i?e&&e.h5s&&e.h5s.data&&e.h5s.data[t]:(e.h5s=e.h5s||{},e.h5s.data=e.h5s.data||{},void(e.h5s.data[t]=i))},a=function(e,t){return(e.matches||e.matchesSelector||e.msMatchesSelector||e.mozMatchesSelector||e.webkitMatchesSelector||e.oMatchesSelector).call(e,t)},s=function(e,t){if(!t)return Array.prototype.slice.call(e);for(var i=[],r=0;r<e.length;++r)"string"==typeof t&&a(e[r],t)&&i.push(e[r]),-1!==t.indexOf(e[r])&&i.push(e[r]);return i},o=function(e,t,i){if(e instanceof Array)for(var r=0;r<e.length;++r)o(e[r],t,i);else e.addEventListener(t,i),e.h5s=e.h5s||{},e.h5s.events=e.h5s.events||{},e.h5s.events[t]=i},l=function(e,t){if(e instanceof Array)for(var i=0;i<e.length;++i)l(e[i],t);else e.h5s&&e.h5s.events&&e.h5s.events[t]&&(e.removeEventListener(t,e.h5s.events[t]),delete e.h5s.events[t])},d=function(e,t,i){if(e instanceof Array)for(var r=0;r<e.length;++r)d(e[r],t,i);else e.setAttribute(t,i)},u=function(e,t){if(e instanceof Array)for(var i=0;i<e.length;++i)u(e[i],t);else e.removeAttribute(t)},c=function(e){var t=e.getClientRects()[0];return{left:t.left+window.scrollX,top:t.top+window.scrollY}},h=function(e){l(e,"dragstart"),l(e,"dragend"),l(e,"selectstart"),l(e,"dragover"),l(e,"dragenter"),l(e,"drop")},f=function(e){l(e,"dragover"),l(e,"dragenter"),l(e,"drop")},p=function(e,t){var i=function(e){return{draggedItem:e}}(t);(function(e,t){e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("text","arbitrary-content"),e.dataTransfer.setDragImage&&e.dataTransfer.setDragImage(t.draggedItem,t.x,t.y)})(e,i=function(e,t){return t.x||(t.x=parseInt(e.pageX-c(t.draggedItem).left)),t.y||(t.y=parseInt(e.pageY-c(t.draggedItem).top)),t}(e,i))},m=function(e,t){return e===t||void 0!==n(e,"connectWith")&&n(e,"connectWith")===n(t,"connectWith")},g=function(e,t){var i,r=[];if(!t)return e;for(var n=0;n<e.length;++n)i=e[n].querySelectorAll(t),r=r.concat(Array.prototype.slice.call(i));return r},v=function(e){var t=n(e,"opts")||{},i=s(A(e),t.items),r=g(i,t.handle);f(e),function(e){(function(e){e.h5s&&delete e.h5s.data})(e),u(e,"aria-dropeffect")}(e),l(r,"mousedown"),h(i),function(e){u(e,"aria-grabbed"),u(e,"draggable"),u(e,"role")}(i)},y=function(e){var t=n(e,"opts"),i=s(A(e),t.items),r=g(i,t.handle);d(e,"aria-dropeffect","move"),n(e,"_disabled","false"),d(r,"draggable","true"),"function"!=typeof(document||window.document).createElement("span").dragDrop||t.disableIEFix||o(r,"mousedown",(function(){if(-1!==i.indexOf(this))this.dragDrop();else{for(var e=this.parentElement;-1===i.indexOf(e);)e=e.parentElement;e.dragDrop()}}))},b=function(e){var t=n(e,"opts"),i=s(A(e),t.items),r=g(i,t.handle);n(e,"_disabled","false"),h(i),l(r,"mousedown"),f(e)},w=function(e){return e.parentElement?Array.prototype.indexOf.call(e.parentElement.children,e):0},_=function(e){return!!e.parentNode},T=function(e,t){e.parentElement.insertBefore(t,e.nextElementSibling)},E=function(e){e.parentNode&&e.parentNode.removeChild(e)},S=function(e,t){var i=document.createEvent("Event");return t&&(i.detail=t),i.initEvent(e,!1,!0),i},k=function(e,t){r.forEach((function(i){m(e,i)&&i.dispatchEvent(t)}))},A=function(e){return e.children},C=function(e){return s(A(e),n(e,"items"))},R=function(l,u){var h=String(u);if((u=function(e){var t={connectWith:!1,placeholder:null,disableIEFix:!1,placeholderClass:"sortable-placeholder",draggingClass:"sortable-dragging",hoverClass:!1,debounce:0,maxItems:0};for(var i in e)t[i]=e[i];return t}(u))&&"function"==typeof u.getChildren&&(A=u.getChildren),"string"==typeof l&&(l=document.querySelectorAll(l)),l instanceof window.Element&&(l=[l]),l=Array.prototype.slice.call(l),/serialize/.test(h)){var f=[];return l.forEach((function(e){f.push({list:e,children:C(e)})})),f}return l.forEach((function(l){if(/enable|disable|destroy/.test(h))return R[h](l);u=n(l,"opts")||u,n(l,"opts",u),b(l);var f,g,v,L,D=s(A(l),u.items),x=u.placeholder;if(x||(x=document.createElement(/^ul|ol$/i.test(l.tagName)?"li":"div")),(x=function(e,t){if("string"!=typeof e)return e;var i=document.createElement(t);return i.innerHTML=e,i.firstChild}(x,l.tagName)).classList.add.apply(x.classList,u.placeholderClass.split(" ")),!l.getAttribute("data-sortable-id")){var O=r.length;r[O]=l,d(l,"data-sortable-id",O),d(D,"data-item-sortable-id",O)}if(n(l,"items",u.items),i.push(x),u.connectWith&&n(l,"connectWith",u.connectWith),y(l),d(D,"role","option"),d(D,"aria-grabbed","false"),u.hoverClass){var P="sortable-over";"string"==typeof u.hoverClass&&(P=u.hoverClass),o(D,"mouseenter",(function(){this.classList.add(P)})),o(D,"mouseleave",(function(){this.classList.remove(P)}))}u.maxItems&&"number"==typeof u.maxItems&&(L=u.maxItems),o(D,"dragstart",(function(i){i.stopImmediatePropagation(),u.handle&&!a(i.target,u.handle)||"false"===this.getAttribute("draggable")||(p(i,this),this.classList.add(u.draggingClass),d(e=this,"aria-grabbed","true"),f=w(e),t=parseInt(window.getComputedStyle(e).height),g=this.parentElement,v=C(g),k(l,S("sortstart",{item:e,placeholder:x,startparent:g})))})),o(D,"dragend",(function(){var r;e&&(e.classList.remove(u.draggingClass),d(e,"aria-grabbed","false"),e.style.display=e.oldDisplay,delete e.oldDisplay,i.forEach(E),r=this.parentElement,k(l,S("sortstop",{item:e,startparent:g})),f===w(e)&&g===r||k(l,S("sortupdate",{item:e,index:s(A(r),n(r,"items")).indexOf(e),oldindex:D.indexOf(e),elementIndex:w(e),oldElementIndex:f,startparent:g,endparent:r,newEndList:C(r),newStartList:C(g),oldStartList:v})),e=null,t=null)})),o([l,x],"drop",(function(t){var r;m(l,e.parentElement)&&(t.preventDefault(),t.stopPropagation(),r=i.filter(_)[0],T(r,e),e.dispatchEvent(S("dragend")))}));var I=function(e,t,i){var r=null;return 0===t?e:function(){var n=i||this,a=arguments;clearTimeout(r),r=setTimeout((function(){e.apply(n,a)}),t)}}((function(r,n){if(e)if(-1!==D.indexOf(r)){var a=parseInt(window.getComputedStyle(r).height),o=w(x),l=w(r);if(u.forcePlaceholderSize&&(x.style.height=t+"px"),a>t){var d=a-t,h=c(r).top;if(o<l&&n<h+d)return;if(o>l&&n>h+a-d)return}void 0===e.oldDisplay&&(e.oldDisplay=e.style.display),"none"!==e.style.display&&(e.style.display="none"),o<l?T(r,x):function(e,t){e.parentElement.insertBefore(t,e)}(r,x),i.filter((function(e){return e!==x})).forEach(E)}else-1!==i.indexOf(r)||s(A(r),u.items).length||(i.forEach(E),r.appendChild(x))}),u.debounce),M=function(t){e&&m(l,e.parentElement)&&"true"!==n(l,"_disabled")&&(L&&s(A(l),n(l,"items")).length>=L||(t.preventDefault(),t.stopPropagation(),t.dataTransfer.dropEffect="move",I(this,t.pageY)))};o(D.concat(l),"dragover",M),o(D.concat(l),"dragenter",M)})),l};return R.destroy=function(e){v(e)},R.enable=function(e){y(e)},R.disable=function(e){!function(e){var t=n(e,"opts"),i=s(A(e),t.items),r=g(i,t.handle);d(e,"aria-dropeffect","none"),n(e,"_disabled","true"),d(r,"draggable","false"),l(r,"mousedown")}(e)},R})),"undefined"!=typeof window&&function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.Hls=t():e.Hls=t()}(this,(function(){return function(e){var t={};function i(r){if(t[r])return t[r].exports;var n=t[r]={i:r,l:!1,exports:{}};return e[r].call(n.exports,n,n.exports,i),n.l=!0,n.exports}return i.m=e,i.c=t,i.d=function(e,t,r){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(r,n,function(t){return e[t]}.bind(null,n));return r},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/dist/",i(i.s=13)}([function(e,t,i){"use strict";i.d(t,"a",(function(){return u})),i.d(t,"b",(function(){return c}));var r=i(5);function n(){}var a={trace:n,debug:n,log:n,warn:n,info:n,error:n},s=a;function o(e,t){return"["+e+"] > "+t}var l=Object(r.a)();function d(e){var t=l.console[e];return t?function(){for(var i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];r[0]&&(r[0]=o(e,r[0])),t.apply(l.console,r)}:n}var u=function(e){if(l.console&&!0===e||"object"==typeof e){!function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];i.forEach((function(t){s[t]=e[t]?e[t].bind(e):d(t)}))}(e,"debug","log","info","warn","error");try{s.log()}catch(e){s=a}}else s=a},c=s},function(e,t,i){"use strict";t.a={MEDIA_ATTACHING:"hlsMediaAttaching",MEDIA_ATTACHED:"hlsMediaAttached",MEDIA_DETACHING:"hlsMediaDetaching",MEDIA_DETACHED:"hlsMediaDetached",BUFFER_RESET:"hlsBufferReset",BUFFER_CODECS:"hlsBufferCodecs",BUFFER_CREATED:"hlsBufferCreated",BUFFER_APPENDING:"hlsBufferAppending",BUFFER_APPENDED:"hlsBufferAppended",BUFFER_EOS:"hlsBufferEos",BUFFER_FLUSHING:"hlsBufferFlushing",BUFFER_FLUSHED:"hlsBufferFlushed",MANIFEST_LOADING:"hlsManifestLoading",MANIFEST_LOADED:"hlsManifestLoaded",MANIFEST_PARSED:"hlsManifestParsed",LEVEL_SWITCHING:"hlsLevelSwitching",LEVEL_SWITCHED:"hlsLevelSwitched",LEVEL_LOADING:"hlsLevelLoading",LEVEL_LOADED:"hlsLevelLoaded",LEVEL_UPDATED:"hlsLevelUpdated",LEVEL_PTS_UPDATED:"hlsLevelPtsUpdated",AUDIO_TRACKS_UPDATED:"hlsAudioTracksUpdated",AUDIO_TRACK_SWITCHING:"hlsAudioTrackSwitching",AUDIO_TRACK_SWITCHED:"hlsAudioTrackSwitched",AUDIO_TRACK_LOADING:"hlsAudioTrackLoading",AUDIO_TRACK_LOADED:"hlsAudioTrackLoaded",SUBTITLE_TRACKS_UPDATED:"hlsSubtitleTracksUpdated",SUBTITLE_TRACK_SWITCH:"hlsSubtitleTrackSwitch",SUBTITLE_TRACK_LOADING:"hlsSubtitleTrackLoading",SUBTITLE_TRACK_LOADED:"hlsSubtitleTrackLoaded",SUBTITLE_FRAG_PROCESSED:"hlsSubtitleFragProcessed",INIT_PTS_FOUND:"hlsInitPtsFound",FRAG_LOADING:"hlsFragLoading",FRAG_LOAD_PROGRESS:"hlsFragLoadProgress",FRAG_LOAD_EMERGENCY_ABORTED:"hlsFragLoadEmergencyAborted",FRAG_LOADED:"hlsFragLoaded",FRAG_DECRYPTED:"hlsFragDecrypted",FRAG_PARSING_INIT_SEGMENT:"hlsFragParsingInitSegment",FRAG_PARSING_USERDATA:"hlsFragParsingUserdata",FRAG_PARSING_METADATA:"hlsFragParsingMetadata",FRAG_PARSING_DATA:"hlsFragParsingData",FRAG_PARSED:"hlsFragParsed",FRAG_BUFFERED:"hlsFragBuffered",FRAG_CHANGED:"hlsFragChanged",FPS_DROP:"hlsFpsDrop",FPS_DROP_LEVEL_CAPPING:"hlsFpsDropLevelCapping",ERROR:"hlsError",DESTROYING:"hlsDestroying",KEY_LOADING:"hlsKeyLoading",KEY_LOADED:"hlsKeyLoaded",STREAM_STATE_TRANSITION:"hlsStreamStateTransition",LIVE_BACK_BUFFER_REACHED:"hlsLiveBackBufferReached"}},function(e,t,i){"use strict";var r,n;i.d(t,"b",(function(){return r})),i.d(t,"a",(function(){return n})),function(e){e.NETWORK_ERROR="networkError",e.MEDIA_ERROR="mediaError",e.KEY_SYSTEM_ERROR="keySystemError",e.MUX_ERROR="muxError",e.OTHER_ERROR="otherError"}(r||(r={})),function(e){e.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",e.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",e.KEY_SYSTEM_NO_SESSION="keySystemNoSession",e.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",e.KEY_SYSTEM_NO_INIT_DATA="keySystemNoInitData",e.MANIFEST_LOAD_ERROR="manifestLoadError",e.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",e.MANIFEST_PARSING_ERROR="manifestParsingError",e.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",e.LEVEL_LOAD_ERROR="levelLoadError",e.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",e.LEVEL_SWITCH_ERROR="levelSwitchError",e.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",e.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",e.FRAG_LOAD_ERROR="fragLoadError",e.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",e.FRAG_DECRYPT_ERROR="fragDecryptError",e.FRAG_PARSING_ERROR="fragParsingError",e.REMUX_ALLOC_ERROR="remuxAllocError",e.KEY_LOAD_ERROR="keyLoadError",e.KEY_LOAD_TIMEOUT="keyLoadTimeOut",e.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",e.BUFFER_APPEND_ERROR="bufferAppendError",e.BUFFER_APPENDING_ERROR="bufferAppendingError",e.BUFFER_STALLED_ERROR="bufferStalledError",e.BUFFER_FULL_ERROR="bufferFullError",e.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",e.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",e.INTERNAL_EXCEPTION="internalException"}(n||(n={}))},function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var r=Number.isFinite||function(e){return"number"==typeof e&&isFinite(e)}},function(e,t,i){"use strict";i.d(t,"b",(function(){return o}));var r,n=i(5),a=function(){function e(){}return e.isHeader=function(e,t){return t+10<=e.length&&73===e[t]&&68===e[t+1]&&51===e[t+2]&&e[t+3]<255&&e[t+4]<255&&e[t+6]<128&&e[t+7]<128&&e[t+8]<128&&e[t+9]<128},e.isFooter=function(e,t){return t+10<=e.length&&51===e[t]&&68===e[t+1]&&73===e[t+2]&&e[t+3]<255&&e[t+4]<255&&e[t+6]<128&&e[t+7]<128&&e[t+8]<128&&e[t+9]<128},e.getID3Data=function(t,i){for(var r=i,n=0;e.isHeader(t,i);)n+=10,n+=e._readSize(t,i+6),e.isFooter(t,i+10)&&(n+=10),i+=n;if(n>0)return t.subarray(r,r+n)},e._readSize=function(e,t){var i=0;return i=(127&e[t])<<21,i|=(127&e[t+1])<<14,(i|=(127&e[t+2])<<7)|127&e[t+3]},e.getTimeStamp=function(t){for(var i=e.getID3Frames(t),r=0;r<i.length;r++){var n=i[r];if(e.isTimeStampFrame(n))return e._readTimeStamp(n)}},e.isTimeStampFrame=function(e){return e&&"PRIV"===e.key&&"com.apple.streaming.transportStreamTimestamp"===e.info},e._getFrameData=function(t){var i=String.fromCharCode(t[0],t[1],t[2],t[3]),r=e._readSize(t,4);return{type:i,size:r,data:t.subarray(10,10+r)}},e.getID3Frames=function(t){for(var i=0,r=[];e.isHeader(t,i);){for(var n=e._readSize(t,i+6),a=(i+=10)+n;i+8<a;){var s=e._getFrameData(t.subarray(i)),o=e._decodeFrame(s);o&&r.push(o),i+=s.size+10}e.isFooter(t,i)&&(i+=10)}return r},e._decodeFrame=function(t){return"PRIV"===t.type?e._decodePrivFrame(t):"T"===t.type[0]?e._decodeTextFrame(t):"W"===t.type[0]?e._decodeURLFrame(t):void 0},e._readTimeStamp=function(e){if(8===e.data.byteLength){var t=new Uint8Array(e.data),i=1&t[3],r=(t[4]<<23)+(t[5]<<15)+(t[6]<<7)+t[7];return r/=45,i&&(r+=47721858.84),Math.round(r)}},e._decodePrivFrame=function(t){if(!(t.size<2)){var i=e._utf8ArrayToStr(t.data,!0),r=new Uint8Array(t.data.subarray(i.length+1));return{key:t.type,info:i,data:r.buffer}}},e._decodeTextFrame=function(t){if(!(t.size<2)){if("TXXX"===t.type){var i=1,r=e._utf8ArrayToStr(t.data.subarray(i),!0);i+=r.length+1;var n=e._utf8ArrayToStr(t.data.subarray(i));return{key:t.type,info:r,data:n}}var a=e._utf8ArrayToStr(t.data.subarray(1));return{key:t.type,data:a}}},e._decodeURLFrame=function(t){if("WXXX"===t.type){if(t.size<2)return;var i=1,r=e._utf8ArrayToStr(t.data.subarray(i));i+=r.length+1;var n=e._utf8ArrayToStr(t.data.subarray(i));return{key:t.type,info:r,data:n}}var a=e._utf8ArrayToStr(t.data);return{key:t.type,data:a}},e._utf8ArrayToStr=function(e,t){void 0===t&&(t=!1);var i=s();if(i){var r=i.decode(e);if(t){var n=r.indexOf("\0");return-1!==n?r.substring(0,n):r}return r.replace(/\0/g,"")}for(var a,o,l,d=e.length,u="",c=0;c<d;){if(0===(a=e[c++])&&t)return u;if(0!==a&&3!==a)switch(a>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:u+=String.fromCharCode(a);break;case 12:case 13:o=e[c++],u+=String.fromCharCode((31&a)<<6|63&o);break;case 14:o=e[c++],l=e[c++],u+=String.fromCharCode((15&a)<<12|(63&o)<<6|(63&l)<<0)}}return u},e}();function s(){var e=Object(n.a)();return r||void 0===e.TextDecoder||(r=new e.TextDecoder("utf-8")),r}var o=a._utf8ArrayToStr;t.a=a},function(e,t,i){"use strict";function r(){return"undefined"==typeof window?self:window}i.d(t,"a",(function(){return r}))},function(e,t,i){var r,n,a,s,o;r=/^((?:[a-zA-Z0-9+\-.]+:)?)(\/\/[^\/?#]*)?((?:[^\/\?#]*\/)*.*?)??(;.*?)?(\?.*?)?(#.*?)?$/,n=/^([^\/?#]*)(.*)$/,a=/(?:\/|^)\.(?=\/)/g,s=/(?:\/|^)\.\.\/(?!\.\.\/).*?(?=\/)/g,o={buildAbsoluteURL:function(e,t,i){if(i=i||{},e=e.trim(),!(t=t.trim())){if(!i.alwaysNormalize)return e;var r=o.parseURL(e);if(!r)throw new Error("Error trying to parse base URL.");return r.path=o.normalizePath(r.path),o.buildURLFromParts(r)}var a=o.parseURL(t);if(!a)throw new Error("Error trying to parse relative URL.");if(a.scheme)return i.alwaysNormalize?(a.path=o.normalizePath(a.path),o.buildURLFromParts(a)):t;var s=o.parseURL(e);if(!s)throw new Error("Error trying to parse base URL.");if(!s.netLoc&&s.path&&"/"!==s.path[0]){var l=n.exec(s.path);s.netLoc=l[1],s.path=l[2]}s.netLoc&&!s.path&&(s.path="/");var d={scheme:s.scheme,netLoc:a.netLoc,path:null,params:a.params,query:a.query,fragment:a.fragment};if(!a.netLoc&&(d.netLoc=s.netLoc,"/"!==a.path[0]))if(a.path){var u=s.path,c=u.substring(0,u.lastIndexOf("/")+1)+a.path;d.path=o.normalizePath(c)}else d.path=s.path,a.params||(d.params=s.params,a.query||(d.query=s.query));return null===d.path&&(d.path=i.alwaysNormalize?o.normalizePath(a.path):a.path),o.buildURLFromParts(d)},parseURL:function(e){var t=r.exec(e);return t?{scheme:t[1]||"",netLoc:t[2]||"",path:t[3]||"",params:t[4]||"",query:t[5]||"",fragment:t[6]||""}:null},normalizePath:function(e){for(e=e.split("").reverse().join("").replace(a,"");e.length!==(e=e.replace(s,"")).length;);return e.split("").reverse().join("")},buildURLFromParts:function(e){return e.scheme+e.netLoc+e.path+e.params+e.query+e.fragment}},e.exports=o},function(e,t,i){"use strict";var r=function(){function e(e,t){this.subtle=e,this.aesIV=t}return e.prototype.decrypt=function(e,t){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},t,e)},e}(),n=function(){function e(e,t){this.subtle=e,this.key=t}return e.prototype.expandKey=function(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])},e}(),a=function(){function e(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.initTable()}var t=e.prototype;return t.uint8ArrayToUint32Array_=function(e){for(var t=new DataView(e),i=new Uint32Array(4),r=0;r<4;r++)i[r]=t.getUint32(4*r);return i},t.initTable=function(){var e=this.sBox,t=this.invSBox,i=this.subMix,r=i[0],n=i[1],a=i[2],s=i[3],o=this.invSubMix,l=o[0],d=o[1],u=o[2],c=o[3],h=new Uint32Array(256),f=0,p=0,m=0;for(m=0;m<256;m++)h[m]=m<128?m<<1:m<<1^283;for(m=0;m<256;m++){var g=p^p<<1^p<<2^p<<3^p<<4;g=g>>>8^255&g^99,e[f]=g,t[g]=f;var v=h[f],y=h[v],b=h[y],w=257*h[g]^16843008*g;r[f]=w<<24|w>>>8,n[f]=w<<16|w>>>16,a[f]=w<<8|w>>>24,s[f]=w,w=16843009*b^65537*y^257*v^16843008*f,l[g]=w<<24|w>>>8,d[g]=w<<16|w>>>16,u[g]=w<<8|w>>>24,c[g]=w,f?(f=v^h[h[h[b^v]]],p^=h[h[p]]):f=p=1}},t.expandKey=function(e){for(var t=this.uint8ArrayToUint32Array_(e),i=!0,r=0;r<t.length&&i;)i=t[r]===this.key[r],r++;if(!i){this.key=t;var n=this.keySize=t.length;if(4!==n&&6!==n&&8!==n)throw new Error("Invalid aes key size="+n);var a,s,o,l,d=this.ksRows=4*(n+6+1),u=this.keySchedule=new Uint32Array(d),c=this.invKeySchedule=new Uint32Array(d),h=this.sBox,f=this.rcon,p=this.invSubMix,m=p[0],g=p[1],v=p[2],y=p[3];for(a=0;a<d;a++)a<n?o=u[a]=t[a]:(l=o,a%n==0?(l=h[(l=l<<8|l>>>24)>>>24]<<24|h[l>>>16&255]<<16|h[l>>>8&255]<<8|h[255&l],l^=f[a/n|0]<<24):n>6&&a%n==4&&(l=h[l>>>24]<<24|h[l>>>16&255]<<16|h[l>>>8&255]<<8|h[255&l]),u[a]=o=(u[a-n]^l)>>>0);for(s=0;s<d;s++)a=d-s,l=3&s?u[a]:u[a-4],c[s]=s<4||a<=4?l:m[h[l>>>24]]^g[h[l>>>16&255]]^v[h[l>>>8&255]]^y[h[255&l]],c[s]=c[s]>>>0}},t.networkToHostOrderSwap=function(e){return e<<24|(65280&e)<<8|(16711680&e)>>8|e>>>24},t.decrypt=function(e,t,i,r){for(var n,a,s,o,l,d,u,c,h,f,p,m,g,v,y,b,w,_=this.keySize+6,T=this.invKeySchedule,E=this.invSBox,S=this.invSubMix,k=S[0],A=S[1],C=S[2],R=S[3],L=this.uint8ArrayToUint32Array_(i),D=L[0],x=L[1],O=L[2],P=L[3],I=new Int32Array(e),M=new Int32Array(I.length),N=this.networkToHostOrderSwap;t<I.length;){for(h=N(I[t]),f=N(I[t+1]),p=N(I[t+2]),m=N(I[t+3]),l=h^T[0],d=m^T[1],u=p^T[2],c=f^T[3],g=4,v=1;v<_;v++)n=k[l>>>24]^A[d>>16&255]^C[u>>8&255]^R[255&c]^T[g],a=k[d>>>24]^A[u>>16&255]^C[c>>8&255]^R[255&l]^T[g+1],s=k[u>>>24]^A[c>>16&255]^C[l>>8&255]^R[255&d]^T[g+2],o=k[c>>>24]^A[l>>16&255]^C[d>>8&255]^R[255&u]^T[g+3],l=n,d=a,u=s,c=o,g+=4;n=E[l>>>24]<<24^E[d>>16&255]<<16^E[u>>8&255]<<8^E[255&c]^T[g],a=E[d>>>24]<<24^E[u>>16&255]<<16^E[c>>8&255]<<8^E[255&l]^T[g+1],s=E[u>>>24]<<24^E[c>>16&255]<<16^E[l>>8&255]<<8^E[255&d]^T[g+2],o=E[c>>>24]<<24^E[l>>16&255]<<16^E[d>>8&255]<<8^E[255&u]^T[g+3],g+=3,M[t]=N(n^D),M[t+1]=N(o^x),M[t+2]=N(s^O),M[t+3]=N(a^P),D=h,x=f,O=p,P=m,t+=4}return r?(w=(b=(y=M.buffer).byteLength)&&new DataView(y).getUint8(b-1))?y.slice(0,b-w):y:M.buffer},t.destroy=function(){this.key=void 0,this.keySize=void 0,this.ksRows=void 0,this.sBox=void 0,this.invSBox=void 0,this.subMix=void 0,this.invSubMix=void 0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.rcon=void 0},e}(),s=i(2),o=i(0),l=i(1),d=i(5),u=Object(d.a)(),c=function(){function e(e,t,i){var r=(void 0===i?{}:i).removePKCS7Padding,n=void 0===r||r;if(this.logEnabled=!0,this.observer=e,this.config=t,this.removePKCS7Padding=n,n)try{var a=u.crypto;a&&(this.subtle=a.subtle||a.webkitSubtle)}catch(e){}this.disableWebCrypto=!this.subtle}var t=e.prototype;return t.isSync=function(){return this.disableWebCrypto&&this.config.enableSoftwareAES},t.decrypt=function(e,t,i,s){var l=this;if(this.disableWebCrypto&&this.config.enableSoftwareAES){this.logEnabled&&(o.b.log("JS AES decrypt"),this.logEnabled=!1);var d=this.decryptor;d||(this.decryptor=d=new a),d.expandKey(t),s(d.decrypt(e,0,i,this.removePKCS7Padding))}else{this.logEnabled&&(o.b.log("WebCrypto AES decrypt"),this.logEnabled=!1);var u=this.subtle;this.key!==t&&(this.key=t,this.fastAesKey=new n(u,t)),this.fastAesKey.expandKey().then((function(n){new r(u,i).decrypt(e,n).catch((function(r){l.onWebCryptoError(r,e,t,i,s)})).then((function(e){s(e)}))})).catch((function(r){l.onWebCryptoError(r,e,t,i,s)}))}},t.onWebCryptoError=function(e,t,i,r,n){this.config.enableSoftwareAES?(o.b.log("WebCrypto Error, disable WebCrypto API"),this.disableWebCrypto=!0,this.logEnabled=!0,this.decrypt(t,i,r,n)):(o.b.error("decrypting error : "+e.message),this.observer.trigger(l.a.ERROR,{type:s.b.MEDIA_ERROR,details:s.a.FRAG_DECRYPT_ERROR,fatal:!0,reason:e.message}))},t.destroy=function(){var e=this.decryptor;e&&(e.destroy(),this.decryptor=void 0)},e}();t.a=c},function(e,t,i){"use strict";var r=Object.prototype.hasOwnProperty,n="~";function a(){}function s(e,t,i){this.fn=e,this.context=t,this.once=i||!1}function o(e,t,i,r,a){if("function"!=typeof i)throw new TypeError("The listener must be a function");var o=new s(i,r||e,a),l=n?n+t:t;return e._events[l]?e._events[l].fn?e._events[l]=[e._events[l],o]:e._events[l].push(o):(e._events[l]=o,e._eventsCount++),e}function l(e,t){0==--e._eventsCount?e._events=new a:delete e._events[t]}function d(){this._events=new a,this._eventsCount=0}Object.create&&(a.prototype=Object.create(null),(new a).__proto__||(n=!1)),d.prototype.eventNames=function(){var e,t,i=[];if(0===this._eventsCount)return i;for(t in e=this._events)r.call(e,t)&&i.push(n?t.slice(1):t);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(e)):i},d.prototype.listeners=function(e){var t=n?n+e:e,i=this._events[t];if(!i)return[];if(i.fn)return[i.fn];for(var r=0,a=i.length,s=new Array(a);r<a;r++)s[r]=i[r].fn;return s},d.prototype.listenerCount=function(e){var t=n?n+e:e,i=this._events[t];return i?i.fn?1:i.length:0},d.prototype.emit=function(e,t,i,r,a,s){var o=n?n+e:e;if(!this._events[o])return!1;var l,d,u=this._events[o],c=arguments.length;if(u.fn){switch(u.once&&this.removeListener(e,u.fn,void 0,!0),c){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,t),!0;case 3:return u.fn.call(u.context,t,i),!0;case 4:return u.fn.call(u.context,t,i,r),!0;case 5:return u.fn.call(u.context,t,i,r,a),!0;case 6:return u.fn.call(u.context,t,i,r,a,s),!0}for(d=1,l=new Array(c-1);d<c;d++)l[d-1]=arguments[d];u.fn.apply(u.context,l)}else{var h,f=u.length;for(d=0;d<f;d++)switch(u[d].once&&this.removeListener(e,u[d].fn,void 0,!0),c){case 1:u[d].fn.call(u[d].context);break;case 2:u[d].fn.call(u[d].context,t);break;case 3:u[d].fn.call(u[d].context,t,i);break;case 4:u[d].fn.call(u[d].context,t,i,r);break;default:if(!l)for(h=1,l=new Array(c-1);h<c;h++)l[h-1]=arguments[h];u[d].fn.apply(u[d].context,l)}}return!0},d.prototype.on=function(e,t,i){return o(this,e,t,i,!1)},d.prototype.once=function(e,t,i){return o(this,e,t,i,!0)},d.prototype.removeListener=function(e,t,i,r){var a=n?n+e:e;if(!this._events[a])return this;if(!t)return l(this,a),this;var s=this._events[a];if(s.fn)s.fn!==t||r&&!s.once||i&&s.context!==i||l(this,a);else{for(var o=0,d=[],u=s.length;o<u;o++)(s[o].fn!==t||r&&!s[o].once||i&&s[o].context!==i)&&d.push(s[o]);d.length?this._events[a]=1===d.length?d[0]:d:l(this,a)}return this},d.prototype.removeAllListeners=function(e){var t;return e?(t=n?n+e:e,this._events[t]&&l(this,t)):(this._events=new a,this._eventsCount=0),this},d.prototype.off=d.prototype.removeListener,d.prototype.addListener=d.prototype.on,d.prefixed=n,d.EventEmitter=d,e.exports=d},function(e,t,i){"use strict";var r=i(1),n=i(2),a=i(7),s=i(3),o=i(0),l=i(5);function d(e,t){return 255===e[t]&&240==(246&e[t+1])}function u(e,t){return 1&e[t+1]?7:9}function c(e,t){return(3&e[t+3])<<11|e[t+4]<<3|(224&e[t+5])>>>5}function h(e,t){return!!(t+1<e.length&&d(e,t))}function f(e,t){if(h(e,t)){var i=u(e,t);t+5<e.length&&(i=c(e,t));var r=t+i;if(r===e.length||r+1<e.length&&d(e,r))return!0}return!1}function p(e,t,i,a,s){if(!e.samplerate){var l=function(e,t,i,a){var s,l,d,u,c,h=navigator.userAgent.toLowerCase(),f=a,p=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];if(s=1+((192&t[i+2])>>>6),!((l=(60&t[i+2])>>>2)>p.length-1))return u=(1&t[i+2])<<2,u|=(192&t[i+3])>>>6,o.b.log("manifest codec:"+a+",ADTS data:type:"+s+",sampleingIndex:"+l+"["+p[l]+"Hz],channelConfig:"+u),/firefox/i.test(h)?l>=6?(s=5,c=new Array(4),d=l-3):(s=2,c=new Array(2),d=l):-1!==h.indexOf("android")?(s=2,c=new Array(2),d=l):(s=5,c=new Array(4),a&&(-1!==a.indexOf("mp4a.40.29")||-1!==a.indexOf("mp4a.40.5"))||!a&&l>=6?d=l-3:((a&&-1!==a.indexOf("mp4a.40.2")&&(l>=6&&1===u||/vivaldi/i.test(h))||!a&&1===u)&&(s=2,c=new Array(2)),d=l)),c[0]=s<<3,c[0]|=(14&l)>>1,c[1]|=(1&l)<<7,c[1]|=u<<3,5===s&&(c[1]|=(14&d)>>1,c[2]=(1&d)<<7,c[2]|=8,c[3]=0),{config:c,samplerate:p[l],channelCount:u,codec:"mp4a.40."+s,manifestCodec:f};e.trigger(r.a.ERROR,{type:n.b.MEDIA_ERROR,details:n.a.FRAG_PARSING_ERROR,fatal:!0,reason:"invalid ADTS sampling index:"+l})}(t,i,a,s);e.config=l.config,e.samplerate=l.samplerate,e.channelCount=l.channelCount,e.codec=l.codec,e.manifestCodec=l.manifestCodec,o.b.log("parsed codec:"+e.codec+",rate:"+l.samplerate+",nb channel:"+l.channelCount)}}function m(e){return 9216e4/e}function g(e,t,i,r,n){var a=function(e,t,i,r,n){var a,s,o=e.length;if(a=u(e,t),s=c(e,t),(s-=a)>0&&t+a+s<=o)return{headerLength:a,frameLength:s,stamp:i+r*n}}(t,i,r,n,m(e.samplerate));if(a){var s=a.stamp,o=a.headerLength,l=a.frameLength,d={unit:t.subarray(i+o,i+o+l),pts:s,dts:s};return e.samples.push(d),{sample:d,length:l+o}}}var v=i(4),y=function(){function e(e,t,i){this.observer=e,this.config=i,this.remuxer=t}var t=e.prototype;return t.resetInitSegment=function(e,t,i,r){this._audioTrack={container:"audio/adts",type:"audio",id:0,sequenceNumber:0,isAAC:!0,samples:[],len:0,manifestCodec:t,duration:r,inputTimeScale:9e4}},t.resetTimeStamp=function(){},e.probe=function(e){if(!e)return!1;for(var t=(v.a.getID3Data(e,0)||[]).length,i=e.length;t<i;t++)if(f(e,t))return o.b.log("ADTS sync word found !"),!0;return!1},t.append=function(e,t,i,r){for(var n=this._audioTrack,a=v.a.getID3Data(e,0)||[],l=v.a.getTimeStamp(a),d=Object(s.a)(l)?90*l:9e4*t,u=0,c=d,f=e.length,m=a.length,y=[{pts:c,dts:c,data:a}];m<f-1;)if(h(e,m)&&m+5<f){p(n,this.observer,e,m,n.manifestCodec);var b=g(n,e,m,d,u);if(!b){o.b.log("Unable to parse AAC frame");break}m+=b.length,c=b.sample.pts,u++}else v.a.isHeader(e,m)?(a=v.a.getID3Data(e,m),y.push({pts:c,dts:c,data:a}),m+=a.length):m++;this.remuxer.remux(n,{samples:[]},{samples:y,inputTimeScale:9e4},{samples:[]},t,i,r)},t.destroy=function(){},e}(),b=i(10),w={BitratesMap:[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],SamplingRateMap:[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],SamplesCoefficients:[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],BytesInSlot:[0,1,1,4],appendFrame:function(e,t,i,r,n){if(!(i+24>t.length)){var a=this.parseHeader(t,i);if(a&&i+a.frameLength<=t.length){var s=r+n*(9e4*a.samplesPerFrame/a.sampleRate),o={unit:t.subarray(i,i+a.frameLength),pts:s,dts:s};return e.config=[],e.channelCount=a.channelCount,e.samplerate=a.sampleRate,e.samples.push(o),{sample:o,length:a.frameLength}}}},parseHeader:function(e,t){var i=e[t+1]>>3&3,r=e[t+1]>>1&3,n=e[t+2]>>4&15,a=e[t+2]>>2&3,s=e[t+2]>>1&1;if(1!==i&&0!==n&&15!==n&&3!==a){var o=3===i?3-r:3===r?3:4,l=1e3*w.BitratesMap[14*o+n-1],d=3===i?0:2===i?1:2,u=w.SamplingRateMap[3*d+a],c=e[t+3]>>6==3?1:2,h=w.SamplesCoefficients[i][r],f=w.BytesInSlot[r],p=8*h*f;return{sampleRate:u,channelCount:c,frameLength:parseInt(h*l/u+s,10)*f,samplesPerFrame:p}}},isHeaderPattern:function(e,t){return 255===e[t]&&224==(224&e[t+1])&&0!=(6&e[t+1])},isHeader:function(e,t){return!!(t+1<e.length&&this.isHeaderPattern(e,t))},probe:function(e,t){if(t+1<e.length&&this.isHeaderPattern(e,t)){var i=this.parseHeader(e,t),r=4;i&&i.frameLength&&(r=i.frameLength);var n=t+r;if(n===e.length||n+1<e.length&&this.isHeaderPattern(e,n))return!0}return!1}},_=w,T=function(){function e(e){this.data=e,this.bytesAvailable=e.byteLength,this.word=0,this.bitsAvailable=0}var t=e.prototype;return t.loadWord=function(){var e=this.data,t=this.bytesAvailable,i=e.byteLength-t,r=new Uint8Array(4),n=Math.min(4,t);if(0===n)throw new Error("no bytes available");r.set(e.subarray(i,i+n)),this.word=new DataView(r.buffer).getUint32(0),this.bitsAvailable=8*n,this.bytesAvailable-=n},t.skipBits=function(e){var t;this.bitsAvailable>e?(this.word<<=e,this.bitsAvailable-=e):(e-=this.bitsAvailable,e-=(t=e>>3)>>3,this.bytesAvailable-=t,this.loadWord(),this.word<<=e,this.bitsAvailable-=e)},t.readBits=function(e){var t=Math.min(this.bitsAvailable,e),i=this.word>>>32-t;return e>32&&o.b.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=t,this.bitsAvailable>0?this.word<<=t:this.bytesAvailable>0&&this.loadWord(),(t=e-t)>0&&this.bitsAvailable?i<<t|this.readBits(t):i},t.skipLZ=function(){var e;for(e=0;e<this.bitsAvailable;++e)if(0!=(this.word&2147483648>>>e))return this.word<<=e,this.bitsAvailable-=e,e;return this.loadWord(),e+this.skipLZ()},t.skipUEG=function(){this.skipBits(1+this.skipLZ())},t.skipEG=function(){this.skipBits(1+this.skipLZ())},t.readUEG=function(){var e=this.skipLZ();return this.readBits(e+1)-1},t.readEG=function(){var e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)},t.readBoolean=function(){return 1===this.readBits(1)},t.readUByte=function(){return this.readBits(8)},t.readUShort=function(){return this.readBits(16)},t.readUInt=function(){return this.readBits(32)},t.skipScalingList=function(e){var t,i=8,r=8;for(t=0;t<e;t++)0!==r&&(r=(i+this.readEG()+256)%256),i=0===r?i:r},t.readSPS=function(){var e,t,i,r,n,a,s,o=0,l=0,d=0,u=0,c=this.readUByte.bind(this),h=this.readBits.bind(this),f=this.readUEG.bind(this),p=this.readBoolean.bind(this),m=this.skipBits.bind(this),g=this.skipEG.bind(this),v=this.skipUEG.bind(this),y=this.skipScalingList.bind(this);if(c(),e=c(),h(5),m(3),c(),v(),100===e||110===e||122===e||244===e||44===e||83===e||86===e||118===e||128===e){var b=f();if(3===b&&m(1),v(),v(),m(1),p())for(a=3!==b?8:12,s=0;s<a;s++)p()&&y(s<6?16:64)}v();var w=f();if(0===w)f();else if(1===w)for(m(1),g(),g(),t=f(),s=0;s<t;s++)g();v(),m(1),i=f(),r=f(),0===(n=h(1))&&m(1),m(1),p()&&(o=f(),l=f(),d=f(),u=f());var _=[1,1];if(p()&&p())switch(c()){case 1:_=[1,1];break;case 2:_=[12,11];break;case 3:_=[10,11];break;case 4:_=[16,11];break;case 5:_=[40,33];break;case 6:_=[24,11];break;case 7:_=[20,11];break;case 8:_=[32,11];break;case 9:_=[80,33];break;case 10:_=[18,11];break;case 11:_=[15,11];break;case 12:_=[64,33];break;case 13:_=[160,99];break;case 14:_=[4,3];break;case 15:_=[3,2];break;case 16:_=[2,1];break;case 255:_=[c()<<8|c(),c()<<8|c()]}return{width:Math.ceil(16*(i+1)-2*o-2*l),height:(2-n)*(r+1)*16-(n?2:4)*(d+u),pixelRatio:_}},t.readSliceType=function(){return this.readUByte(),this.readUEG(),this.readUEG()},e}(),E=function(){function e(e,t,i,r){this.decryptdata=i,this.discardEPB=r,this.decrypter=new a.a(e,t,{removePKCS7Padding:!1})}var t=e.prototype;return t.decryptBuffer=function(e,t){this.decrypter.decrypt(e,this.decryptdata.key.buffer,this.decryptdata.iv.buffer,t)},t.decryptAacSample=function(e,t,i,r){var n=e[t].unit,a=n.subarray(16,n.length-n.length%16),s=a.buffer.slice(a.byteOffset,a.byteOffset+a.length),o=this;this.decryptBuffer(s,(function(a){a=new Uint8Array(a),n.set(a,16),r||o.decryptAacSamples(e,t+1,i)}))},t.decryptAacSamples=function(e,t,i){for(;;t++){if(t>=e.length)return void i();if(!(e[t].unit.length<32)){var r=this.decrypter.isSync();if(this.decryptAacSample(e,t,i,r),!r)return}}},t.getAvcEncryptedData=function(e){for(var t=16*Math.floor((e.length-48)/160)+16,i=new Int8Array(t),r=0,n=32;n<=e.length-16;n+=160,r+=16)i.set(e.subarray(n,n+16),r);return i},t.getAvcDecryptedUnit=function(e,t){t=new Uint8Array(t);for(var i=0,r=32;r<=e.length-16;r+=160,i+=16)e.set(t.subarray(i,i+16),r);return e},t.decryptAvcSample=function(e,t,i,r,n,a){var s=this.discardEPB(n.data),o=this.getAvcEncryptedData(s),l=this;this.decryptBuffer(o.buffer,(function(o){n.data=l.getAvcDecryptedUnit(s,o),a||l.decryptAvcSamples(e,t,i+1,r)}))},t.decryptAvcSamples=function(e,t,i,r){for(;;t++,i=0){if(t>=e.length)return void r();for(var n=e[t].units;!(i>=n.length);i++){var a=n[i];if(!(a.length<=48||1!==a.type&&5!==a.type)){var s=this.decrypter.isSync();if(this.decryptAvcSample(e,t,i,r,a,s),!s)return}}}},e}(),S={video:1,audio:2,id3:3,text:4},k=function(){function e(e,t,i,r){this.observer=e,this.config=i,this.typeSupported=r,this.remuxer=t,this.sampleAes=null}var t=e.prototype;return t.setDecryptData=function(e){null!=e&&null!=e.key&&"SAMPLE-AES"===e.method?this.sampleAes=new E(this.observer,this.config,e,this.discardEPB):this.sampleAes=null},e.probe=function(t){var i=e._syncOffset(t);return!(i<0||(i&&o.b.warn("MPEG2-TS detected but first sync word found @ offset "+i+", junk ahead ?"),0))},e._syncOffset=function(e){for(var t=Math.min(1e3,e.length-564),i=0;i<t;){if(71===e[i]&&71===e[i+188]&&71===e[i+376])return i;i++}return-1},e.createTrack=function(e,t){return{container:"video"===e||"audio"===e?"video/mp2t":void 0,type:e,id:S[e],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:"video"===e?0:void 0,isAAC:"audio"===e||void 0,duration:"audio"===e?t:void 0}},t.resetInitSegment=function(t,i,r,n){this.pmtParsed=!1,this._pmtId=-1,this._avcTrack=e.createTrack("video",n),this._audioTrack=e.createTrack("audio",n),this._id3Track=e.createTrack("id3",n),this._txtTrack=e.createTrack("text",n),this.aacOverFlow=null,this.aacLastPTS=null,this.avcSample=null,this.audioCodec=i,this.videoCodec=r,this._duration=n},t.resetTimeStamp=function(){},t.append=function(t,i,a,s){var l,d,u,c,h,f=t.length,p=!1;this.contiguous=a;var m=this.pmtParsed,g=this._avcTrack,v=this._audioTrack,y=this._id3Track,b=g.pid,w=v.pid,_=y.pid,T=this._pmtId,E=g.pesData,S=v.pesData,k=y.pesData,A=this._parsePAT,C=this._parsePMT,R=this._parsePES,L=this._parseAVCPES.bind(this),D=this._parseAACPES.bind(this),x=this._parseMPEGPES.bind(this),O=this._parseID3PES.bind(this),P=e._syncOffset(t);for(f-=(f+P)%188,l=P;l<f;l+=188)if(71===t[l]){if(d=!!(64&t[l+1]),u=((31&t[l+1])<<8)+t[l+2],(48&t[l+3])>>4>1){if((c=l+5+t[l+4])===l+188)continue}else c=l+4;switch(u){case b:d&&(E&&(h=R(E))&&L(h,!1),E={data:[],size:0}),E&&(E.data.push(t.subarray(c,l+188)),E.size+=l+188-c);break;case w:d&&(S&&(h=R(S))&&(v.isAAC?D(h):x(h)),S={data:[],size:0}),S&&(S.data.push(t.subarray(c,l+188)),S.size+=l+188-c);break;case _:d&&(k&&(h=R(k))&&O(h),k={data:[],size:0}),k&&(k.data.push(t.subarray(c,l+188)),k.size+=l+188-c);break;case 0:d&&(c+=t[c]+1),T=this._pmtId=A(t,c);break;case T:d&&(c+=t[c]+1);var I=C(t,c,!0===this.typeSupported.mpeg||!0===this.typeSupported.mp3,null!=this.sampleAes);(b=I.avc)>0&&(g.pid=b),(w=I.audio)>0&&(v.pid=w,v.isAAC=I.isAAC),(_=I.id3)>0&&(y.pid=_),p&&!m&&(o.b.log("reparse from beginning"),p=!1,l=P-188),m=this.pmtParsed=!0;break;case 17:case 8191:break;default:p=!0}}else this.observer.trigger(r.a.ERROR,{type:n.b.MEDIA_ERROR,details:n.a.FRAG_PARSING_ERROR,fatal:!1,reason:"TS packet did not start with 0x47"});E&&(h=R(E))?(L(h,!0),g.pesData=null):g.pesData=E,S&&(h=R(S))?(v.isAAC?D(h):x(h),v.pesData=null):(S&&S.size&&o.b.log("last AAC PES packet truncated,might overlap between fragments"),v.pesData=S),k&&(h=R(k))?(O(h),y.pesData=null):y.pesData=k,null==this.sampleAes?this.remuxer.remux(v,g,y,this._txtTrack,i,a,s):this.decryptAndRemux(v,g,y,this._txtTrack,i,a,s)},t.decryptAndRemux=function(e,t,i,r,n,a,s){if(e.samples&&e.isAAC){var o=this;this.sampleAes.decryptAacSamples(e.samples,0,(function(){o.decryptAndRemuxAvc(e,t,i,r,n,a,s)}))}else this.decryptAndRemuxAvc(e,t,i,r,n,a,s)},t.decryptAndRemuxAvc=function(e,t,i,r,n,a,s){if(t.samples){var o=this;this.sampleAes.decryptAvcSamples(t.samples,0,0,(function(){o.remuxer.remux(e,t,i,r,n,a,s)}))}else this.remuxer.remux(e,t,i,r,n,a,s)},t.destroy=function(){this._initPTS=this._initDTS=void 0,this._duration=0},t._parsePAT=function(e,t){return(31&e[t+10])<<8|e[t+11]},t._parsePMT=function(e,t,i,r){var n,a,s={audio:-1,avc:-1,id3:-1,isAAC:!0};for(n=t+3+((15&e[t+1])<<8|e[t+2])-4,t+=12+((15&e[t+10])<<8|e[t+11]);t<n;){switch(a=(31&e[t+1])<<8|e[t+2],e[t]){case 207:if(!r){o.b.log("unknown stream type:"+e[t]);break}case 15:-1===s.audio&&(s.audio=a);break;case 21:-1===s.id3&&(s.id3=a);break;case 219:if(!r){o.b.log("unknown stream type:"+e[t]);break}case 27:-1===s.avc&&(s.avc=a);break;case 3:case 4:i?-1===s.audio&&(s.audio=a,s.isAAC=!1):o.b.log("MPEG audio found, not supported in this browser for now");break;case 36:o.b.warn("HEVC stream type found, not supported for now");break;default:o.b.log("unknown stream type:"+e[t])}t+=5+((15&e[t+3])<<8|e[t+4])}return s},t._parsePES=function(e){var t,i,r,n,a,s,l,d,u=0,c=e.data;if(!e||0===e.size)return null;for(;c[0].length<19&&c.length>1;){var h=new Uint8Array(c[0].length+c[1].length);h.set(c[0]),h.set(c[1],c[0].length),c[0]=h,c.splice(1,1)}if(1===((t=c[0])[0]<<16)+(t[1]<<8)+t[2]){if((r=(t[4]<<8)+t[5])&&r>e.size-6)return null;if(192&(i=t[7])&&((s=536870912*(14&t[9])+4194304*(255&t[10])+16384*(254&t[11])+128*(255&t[12])+(254&t[13])/2)>4294967295&&(s-=8589934592),64&i?((l=536870912*(14&t[14])+4194304*(255&t[15])+16384*(254&t[16])+128*(255&t[17])+(254&t[18])/2)>4294967295&&(l-=8589934592),s-l>54e5&&(o.b.warn(Math.round((s-l)/9e4)+"s delta between PTS and DTS, align them"),s=l)):l=s),d=(n=t[8])+9,e.size<=d)return null;e.size-=d,a=new Uint8Array(e.size);for(var f=0,p=c.length;f<p;f++){var m=(t=c[f]).byteLength;if(d){if(d>m){d-=m;continue}t=t.subarray(d),m-=d,d=0}a.set(t,u),u+=m}return r&&(r-=n+3),{data:a,pts:s,dts:l,len:r}}return null},t.pushAccesUnit=function(e,t){if(e.units.length&&e.frame){var i=t.samples,r=i.length;if(isNaN(e.pts)){if(!r)return void t.dropped++;var n=i[r-1];e.pts=n.pts,e.dts=n.dts}!this.config.forceKeyFrameOnDiscontinuity||!0===e.key||t.sps&&(r||this.contiguous)?(e.id=r,i.push(e)):t.dropped++}e.debug.length&&o.b.log(e.pts+"/"+e.dts+":"+e.debug)},t._parseAVCPES=function(e,t){var i,r,n,a=this,s=this._avcTrack,o=this._parseAVCNALu(e.data),l=this.avcSample,d=!1,u=this.pushAccesUnit.bind(this),c=function(e,t,i,r){return{key:e,pts:t,dts:i,units:[],debug:r}};e.data=null,l&&o.length&&!s.audFound&&(u(l,s),l=this.avcSample=c(!1,e.pts,e.dts,"")),o.forEach((function(t){switch(t.type){case 1:r=!0,l||(l=a.avcSample=c(!0,e.pts,e.dts,"")),l.frame=!0;var o=t.data;if(d&&o.length>4){var h=new T(o).readSliceType();2!==h&&4!==h&&7!==h&&9!==h||(l.key=!0)}break;case 5:r=!0,l||(l=a.avcSample=c(!0,e.pts,e.dts,"")),l.key=!0,l.frame=!0;break;case 6:r=!0,(i=new T(a.discardEPB(t.data))).readUByte();for(var f=0,p=0,m=!1,g=0;!m&&i.bytesAvailable>1;){f=0;do{f+=g=i.readUByte()}while(255===g);p=0;do{p+=g=i.readUByte()}while(255===g);if(4===f&&0!==i.bytesAvailable){if(m=!0,181===i.readUByte()&&49===i.readUShort()&&1195456820===i.readUInt()&&3===i.readUByte()){var y=i.readUByte(),b=31&y,w=[y,i.readUByte()];for(n=0;n<b;n++)w.push(i.readUByte()),w.push(i.readUByte()),w.push(i.readUByte());a._insertSampleInOrder(a._txtTrack.samples,{type:3,pts:e.pts,bytes:w})}}else if(5===f&&0!==i.bytesAvailable){if(m=!0,p>16){var _=[];for(n=0;n<16;n++)_.push(i.readUByte().toString(16)),3!==n&&5!==n&&7!==n&&9!==n||_.push("-");var E=p-16,S=new Uint8Array(E);for(n=0;n<E;n++)S[n]=i.readUByte();a._insertSampleInOrder(a._txtTrack.samples,{pts:e.pts,payloadType:f,uuid:_.join(""),userDataBytes:S,userData:Object(v.b)(S.buffer)})}}else if(p<i.bytesAvailable)for(n=0;n<p;n++)i.readUByte()}break;case 7:if(r=!0,d=!0,!s.sps){var k=(i=new T(t.data)).readSPS();s.width=k.width,s.height=k.height,s.pixelRatio=k.pixelRatio,s.sps=[t.data],s.duration=a._duration;var A=t.data.subarray(1,4),C="avc1.";for(n=0;n<3;n++){var R=A[n].toString(16);R.length<2&&(R="0"+R),C+=R}s.codec=C}break;case 8:r=!0,s.pps||(s.pps=[t.data]);break;case 9:r=!1,s.audFound=!0,l&&u(l,s),l=a.avcSample=c(!1,e.pts,e.dts,"");break;case 12:r=!1;break;default:r=!1,l&&(l.debug+="unknown NAL "+t.type+" ")}l&&r&&l.units.push(t)})),t&&l&&(u(l,s),this.avcSample=null)},t._insertSampleInOrder=function(e,t){var i=e.length;if(i>0){if(t.pts>=e[i-1].pts)e.push(t);else for(var r=i-1;r>=0;r--)if(t.pts<e[r].pts){e.splice(r,0,t);break}}else e.push(t)},t._getLastNalUnit=function(){var e,t=this.avcSample;if(!t||0===t.units.length){var i=this._avcTrack.samples;t=i[i.length-1]}if(t){var r=t.units;e=r[r.length-1]}return e},t._parseAVCNALu=function(e){var t,i,r,n,a=0,s=e.byteLength,o=this._avcTrack,l=o.naluState||0,d=l,u=[],c=-1;for(-1===l&&(c=0,n=31&e[0],l=0,a=1);a<s;)if(t=e[a++],l)if(1!==l)if(t)if(1===t){if(c>=0)r={data:e.subarray(c,a-l-1),type:n},u.push(r);else{var h=this._getLastNalUnit();if(h&&(d&&a<=4-d&&h.state&&(h.data=h.data.subarray(0,h.data.byteLength-d)),(i=a-l-1)>0)){var f=new Uint8Array(h.data.byteLength+i);f.set(h.data,0),f.set(e.subarray(0,i),h.data.byteLength),h.data=f}}a<s?(c=a,n=31&e[a],l=0):l=-1}else l=0;else l=3;else l=t?0:2;else l=t?0:1;if(c>=0&&l>=0&&(r={data:e.subarray(c,s),type:n,state:l},u.push(r)),0===u.length){var p=this._getLastNalUnit();if(p){var m=new Uint8Array(p.data.byteLength+e.byteLength);m.set(p.data,0),m.set(e,p.data.byteLength),p.data=m}}return o.naluState=l,u},t.discardEPB=function(e){for(var t,i,r=e.byteLength,n=[],a=1;a<r-2;)0===e[a]&&0===e[a+1]&&3===e[a+2]?(n.push(a+2),a+=2):a++;if(0===n.length)return e;t=r-n.length,i=new Uint8Array(t);var s=0;for(a=0;a<t;s++,a++)s===n[0]&&(s++,n.shift()),i[a]=e[s];return i},t._parseAACPES=function(e){var t,i,a,s,l,d,u,c=this._audioTrack,f=e.data,v=e.pts,y=this.aacOverFlow,b=this.aacLastPTS;if(y){var w=new Uint8Array(y.byteLength+f.byteLength);w.set(y,0),w.set(f,y.byteLength),f=w}for(a=0,l=f.length;a<l-1&&!h(f,a);a++);if(!a||(a<l-1?(d="AAC PES did not start with ADTS header,offset:"+a,u=!1):(d="no ADTS header found in AAC PES",u=!0),o.b.warn("parsing error:"+d),this.observer.trigger(r.a.ERROR,{type:n.b.MEDIA_ERROR,details:n.a.FRAG_PARSING_ERROR,fatal:u,reason:d}),!u)){if(p(c,this.observer,f,a,this.audioCodec),i=0,t=m(c.samplerate),y&&b){var _=b+t;Math.abs(_-v)>1&&(o.b.log("AAC: align PTS for overlapping frames by "+Math.round((_-v)/90)),v=_)}for(;a<l;){if(h(f,a)){if(a+5<l){var T=g(c,f,a,v,i);if(T){a+=T.length,s=T.sample.pts,i++;continue}}break}a++}y=a<l?f.subarray(a,l):null,this.aacOverFlow=y,this.aacLastPTS=s}},t._parseMPEGPES=function(e){for(var t=e.data,i=t.length,r=0,n=0,a=e.pts;n<i;)if(_.isHeader(t,n)){var s=_.appendFrame(this._audioTrack,t,n,a,r);if(!s)break;n+=s.length,r++}else n++},t._parseID3PES=function(e){this._id3Track.samples.push(e)},e}(),A=function(){function e(e,t,i){this.observer=e,this.config=i,this.remuxer=t}var t=e.prototype;return t.resetInitSegment=function(e,t,i,r){this._audioTrack={container:"audio/mpeg",type:"audio",id:-1,sequenceNumber:0,isAAC:!1,samples:[],len:0,manifestCodec:t,duration:r,inputTimeScale:9e4}},t.resetTimeStamp=function(){},e.probe=function(e){var t,i,r=v.a.getID3Data(e,0);if(r&&void 0!==v.a.getTimeStamp(r))for(t=r.length,i=Math.min(e.length-1,t+100);t<i;t++)if(_.probe(e,t))return o.b.log("MPEG Audio sync word found !"),!0;return!1},t.append=function(e,t,i,r){for(var n=v.a.getID3Data(e,0),a=v.a.getTimeStamp(n),s=a?90*a:9e4*t,o=n.length,l=e.length,d=0,u=0,c=this._audioTrack,h=[{pts:s,dts:s,data:n}];o<l;)if(_.isHeader(e,o)){var f=_.appendFrame(c,e,o,s,d);if(!f)break;o+=f.length,u=f.sample.pts,d++}else v.a.isHeader(e,o)?(n=v.a.getID3Data(e,o),h.push({pts:u,dts:u,data:n}),o+=n.length):o++;this.remuxer.remux(c,{samples:[]},{samples:h,inputTimeScale:9e4},{samples:[]},t,i,r)},t.destroy=function(){},e}(),C=function(){function e(){}return e.getSilentFrame=function(e,t){switch(e){case"mp4a.40.2":if(1===t)return new Uint8Array([0,200,0,128,35,128]);if(2===t)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(1===t)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(3===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}return null},e}(),R=Math.pow(2,32)-1,L=function(){function e(){}return e.init=function(){var t;for(t in e.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]},e.types)e.types.hasOwnProperty(t)&&(e.types[t]=[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3)]);var i=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),r=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);e.HDLR_TYPES={video:i,audio:r};var n=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),a=new Uint8Array([0,0,0,0,0,0,0,0]);e.STTS=e.STSC=e.STCO=a,e.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),e.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),e.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),e.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);var s=new Uint8Array([105,115,111,109]),o=new Uint8Array([97,118,99,49]),l=new Uint8Array([0,0,0,1]);e.FTYP=e.box(e.types.ftyp,s,l,s,o),e.DINF=e.box(e.types.dinf,e.box(e.types.dref,n))},e.box=function(e){for(var t,i=Array.prototype.slice.call(arguments,1),r=8,n=i.length,a=n;n--;)r+=i[n].byteLength;for((t=new Uint8Array(r))[0]=r>>24&255,t[1]=r>>16&255,t[2]=r>>8&255,t[3]=255&r,t.set(e,4),n=0,r=8;n<a;n++)t.set(i[n],r),r+=i[n].byteLength;return t},e.hdlr=function(t){return e.box(e.types.hdlr,e.HDLR_TYPES[t])},e.mdat=function(t){return e.box(e.types.mdat,t)},e.mdhd=function(t,i){i*=t;var r=Math.floor(i/(R+1)),n=Math.floor(i%(R+1));return e.box(e.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,r>>24,r>>16&255,r>>8&255,255&r,n>>24,n>>16&255,n>>8&255,255&n,85,196,0,0]))},e.mdia=function(t){return e.box(e.types.mdia,e.mdhd(t.timescale,t.duration),e.hdlr(t.type),e.minf(t))},e.mfhd=function(t){return e.box(e.types.mfhd,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,255&t]))},e.minf=function(t){return"audio"===t.type?e.box(e.types.minf,e.box(e.types.smhd,e.SMHD),e.DINF,e.stbl(t)):e.box(e.types.minf,e.box(e.types.vmhd,e.VMHD),e.DINF,e.stbl(t))},e.moof=function(t,i,r){return e.box(e.types.moof,e.mfhd(t),e.traf(r,i))},e.moov=function(t){for(var i=t.length,r=[];i--;)r[i]=e.trak(t[i]);return e.box.apply(null,[e.types.moov,e.mvhd(t[0].timescale,t[0].duration)].concat(r).concat(e.mvex(t)))},e.mvex=function(t){for(var i=t.length,r=[];i--;)r[i]=e.trex(t[i]);return e.box.apply(null,[e.types.mvex].concat(r))},e.mvhd=function(t,i){i*=t;var r=Math.floor(i/(R+1)),n=Math.floor(i%(R+1)),a=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,r>>24,r>>16&255,r>>8&255,255&r,n>>24,n>>16&255,n>>8&255,255&n,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return e.box(e.types.mvhd,a)},e.sdtp=function(t){var i,r,n=t.samples||[],a=new Uint8Array(4+n.length);for(r=0;r<n.length;r++)i=n[r].flags,a[r+4]=i.dependsOn<<4|i.isDependedOn<<2|i.hasRedundancy;return e.box(e.types.sdtp,a)},e.stbl=function(t){return e.box(e.types.stbl,e.stsd(t),e.box(e.types.stts,e.STTS),e.box(e.types.stsc,e.STSC),e.box(e.types.stsz,e.STSZ),e.box(e.types.stco,e.STCO))},e.avc1=function(t){var i,r,n,a=[],s=[];for(i=0;i<t.sps.length;i++)n=(r=t.sps[i]).byteLength,a.push(n>>>8&255),a.push(255&n),a=a.concat(Array.prototype.slice.call(r));for(i=0;i<t.pps.length;i++)n=(r=t.pps[i]).byteLength,s.push(n>>>8&255),s.push(255&n),s=s.concat(Array.prototype.slice.call(r));var o=e.box(e.types.avcC,new Uint8Array([1,a[3],a[4],a[5],255,224|t.sps.length].concat(a).concat([t.pps.length]).concat(s))),l=t.width,d=t.height,u=t.pixelRatio[0],c=t.pixelRatio[1];return e.box(e.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,l>>8&255,255&l,d>>8&255,255&d,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),o,e.box(e.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),e.box(e.types.pasp,new Uint8Array([u>>24,u>>16&255,u>>8&255,255&u,c>>24,c>>16&255,c>>8&255,255&c])))},e.esds=function(e){var t=e.config.length;return new Uint8Array([0,0,0,0,3,23+t,0,1,0,4,15+t,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([t]).concat(e.config).concat([6,1,2]))},e.mp4a=function(t){var i=t.samplerate;return e.box(e.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount,0,16,0,0,0,0,i>>8&255,255&i,0,0]),e.box(e.types.esds,e.esds(t)))},e.mp3=function(t){var i=t.samplerate;return e.box(e.types[".mp3"],new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount,0,16,0,0,0,0,i>>8&255,255&i,0,0]))},e.stsd=function(t){return"audio"===t.type?t.isAAC||"mp3"!==t.codec?e.box(e.types.stsd,e.STSD,e.mp4a(t)):e.box(e.types.stsd,e.STSD,e.mp3(t)):e.box(e.types.stsd,e.STSD,e.avc1(t))},e.tkhd=function(t){var i=t.id,r=t.duration*t.timescale,n=t.width,a=t.height,s=Math.floor(r/(R+1)),o=Math.floor(r%(R+1));return e.box(e.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,i>>24&255,i>>16&255,i>>8&255,255&i,0,0,0,0,s>>24,s>>16&255,s>>8&255,255&s,o>>24,o>>16&255,o>>8&255,255&o,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,n>>8&255,255&n,0,0,a>>8&255,255&a,0,0]))},e.traf=function(t,i){var r=e.sdtp(t),n=t.id,a=Math.floor(i/(R+1)),s=Math.floor(i%(R+1));return e.box(e.types.traf,e.box(e.types.tfhd,new Uint8Array([0,0,0,0,n>>24,n>>16&255,n>>8&255,255&n])),e.box(e.types.tfdt,new Uint8Array([1,0,0,0,a>>24,a>>16&255,a>>8&255,255&a,s>>24,s>>16&255,s>>8&255,255&s])),e.trun(t,r.length+16+20+8+16+8+8),r)},e.trak=function(t){return t.duration=t.duration||4294967295,e.box(e.types.trak,e.tkhd(t),e.mdia(t))},e.trex=function(t){var i=t.id;return e.box(e.types.trex,new Uint8Array([0,0,0,0,i>>24,i>>16&255,i>>8&255,255&i,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))},e.trun=function(t,i){var r,n,a,s,o,l,d=t.samples||[],u=d.length,c=12+16*u,h=new Uint8Array(c);for(i+=8+c,h.set([0,0,15,1,u>>>24&255,u>>>16&255,u>>>8&255,255&u,i>>>24&255,i>>>16&255,i>>>8&255,255&i],0),r=0;r<u;r++)a=(n=d[r]).duration,s=n.size,o=n.flags,l=n.cts,h.set([a>>>24&255,a>>>16&255,a>>>8&255,255&a,s>>>24&255,s>>>16&255,s>>>8&255,255&s,o.isLeading<<2|o.dependsOn,o.isDependedOn<<6|o.hasRedundancy<<4|o.paddingValue<<1|o.isNonSync,61440&o.degradPrio,15&o.degradPrio,l>>>24&255,l>>>16&255,l>>>8&255,255&l],12+16*r);return e.box(e.types.trun,h)},e.initSegment=function(t){e.types||e.init();var i,r=e.moov(t);return(i=new Uint8Array(e.FTYP.byteLength+r.byteLength)).set(e.FTYP),i.set(r,e.FTYP.byteLength),i},e}();function D(e,t,i,r){void 0===i&&(i=1),void 0===r&&(r=!1);var n=e*t*i;return r?Math.round(n):n}function x(e,t){return void 0===t&&(t=!1),D(e,1e3,1/9e4,t)}function O(e,t){return void 0===t&&(t=1),D(e,9e4,1/t)}var P,I=O(10),M=O(.2),N=function(){function e(e,t,i,r){this.observer=e,this.config=t,this.typeSupported=i;var n=navigator.userAgent;this.isSafari=r&&r.indexOf("Apple")>-1&&n&&!n.match("CriOS"),this.ISGenerated=!1}var t=e.prototype;return t.destroy=function(){},t.resetTimeStamp=function(e){this._initPTS=this._initDTS=e},t.resetInitSegment=function(){this.ISGenerated=!1},t.remux=function(e,t,i,n,a,s,l){if(this.ISGenerated||this.generateIS(e,t,a),this.ISGenerated){var d=e.samples.length,u=t.samples.length,c=a,h=a;if(d&&u){var f=(e.samples[0].pts-t.samples[0].pts)/t.inputTimeScale;c+=Math.max(0,f),h+=Math.max(0,-f)}if(d){e.timescale||(o.b.warn("regenerate InitSegment as audio detected"),this.generateIS(e,t,a));var p,m=this.remuxAudio(e,c,s,l);u&&(m&&(p=m.endPTS-m.startPTS),t.timescale||(o.b.warn("regenerate InitSegment as video detected"),this.generateIS(e,t,a)),this.remuxVideo(t,h,s,p,l))}else if(u){var g=this.remuxVideo(t,h,s,0,l);g&&e.codec&&this.remuxEmptyAudio(e,c,s,g)}}i.samples.length&&this.remuxID3(i,a),n.samples.length&&this.remuxText(n,a),this.observer.trigger(r.a.FRAG_PARSED)},t.generateIS=function(e,t,i){var a,s,l=this.observer,d=e.samples,u=t.samples,c=this.typeSupported,h="audio/mp4",f={},p={tracks:f},m=void 0===this._initPTS;if(m&&(a=s=1/0),e.config&&d.length&&(e.timescale=e.samplerate,o.b.log("audio sampling rate : "+e.samplerate),e.isAAC||(c.mpeg?(h="audio/mpeg",e.codec=""):c.mp3&&(e.codec="mp3")),f.audio={container:h,codec:e.codec,initSegment:!e.isAAC&&c.mpeg?new Uint8Array:L.initSegment([e]),metadata:{channelCount:e.channelCount}},m&&(a=s=d[0].pts-e.inputTimeScale*i)),t.sps&&t.pps&&u.length){var g=t.inputTimeScale;t.timescale=g,f.video={container:"video/mp4",codec:t.codec,initSegment:L.initSegment([t]),metadata:{width:t.width,height:t.height}},m&&(a=Math.min(a,u[0].pts-g*i),s=Math.min(s,u[0].dts-g*i),this.observer.trigger(r.a.INIT_PTS_FOUND,{initPTS:a}))}Object.keys(f).length?(l.trigger(r.a.FRAG_PARSING_INIT_SEGMENT,p),this.ISGenerated=!0,m&&(this._initPTS=a,this._initDTS=s)):l.trigger(r.a.ERROR,{type:n.b.MEDIA_ERROR,details:n.a.FRAG_PARSING_ERROR,fatal:!1,reason:"no audio/video samples found"})},t.remuxVideo=function(e,t,i,a,s){var l,d,u,c,h,f,p,m=8,g=e.timescale,v=e.samples,y=[],b=v.length,w=this._PTSNormalize,_=this._initPTS,T=this.nextAvcDts,E=this.isSafari;if(0!==b){E&&(i|=v.length&&T&&(s&&Math.abs(t-T/g)<.1||Math.abs(v[0].pts-T-_)<g/5)),i||(T=t*g),v.forEach((function(e){e.pts=w(e.pts-_,T),e.dts=w(e.dts-_,T)})),v.sort((function(e,t){var i=e.dts-t.dts,r=e.pts-t.pts;return i||r||e.id-t.id}));var S=v.reduce((function(e,t){return Math.max(Math.min(e,t.pts-t.dts),-1*M)}),0);if(S<0){o.b.warn("PTS < DTS detected in video samples, shifting DTS by "+x(S,!0)+" ms to overcome this issue");for(var k=0;k<v.length;k++)v[k].dts+=S}var A=v[0];h=Math.max(A.dts,0),c=Math.max(A.pts,0);var C=h-T;i&&C&&(C>1?o.b.log("AVC: "+x(C,!0)+" ms hole between fragments detected,filling it"):C<-1&&o.b.log("AVC: "+x(-C,!0)+" ms overlapping between fragments detected"),h=T,v[0].dts=h,c=Math.max(c-C,T),v[0].pts=c,o.b.log("Video: PTS/DTS adjusted: "+x(c,!0)+"/"+x(h,!0)+", delta: "+x(C,!0)+" ms")),A=v[v.length-1],p=Math.max(A.dts,0),f=Math.max(A.pts,0,p),E&&(l=Math.round((p-h)/(v.length-1)));for(var R=0,D=0,O=0;O<b;O++){for(var P=v[O],I=P.units,N=I.length,F=0,U=0;U<N;U++)F+=I[U].data.length;D+=F,R+=N,P.length=F,P.dts=E?h+O*l:Math.max(P.dts,h),P.pts=Math.max(P.pts,P.dts)}var B=D+4*R+8;try{d=new Uint8Array(B)}catch(e){return void this.observer.trigger(r.a.ERROR,{type:n.b.MUX_ERROR,details:n.a.REMUX_ALLOC_ERROR,fatal:!1,bytes:B,reason:"fail allocating video mdat "+B})}var j=new DataView(d.buffer);j.setUint32(0,B),d.set(L.types.mdat,4);for(var $=0;$<b;$++){for(var H=v[$],G=H.units,q=0,K=void 0,W=0,V=G.length;W<V;W++){var Y=G[W],z=Y.data,X=Y.data.byteLength;j.setUint32(m,X),m+=4,d.set(z,m),m+=X,q+=4+X}if(E)K=Math.max(0,l*Math.round((H.pts-H.dts)/l));else{if($<b-1)l=v[$+1].dts-H.dts;else{var Q=this.config,J=H.dts-v[$>0?$-1:$].dts;if(Q.stretchShortVideoTrack){var Z=Q.maxBufferHole,ee=Math.floor(Z*g),te=(a?c+a*g:this.nextAudioPts)-H.pts;te>ee?((l=te-J)<0&&(l=J),o.b.log("It is approximately "+x(te,!1)+" ms to the next segment; using duration "+x(l,!1)+" ms for the last video frame.")):l=J}else l=J}K=Math.round(H.pts-H.dts)}y.push({size:q,duration:l,cts:K,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:H.key?2:1,isNonSync:H.key?0:1}})}this.nextAvcDts=p+l;var ie=e.dropped;if(e.nbNalu=0,e.dropped=0,y.length&&navigator.userAgent.toLowerCase().indexOf("chrome")>-1){var re=y[0].flags;re.dependsOn=2,re.isNonSync=0}e.samples=y,u=L.moof(e.sequenceNumber++,h,e),e.samples=[];var ne={data1:u,data2:d,startPTS:c/g,endPTS:(f+l)/g,startDTS:h/g,endDTS:this.nextAvcDts/g,type:"video",hasAudio:!1,hasVideo:!0,nb:y.length,dropped:ie};return this.observer.trigger(r.a.FRAG_PARSING_DATA,ne),ne}},t.remuxAudio=function(e,t,i,a){var s,l,d,u,c,h,f=e.inputTimeScale,p=e.timescale,m=f/p,g=(e.isAAC?1024:1152)*m,v=this._PTSNormalize,y=this._initPTS,b=!e.isAAC&&this.typeSupported.mpeg,w=b?0:8,_=e.samples,T=[],E=this.nextAudioPts;if(i|=_.length&&E&&(a&&Math.abs(t-E/f)<.1||Math.abs(_[0].pts-E-y)<20*g),_.forEach((function(e){e.pts=e.dts=v(e.pts-y,t*f)})),0!==(_=_.filter((function(e){return e.pts>=0}))).length){if(i||(E=a?t*f:_[0].pts),e.isAAC)for(var S=this.config.maxAudioFramesDrift,k=0,A=E;k<_.length;){var R,D=_[k];if((R=D.pts-A)<=-S*g)o.b.warn("Dropping 1 audio frame @ "+x(A,!0)+" ms due to "+x(R,!0)+" ms overlap."),_.splice(k,1);else if(R>=S*g&&R<I&&A){var O=Math.round(R/g);o.b.warn("Injecting "+O+" audio frames @ "+x(A,!0)+" ms due to "+x(A,!0)+" ms gap.");for(var P=0;P<O;P++){var M=Math.max(A,0);(l=C.getSilentFrame(e.manifestCodec||e.codec,e.channelCount))||(o.b.log("Unable to get silent frame for given audio codec; duplicating last frame instead."),l=D.unit.subarray()),_.splice(k,0,{unit:l,pts:M,dts:M}),A+=g,k++}D.pts=D.dts=A,A+=g,k++}else Math.abs(R),D.pts=D.dts=A,A+=g,k++}for(var N=_.length,F=0;N--;)F+=_[N].unit.byteLength;for(var U=0,B=_.length;U<B;U++){var j=_[U],$=j.unit,H=j.pts;if(void 0!==h)s.duration=Math.round((H-h)/m);else{var G=H-E,q=0;if(i&&e.isAAC&&G){if(G>0&&G<I)q=Math.round((H-E)/g),o.b.log(x(G,!0)+" ms hole between AAC samples detected,filling it"),q>0&&((l=C.getSilentFrame(e.manifestCodec||e.codec,e.channelCount))||(l=$.subarray()),F+=q*l.length);else if(G<-12){o.b.log("drop overlapping AAC sample, expected/parsed/delta: "+x(E,!0)+" ms / "+x(H,!0)+" ms / "+x(-G,!0)+" ms"),F-=$.byteLength;continue}H=E}if(c=H,!(F>0))return;F+=w;try{d=new Uint8Array(F)}catch(e){return void this.observer.trigger(r.a.ERROR,{type:n.b.MUX_ERROR,details:n.a.REMUX_ALLOC_ERROR,fatal:!1,bytes:F,reason:"fail allocating audio mdat "+F})}b||(new DataView(d.buffer).setUint32(0,F),d.set(L.types.mdat,4));for(var K=0;K<q;K++)(l=C.getSilentFrame(e.manifestCodec||e.codec,e.channelCount))||(o.b.log("Unable to get silent frame for given audio codec; duplicating this frame instead."),l=$.subarray()),d.set(l,w),w+=l.byteLength,s={size:l.byteLength,cts:0,duration:1024,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}},T.push(s)}d.set($,w);var W=$.byteLength;w+=W,s={size:W,cts:0,duration:0,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}},T.push(s),h=H}var V=0;if((N=T.length)>=2&&(V=T[N-2].duration,s.duration=V),N){this.nextAudioPts=E=h+m*V,e.samples=T,u=b?new Uint8Array:L.moof(e.sequenceNumber++,c/m,e),e.samples=[];var Y=c/f,z=E/f,X={data1:u,data2:d,startPTS:Y,endPTS:z,startDTS:Y,endDTS:z,type:"audio",hasAudio:!0,hasVideo:!1,nb:N};return this.observer.trigger(r.a.FRAG_PARSING_DATA,X),X}return null}},t.remuxEmptyAudio=function(e,t,i,r){var n=e.inputTimeScale,a=n/(e.samplerate?e.samplerate:n),s=this.nextAudioPts,l=(void 0!==s?s:r.startDTS*n)+this._initDTS,d=r.endDTS*n+this._initDTS,u=1024*a,c=Math.ceil((d-l)/u),h=C.getSilentFrame(e.manifestCodec||e.codec,e.channelCount);if(o.b.warn("remux empty Audio"),h){for(var f=[],p=0;p<c;p++){var m=l+p*u;f.push({unit:h,pts:m,dts:m})}e.samples=f,this.remuxAudio(e,t,i)}else o.b.trace("Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec!")},t.remuxID3=function(e){var t,i=e.samples.length,n=e.inputTimeScale,a=this._initPTS,s=this._initDTS;if(i){for(var o=0;o<i;o++)(t=e.samples[o]).pts=(t.pts-a)/n,t.dts=(t.dts-s)/n;this.observer.trigger(r.a.FRAG_PARSING_METADATA,{samples:e.samples})}e.samples=[]},t.remuxText=function(e){e.samples.sort((function(e,t){return e.pts-t.pts}));var t,i=e.samples.length,n=e.inputTimeScale,a=this._initPTS;if(i){for(var s=0;s<i;s++)(t=e.samples[s]).pts=(t.pts-a)/n;this.observer.trigger(r.a.FRAG_PARSING_USERDATA,{samples:e.samples})}e.samples=[]},t._PTSNormalize=function(e,t){var i;if(void 0===t)return e;for(i=t<e?-8589934592:8589934592;Math.abs(e-t)>4294967296;)e+=i;return e},e}(),F=function(){function e(e){this.observer=e}var t=e.prototype;return t.destroy=function(){},t.resetTimeStamp=function(){},t.resetInitSegment=function(){},t.remux=function(e,t,i,n,a,s,o,l){var d=this.observer,u="";e&&(u+="audio"),t&&(u+="video"),d.trigger(r.a.FRAG_PARSING_DATA,{data1:l,startPTS:a,startDTS:a,type:u,hasAudio:!!e,hasVideo:!!t,nb:1,dropped:0}),d.trigger(r.a.FRAG_PARSED)},e}(),U=Object(l.a)();try{P=U.performance.now.bind(U.performance)}catch(e){o.b.debug("Unable to use Performance API on this environment"),P=U.Date.now}var B=function(){function e(e,t,i,r){this.observer=e,this.typeSupported=t,this.config=i,this.vendor=r}var t=e.prototype;return t.destroy=function(){var e=this.demuxer;e&&e.destroy()},t.push=function(e,t,i,n,s,o,l,d,u,c,h,f){var p=this;if(e.byteLength>0&&null!=t&&null!=t.key&&"AES-128"===t.method){var m=this.decrypter;null==m&&(m=this.decrypter=new a.a(this.observer,this.config));var g=P();m.decrypt(e,t.key.buffer,t.iv.buffer,(function(e){var a=P();p.observer.trigger(r.a.FRAG_DECRYPTED,{stats:{tstart:g,tdecrypt:a}}),p.pushDecrypted(new Uint8Array(e),t,new Uint8Array(i),n,s,o,l,d,u,c,h,f)}))}else this.pushDecrypted(new Uint8Array(e),t,new Uint8Array(i),n,s,o,l,d,u,c,h,f)},t.pushDecrypted=function(e,t,i,a,s,o,l,d,u,c,h,f){var p=this.demuxer;if(!p||(l||d)&&!this.probe(e)){for(var m=this.observer,g=this.typeSupported,v=this.config,w=[{demux:k,remux:N},{demux:b.a,remux:F},{demux:y,remux:N},{demux:A,remux:N}],_=0,T=w.length;_<T;_++){var E=w[_],S=E.demux.probe;if(S(e)){var C=this.remuxer=new E.remux(m,v,g,this.vendor);p=new E.demux(m,C,v,g),this.probe=S;break}}if(!p)return void m.trigger(r.a.ERROR,{type:n.b.MEDIA_ERROR,details:n.a.FRAG_PARSING_ERROR,fatal:!0,reason:"no demux matching with content found"});this.demuxer=p}var R=this.remuxer;(l||d)&&(p.resetInitSegment(i,a,s,c),R.resetInitSegment()),l&&(p.resetTimeStamp(f),R.resetTimeStamp(f)),"function"==typeof p.setDecryptData&&p.setDecryptData(t),p.append(e,o,u,h)},e}();t.a=B},function(e,t,i){"use strict";var r=i(0),n=i(1),a=Math.pow(2,32)-1,s=function(){function e(e,t){this.observer=e,this.remuxer=t}var t=e.prototype;return t.resetTimeStamp=function(e){this.initPTS=e},t.resetInitSegment=function(t,i,r,a){if(t&&t.byteLength){var s=this.initData=e.parseInitSegment(t);null==i&&(i="mp4a.40.5"),null==r&&(r="avc1.42e01e");var o={};s.audio&&s.video?o.audiovideo={container:"video/mp4",codec:i+","+r,initSegment:a?t:null}:(s.audio&&(o.audio={container:"audio/mp4",codec:i,initSegment:a?t:null}),s.video&&(o.video={container:"video/mp4",codec:r,initSegment:a?t:null})),this.observer.trigger(n.a.FRAG_PARSING_INIT_SEGMENT,{tracks:o})}else i&&(this.audioCodec=i),r&&(this.videoCodec=r)},e.probe=function(t){return e.findBox({data:t,start:0,end:Math.min(t.length,16384)},["moof"]).length>0},e.bin2str=function(e){return String.fromCharCode.apply(null,e)},e.readUint16=function(e,t){e.data&&(t+=e.start,e=e.data);var i=e[t]<<8|e[t+1];return i<0?65536+i:i},e.readUint32=function(e,t){e.data&&(t+=e.start,e=e.data);var i=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3];return i<0?4294967296+i:i},e.writeUint32=function(e,t,i){e.data&&(t+=e.start,e=e.data),e[t]=i>>24,e[t+1]=i>>16&255,e[t+2]=i>>8&255,e[t+3]=255&i},e.findBox=function(t,i){var r,n,a,s,o,l,d=[];if(t.data?(o=t.start,a=t.end,t=t.data):(o=0,a=t.byteLength),!i.length)return null;for(r=o;r<a;)l=(n=e.readUint32(t,r))>1?r+n:a,e.bin2str(t.subarray(r+4,r+8))===i[0]&&(1===i.length?d.push({data:t,start:r+8,end:l}):(s=e.findBox({data:t,start:r+8,end:l},i.slice(1))).length&&(d=d.concat(s))),r=l;return d},e.parseSegmentIndex=function(t){var i,r=e.findBox(t,["moov"])[0],n=r?r.end:null,a=0,s=e.findBox(t,["sidx"]);if(!s||!s[0])return null;i=[];var o=(s=s[0]).data[0];a=0===o?8:16;var l=e.readUint32(s,a);a+=4,a+=0===o?8:16,a+=2;var d=s.end+0,u=e.readUint16(s,a);a+=2;for(var c=0;c<u;c++){var h=a,f=e.readUint32(s,h);h+=4;var p=2147483647&f;if(1==(2147483648&f)>>>31)return void console.warn("SIDX has hierarchical references (not supported)");var m=e.readUint32(s,h);h+=4,i.push({referenceSize:p,subsegmentDuration:m,info:{duration:m/l,start:d,end:d+p-1}}),d+=p,a=h+=4}return{earliestPresentationTime:0,timescale:l,version:o,referencesCount:u,references:i,moovEndOffset:n}},e.parseInitSegment=function(t){var i=[];return e.findBox(t,["moov","trak"]).forEach((function(t){var n=e.findBox(t,["tkhd"])[0];if(n){var a=n.data[n.start],s=0===a?12:20,o=e.readUint32(n,s),l=e.findBox(t,["mdia","mdhd"])[0];if(l){s=0===(a=l.data[l.start])?12:20;var d=e.readUint32(l,s),u=e.findBox(t,["mdia","hdlr"])[0];if(u){var c={soun:"audio",vide:"video"}[e.bin2str(u.data.subarray(u.start+8,u.start+12))];if(c){var h=e.findBox(t,["mdia","minf","stbl","stsd"]);if(h.length){h=h[0];var f=e.bin2str(h.data.subarray(h.start+12,h.start+16));r.b.log("MP4Demuxer:"+c+":"+f+" found")}i[o]={timescale:d,type:c},i[c]={timescale:d,id:o}}}}}})),i},e.getStartDTS=function(t,i){var r,n,a;return r=e.findBox(i,["moof","traf"]),n=[].concat.apply([],r.map((function(i){return e.findBox(i,["tfhd"]).map((function(r){var n,a;return n=e.readUint32(r,4),a=t[n].timescale||9e4,e.findBox(i,["tfdt"]).map((function(t){var i,r;return i=t.data[t.start],r=e.readUint32(t,4),1===i&&(r*=Math.pow(2,32),r+=e.readUint32(t,8)),r}))[0]/a}))}))),a=Math.min.apply(null,n),isFinite(a)?a:0},e.offsetStartDTS=function(t,i,r){e.findBox(i,["moof","traf"]).map((function(i){return e.findBox(i,["tfhd"]).map((function(n){var s=e.readUint32(n,4),o=t[s].timescale||9e4;e.findBox(i,["tfdt"]).map((function(t){var i=t.data[t.start],n=e.readUint32(t,4);if(0===i)e.writeUint32(t,4,n-r*o);else{n*=Math.pow(2,32),n+=e.readUint32(t,8),n-=r*o,n=Math.max(n,0);var s=Math.floor(n/(a+1)),l=Math.floor(n%(a+1));e.writeUint32(t,4,s),e.writeUint32(t,8,l)}}))}))}))},t.append=function(t,i,r,a){var s=this.initData;s||(this.resetInitSegment(t,this.audioCodec,this.videoCodec,!1),s=this.initData);var o,l=this.initPTS;if(void 0===l){var d=e.getStartDTS(s,t);this.initPTS=l=d-i,this.observer.trigger(n.a.INIT_PTS_FOUND,{initPTS:l})}e.offsetStartDTS(s,t,l),o=e.getStartDTS(s,t),this.remuxer.remux(s.audio,s.video,null,null,o,r,a,t)},t.destroy=function(){},e}();t.a=s},function(e,t,i){function r(e){var t={};function i(r){if(t[r])return t[r].exports;var n=t[r]={i:r,l:!1,exports:{}};return e[r].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=t,i.i=function(e){return e},i.d=function(e,t,r){i.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},i.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/",i.oe=function(e){throw console.error(e),e};var r=i(i.s=ENTRY_MODULE);return r.default||r}var n="\\(\\s*(/\\*.*?\\*/)?\\s*.*?([\\.|\\-|\\+|\\w|/|@]+).*?\\)";function a(e){return(e+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function s(e,t,r){var s={};s[r]=[];var o=t.toString(),l=o.match(/^function\s?\w*\(\w+,\s*\w+,\s*(\w+)\)/);if(!l)return s;for(var d,u=l[1],c=new RegExp("(\\\\n|\\W)"+a(u)+n,"g");d=c.exec(o);)"dll-reference"!==d[3]&&s[r].push(d[3]);for(c=new RegExp("\\("+a(u)+'\\("(dll-reference\\s([\\.|\\-|\\+|\\w|/|@]+))"\\)\\)'+n,"g");d=c.exec(o);)e[d[2]]||(s[r].push(d[1]),e[d[2]]=i(d[1]).m),s[d[2]]=s[d[2]]||[],s[d[2]].push(d[4]);for(var h,f=Object.keys(s),p=0;p<f.length;p++)for(var m=0;m<s[f[p]].length;m++)h=s[f[p]][m],isNaN(1*h)||(s[f[p]][m]=1*s[f[p]][m]);return s}function o(e){return Object.keys(e).reduce((function(t,i){return t||e[i].length>0}),!1)}e.exports=function(e,t){t=t||{};var n={main:i.m},a=t.all?{main:Object.keys(n.main)}:function(e,t){for(var i={main:[t]},r={main:[]},n={main:{}};o(i);)for(var a=Object.keys(i),l=0;l<a.length;l++){var d=a[l],u=i[d].pop();if(n[d]=n[d]||{},!n[d][u]&&e[d][u]){n[d][u]=!0,r[d]=r[d]||[],r[d].push(u);for(var c=s(e,e[d][u],d),h=Object.keys(c),f=0;f<h.length;f++)i[h[f]]=i[h[f]]||[],i[h[f]]=i[h[f]].concat(c[h[f]])}}return r}(n,e),l="";Object.keys(a).filter((function(e){return"main"!==e})).forEach((function(e){for(var t=0;a[e][t];)t++;a[e].push(t),n[e][t]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })",l=l+"var "+e+" = ("+r.toString().replace("ENTRY_MODULE",JSON.stringify(t))+")({"+a[e].map((function(t){return JSON.stringify(t)+": "+n[e][t].toString()})).join(",")+"});\n"})),l=l+"new (("+r.toString().replace("ENTRY_MODULE",JSON.stringify(e))+")({"+a.main.map((function(e){return JSON.stringify(e)+": "+n.main[e].toString()})).join(",")+"}))(self);";var d=new window.Blob([l],{type:"text/javascript"});if(t.bare)return d;var u=(window.URL||window.webkitURL||window.mozURL||window.msURL).createObjectURL(d),c=new window.Worker(u);return c.objectURL=u,c}},function(e,t,i){"use strict";i.r(t);var r=i(9),n=i(1),a=i(0),s=i(8);t.default=function(e){var t=new s.EventEmitter;t.trigger=function(e){for(var i=arguments.length,r=new Array(i>1?i-1:0),n=1;n<i;n++)r[n-1]=arguments[n];t.emit.apply(t,[e,e].concat(r))},t.off=function(e){for(var i=arguments.length,r=new Array(i>1?i-1:0),n=1;n<i;n++)r[n-1]=arguments[n];t.removeListener.apply(t,[e].concat(r))};var i=function(t,i){e.postMessage({event:t,data:i})};e.addEventListener("message",(function(n){var s=n.data;switch(s.cmd){case"init":var o=JSON.parse(s.config);e.demuxer=new r.a(t,s.typeSupported,o,s.vendor),Object(a.a)(o.debug),i("init",null);break;case"demux":e.demuxer.push(s.data,s.decryptdata,s.initSegment,s.audioCodec,s.videoCodec,s.timeOffset,s.discontinuity,s.trackSwitch,s.contiguous,s.duration,s.accurateTimeOffset,s.defaultInitPTS)}})),t.on(n.a.FRAG_DECRYPTED,i),t.on(n.a.FRAG_PARSING_INIT_SEGMENT,i),t.on(n.a.FRAG_PARSED,i),t.on(n.a.ERROR,i),t.on(n.a.FRAG_PARSING_METADATA,i),t.on(n.a.FRAG_PARSING_USERDATA,i),t.on(n.a.INIT_PTS_FOUND,i),t.on(n.a.FRAG_PARSING_DATA,(function(t,i){var r=[],n={event:t,data:i};i.data1&&(n.data1=i.data1.buffer,r.push(i.data1.buffer),delete i.data1),i.data2&&(n.data2=i.data2.buffer,r.push(i.data2.buffer),delete i.data2),e.postMessage(n,r)}))}},function(e,t,i){"use strict";i.r(t);var r={};i.r(r),i.d(r,"newCue",(function(){return mt}));var n,a,s=i(6),o=i(2),l=i(3),d=i(1),u=i(0),c={hlsEventGeneric:!0,hlsHandlerDestroying:!0,hlsHandlerDestroyed:!0},h=function(){function e(e){this.hls=void 0,this.handledEvents=void 0,this.useGenericHandler=void 0,this.hls=e,this.onEvent=this.onEvent.bind(this);for(var t=arguments.length,i=new Array(t>1?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];this.handledEvents=i,this.useGenericHandler=!0,this.registerListeners()}var t=e.prototype;return t.destroy=function(){this.onHandlerDestroying(),this.unregisterListeners(),this.onHandlerDestroyed()},t.onHandlerDestroying=function(){},t.onHandlerDestroyed=function(){},t.isEventHandler=function(){return"object"==typeof this.handledEvents&&this.handledEvents.length&&"function"==typeof this.onEvent},t.registerListeners=function(){this.isEventHandler()&&this.handledEvents.forEach((function(e){if(c[e])throw new Error("Forbidden event-name: "+e);this.hls.on(e,this.onEvent)}),this)},t.unregisterListeners=function(){this.isEventHandler()&&this.handledEvents.forEach((function(e){this.hls.off(e,this.onEvent)}),this)},t.onEvent=function(e,t){this.onEventGeneric(e,t)},t.onEventGeneric=function(e,t){try{(function(e,t){var i="on"+e.replace("hls","");if("function"!=typeof this[i])throw new Error("Event "+e+" has no generic handler in this "+this.constructor.name+" class (tried "+i+")");return this[i].bind(this,t)}).call(this,e,t).call()}catch(t){u.b.error("An internal error happened while handling event "+e+'. Error message: "'+t.message+'". Here is a stacktrace:',t),this.hls.trigger(d.a.ERROR,{type:o.b.OTHER_ERROR,details:o.a.INTERNAL_EXCEPTION,fatal:!1,event:e,err:t})}},e}();!function(e){e.MANIFEST="manifest",e.LEVEL="level",e.AUDIO_TRACK="audioTrack",e.SUBTITLE_TRACK="subtitleTrack"}(n||(n={})),function(e){e.MAIN="main",e.AUDIO="audio",e.SUBTITLE="subtitle"}(a||(a={}));var f=i(10);function p(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var m,g=function(){function e(e,t){this._uri=null,this.baseuri=void 0,this.reluri=void 0,this.method=null,this.key=null,this.iv=null,this.baseuri=e,this.reluri=t}var t,i;return t=e,(i=[{key:"uri",get:function(){return!this._uri&&this.reluri&&(this._uri=Object(s.buildAbsoluteURL)(this.baseuri,this.reluri,{alwaysNormalize:!0})),this._uri}}])&&p(t.prototype,i),e}();function v(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}!function(e){e.AUDIO="audio",e.VIDEO="video"}(m||(m={}));var y=function(){function e(){var e;this._url=null,this._byteRange=null,this._decryptdata=null,this._elementaryStreams=((e={})[m.AUDIO]=!1,e[m.VIDEO]=!1,e),this.deltaPTS=0,this.rawProgramDateTime=null,this.programDateTime=null,this.title=null,this.tagList=[],this.cc=void 0,this.type=void 0,this.relurl=void 0,this.baseurl=void 0,this.duration=void 0,this.start=void 0,this.sn=0,this.urlId=0,this.level=0,this.levelkey=void 0,this.loader=void 0}var t,i,r=e.prototype;return r.setByteRange=function(e,t){var i=e.split("@",2),r=[];1===i.length?r[0]=t?t.byteRangeEndOffset:0:r[0]=parseInt(i[1]),r[1]=parseInt(i[0])+r[0],this._byteRange=r},r.addElementaryStream=function(e){this._elementaryStreams[e]=!0},r.hasElementaryStream=function(e){return!0===this._elementaryStreams[e]},r.createInitializationVector=function(e){for(var t=new Uint8Array(16),i=12;i<16;i++)t[i]=e>>8*(15-i)&255;return t},r.setDecryptDataFromLevelKey=function(e,t){var i=e;return e&&e.method&&e.uri&&!e.iv&&((i=new g(e.baseuri,e.reluri)).method=e.method,i.iv=this.createInitializationVector(t)),i},t=e,(i=[{key:"url",get:function(){return!this._url&&this.relurl&&(this._url=Object(s.buildAbsoluteURL)(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url},set:function(e){this._url=e}},{key:"byteRange",get:function(){return this._byteRange?this._byteRange:[]}},{key:"byteRangeStartOffset",get:function(){return this.byteRange[0]}},{key:"byteRangeEndOffset",get:function(){return this.byteRange[1]}},{key:"decryptdata",get:function(){if(!this.levelkey&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkey){var e=this.sn;"number"!=typeof e&&(this.levelkey&&"AES-128"===this.levelkey.method&&!this.levelkey.iv&&u.b.warn('missing IV for initialization segment with method="'+this.levelkey.method+'" - compliance issue'),e=0),this._decryptdata=this.setDecryptDataFromLevelKey(this.levelkey,e)}return this._decryptdata}},{key:"endProgramDateTime",get:function(){if(null===this.programDateTime)return null;if(!Object(l.a)(this.programDateTime))return null;var e=Object(l.a)(this.duration)?this.duration:0;return this.programDateTime+1e3*e}},{key:"encrypted",get:function(){return!(!this.decryptdata||null===this.decryptdata.uri||null!==this.decryptdata.key)}}])&&v(t.prototype,i),e}();function b(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var w=function(){function e(e){this.endCC=0,this.endSN=0,this.fragments=[],this.initSegment=null,this.live=!0,this.needSidxRanges=!1,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=e,this.version=null}var t,i;return t=e,(i=[{key:"hasProgramDateTime",get:function(){return!(!this.fragments[0]||!Object(l.a)(this.fragments[0].programDateTime))}}])&&b(t.prototype,i),e}(),_=/^(\d+)x(\d+)$/,T=/\s*(.+?)\s*=((?:\".*?\")|.*?)(?:,|$)/g,E=function(){function e(t){for(var i in"string"==typeof t&&(t=e.parseAttrList(t)),t)t.hasOwnProperty(i)&&(this[i]=t[i])}var t=e.prototype;return t.decimalInteger=function(e){var t=parseInt(this[e],10);return t>Number.MAX_SAFE_INTEGER?1/0:t},t.hexadecimalInteger=function(e){if(this[e]){var t=(this[e]||"0x").slice(2);t=(1&t.length?"0":"")+t;for(var i=new Uint8Array(t.length/2),r=0;r<t.length/2;r++)i[r]=parseInt(t.slice(2*r,2*r+2),16);return i}return null},t.hexadecimalIntegerAsNumber=function(e){var t=parseInt(this[e],16);return t>Number.MAX_SAFE_INTEGER?1/0:t},t.decimalFloatingPoint=function(e){return parseFloat(this[e])},t.enumeratedString=function(e){return this[e]},t.decimalResolution=function(e){var t=_.exec(this[e]);if(null!==t)return{width:parseInt(t[1],10),height:parseInt(t[2],10)}},e.parseAttrList=function(e){var t,i={};for(T.lastIndex=0;null!==(t=T.exec(e));){var r=t[2];0===r.indexOf('"')&&r.lastIndexOf('"')===r.length-1&&(r=r.slice(1,-1)),i[t[1]]=r}return i},e}(),S={audio:{a3ds:!0,"ac-3":!0,"ac-4":!0,alac:!0,alaw:!0,dra1:!0,"dts+":!0,"dts-":!0,dtsc:!0,dtse:!0,dtsh:!0,"ec-3":!0,enca:!0,g719:!0,g726:!0,m4ae:!0,mha1:!0,mha2:!0,mhm1:!0,mhm2:!0,mlpa:!0,mp4a:!0,"raw ":!0,Opus:!0,samr:!0,sawb:!0,sawp:!0,sevc:!0,sqcp:!0,ssmv:!0,twos:!0,ulaw:!0},video:{avc1:!0,avc2:!0,avc3:!0,avc4:!0,avcp:!0,drac:!0,dvav:!0,dvhe:!0,encv:!0,hev1:!0,hvc1:!0,mjp2:!0,mp4v:!0,mvc1:!0,mvc2:!0,mvc3:!0,mvc4:!0,resv:!0,rv60:!0,s263:!0,svc1:!0,svc2:!0,"vc-1":!0,vp08:!0,vp09:!0}};function k(e,t){return MediaSource.isTypeSupported((t||"video")+'/mp4;codecs="'+e+'"')}var A=/#EXT-X-STREAM-INF:([^\n\r]*)[\r\n]+([^\r\n]+)/g,C=/#EXT-X-MEDIA:(.*)/g,R=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/|(?!#)([\S+ ?]+)/.source,/|#EXT-X-BYTERANGE:*(.+)/.source,/|#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/|#.*/.source].join(""),"g"),L=/(?:(?:#(EXTM3U))|(?:#EXT-X-(PLAYLIST-TYPE):(.+))|(?:#EXT-X-(MEDIA-SEQUENCE): *(\d+))|(?:#EXT-X-(TARGETDURATION): *(\d+))|(?:#EXT-X-(KEY):(.+))|(?:#EXT-X-(START):(.+))|(?:#EXT-X-(ENDLIST))|(?:#EXT-X-(DISCONTINUITY-SEQ)UENCE:(\d+))|(?:#EXT-X-(DIS)CONTINUITY))|(?:#EXT-X-(VERSION):(\d+))|(?:#EXT-X-(MAP):(.+))|(?:(#)([^:]*):(.*))|(?:(#)(.*))(?:.*)\r?\n?/,D=/\.(mp4|m4s|m4v|m4a)$/i,x=function(){function e(){}return e.findGroup=function(e,t){for(var i=0;i<e.length;i++){var r=e[i];if(r.id===t)return r}},e.convertAVC1ToAVCOTI=function(e){var t,i=e.split(".");return i.length>2?(t=i.shift()+".",t+=parseInt(i.shift()).toString(16),t+=("000"+parseInt(i.shift()).toString(16)).substr(-4)):t=e,t},e.resolve=function(e,t){return s.buildAbsoluteURL(t,e,{alwaysNormalize:!0})},e.parseMasterPlaylist=function(t,i){var r,n=[];function a(e,t){["video","audio"].forEach((function(i){var r=e.filter((function(e){return function(e,t){var i=S[t];return!!i&&!0===i[e.slice(0,4)]}(e,i)}));if(r.length){var n=r.filter((function(e){return 0===e.lastIndexOf("avc1",0)||0===e.lastIndexOf("mp4a",0)}));t[i+"Codec"]=n.length>0?n[0]:r[0],e=e.filter((function(e){return-1===r.indexOf(e)}))}})),t.unknownCodecs=e}for(A.lastIndex=0;null!=(r=A.exec(t));){var s={},o=s.attrs=new E(r[1]);s.url=e.resolve(r[2],i);var l=o.decimalResolution("RESOLUTION");l&&(s.width=l.width,s.height=l.height),s.bitrate=o.decimalInteger("AVERAGE-BANDWIDTH")||o.decimalInteger("BANDWIDTH"),s.name=o.NAME,a([].concat((o.CODECS||"").split(/[ ,]+/)),s),s.videoCodec&&-1!==s.videoCodec.indexOf("avc1")&&(s.videoCodec=e.convertAVC1ToAVCOTI(s.videoCodec)),n.push(s)}return n},e.parseMasterPlaylistMedia=function(t,i,r,n){var a;void 0===n&&(n=[]);var s=[],o=0;for(C.lastIndex=0;null!==(a=C.exec(t));){var l=new E(a[1]);if(l.TYPE===r){var d={id:o++,groupId:l["GROUP-ID"],name:l.NAME||l.LANGUAGE,type:r,default:"YES"===l.DEFAULT,autoselect:"YES"===l.AUTOSELECT,forced:"YES"===l.FORCED,lang:l.LANGUAGE};if(l.URI&&(d.url=e.resolve(l.URI,i)),n.length){var u=e.findGroup(n,d.groupId);d.audioCodec=u?u.codec:n[0].codec}s.push(d)}}return s},e.parseLevelPlaylist=function(e,t,i,r,n){var a,s,o,d=0,c=0,h=new w(t),f=0,p=null,m=new y,v=null;for(R.lastIndex=0;null!==(a=R.exec(e));){var b=a[1];if(b){m.duration=parseFloat(b);var _=(" "+a[2]).slice(1);m.title=_||null,m.tagList.push(_?["INF",b,_]:["INF",b])}else if(a[3]){if(Object(l.a)(m.duration)){var T=d++;m.type=r,m.start=c,o&&(m.levelkey=o),m.sn=T,m.level=i,m.cc=f,m.urlId=n,m.baseurl=t,m.relurl=(" "+a[3]).slice(1),O(m,p),h.fragments.push(m),p=m,c+=m.duration,m=new y}}else if(a[4]){var S=(" "+a[4]).slice(1);p?m.setByteRange(S,p):m.setByteRange(S)}else if(a[5])m.rawProgramDateTime=(" "+a[5]).slice(1),m.tagList.push(["PROGRAM-DATE-TIME",m.rawProgramDateTime]),null===v&&(v=h.fragments.length);else{if(!(a=a[0].match(L))){u.b.warn("No matches on slow regex match for level playlist!");continue}for(s=1;s<a.length&&void 0===a[s];s++);var k=(" "+a[s+1]).slice(1),A=(" "+a[s+2]).slice(1);switch(a[s]){case"#":m.tagList.push(A?[k,A]:[k]);break;case"PLAYLIST-TYPE":h.type=k.toUpperCase();break;case"MEDIA-SEQUENCE":d=h.startSN=parseInt(k);break;case"TARGETDURATION":h.targetduration=parseFloat(k);break;case"VERSION":h.version=parseInt(k);break;case"EXTM3U":break;case"ENDLIST":h.live=!1;break;case"DIS":f++,m.tagList.push(["DIS"]);break;case"DISCONTINUITY-SEQ":f=parseInt(k);break;case"KEY":var C=new E(k),x=C.enumeratedString("METHOD"),P=C.URI,I=C.hexadecimalInteger("IV");x&&(o=new g(t,P),P&&["AES-128","SAMPLE-AES","SAMPLE-AES-CENC"].indexOf(x)>=0&&(o.method=x,o.key=null,o.iv=I));break;case"START":var M=new E(k).decimalFloatingPoint("TIME-OFFSET");Object(l.a)(M)&&(h.startTimeOffset=M);break;case"MAP":var N=new E(k);m.relurl=N.URI,N.BYTERANGE&&m.setByteRange(N.BYTERANGE),m.baseurl=t,m.level=i,m.type=r,m.sn="initSegment",h.initSegment=m,(m=new y).rawProgramDateTime=h.initSegment.rawProgramDateTime;break;default:u.b.warn("line parsed but not handled: "+a)}}}return(m=p)&&!m.relurl&&(h.fragments.pop(),c-=m.duration),h.totalduration=c,h.averagetargetduration=c/h.fragments.length,h.endSN=d-1,h.startCC=h.fragments[0]?h.fragments[0].cc:0,h.endCC=f,!h.initSegment&&h.fragments.length&&h.fragments.every((function(e){return D.test(e.relurl)}))&&(u.b.warn("MP4 fragments found but no init segment (probably no MAP, incomplete M3U8), trying to fetch SIDX"),(m=new y).relurl=h.fragments[0].relurl,m.baseurl=t,m.level=i,m.type=r,m.sn="initSegment",h.initSegment=m,h.needSidxRanges=!0),v&&function(e,t){for(var i=e[t],r=t-1;r>=0;r--){var n=e[r];n.programDateTime=i.programDateTime-1e3*n.duration,i=n}}(h.fragments,v),h},e}();function O(e,t){e.rawProgramDateTime?e.programDateTime=Date.parse(e.rawProgramDateTime):t&&t.programDateTime&&(e.programDateTime=t.endProgramDateTime),Object(l.a)(e.programDateTime)||(e.programDateTime=null,e.rawProgramDateTime=null)}var P=window.performance,I=function(e){var t,i;function r(t){var i;return(i=e.call(this,t,d.a.MANIFEST_LOADING,d.a.LEVEL_LOADING,d.a.AUDIO_TRACK_LOADING,d.a.SUBTITLE_TRACK_LOADING)||this).loaders={},i}i=e,(t=r).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i,r.canHaveQualityLevels=function(e){return e!==n.AUDIO_TRACK&&e!==n.SUBTITLE_TRACK},r.mapContextToLevelType=function(e){switch(e.type){case n.AUDIO_TRACK:return a.AUDIO;case n.SUBTITLE_TRACK:return a.SUBTITLE;default:return a.MAIN}},r.getResponseUrl=function(e,t){var i=e.url;return void 0!==i&&0!==i.indexOf("data:")||(i=t.url),i};var s=r.prototype;return s.createInternalLoader=function(e){var t=this.hls.config,i=t.pLoader,r=t.loader,n=new(i||r)(t);return e.loader=n,this.loaders[e.type]=n,n},s.getInternalLoader=function(e){return this.loaders[e.type]},s.resetInternalLoader=function(e){this.loaders[e]&&delete this.loaders[e]},s.destroyInternalLoaders=function(){for(var e in this.loaders){var t=this.loaders[e];t&&t.destroy(),this.resetInternalLoader(e)}},s.destroy=function(){this.destroyInternalLoaders(),e.prototype.destroy.call(this)},s.onManifestLoading=function(e){this.load({url:e.url,type:n.MANIFEST,level:0,id:null,responseType:"text"})},s.onLevelLoading=function(e){this.load({url:e.url,type:n.LEVEL,level:e.level,id:e.id,responseType:"text"})},s.onAudioTrackLoading=function(e){this.load({url:e.url,type:n.AUDIO_TRACK,level:null,id:e.id,responseType:"text"})},s.onSubtitleTrackLoading=function(e){this.load({url:e.url,type:n.SUBTITLE_TRACK,level:null,id:e.id,responseType:"text"})},s.load=function(e){var t=this.hls.config;u.b.debug("Loading playlist of type "+e.type+", level: "+e.level+", id: "+e.id);var i,r,a,s,o=this.getInternalLoader(e);if(o){var l=o.context;if(l&&l.url===e.url)return u.b.trace("playlist request ongoing"),!1;u.b.warn("aborting previous loader for type: "+e.type),o.abort()}switch(e.type){case n.MANIFEST:i=t.manifestLoadingMaxRetry,r=t.manifestLoadingTimeOut,a=t.manifestLoadingRetryDelay,s=t.manifestLoadingMaxRetryTimeout;break;case n.LEVEL:i=0,s=0,a=0,r=t.levelLoadingTimeOut;break;default:i=t.levelLoadingMaxRetry,r=t.levelLoadingTimeOut,a=t.levelLoadingRetryDelay,s=t.levelLoadingMaxRetryTimeout}o=this.createInternalLoader(e);var d={timeout:r,maxRetry:i,retryDelay:a,maxRetryDelay:s},c={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};return u.b.debug("Calling internal loader delegate for URL: "+e.url),o.load(e,d,c),!0},s.loadsuccess=function(e,t,i,r){if(void 0===r&&(r=null),i.isSidxRequest)return this._handleSidxRequest(e,i),void this._handlePlaylistLoaded(e,t,i,r);if(this.resetInternalLoader(i.type),"string"!=typeof e.data)throw new Error('expected responseType of "text" for PlaylistLoader');var n=e.data;t.tload=P.now(),0===n.indexOf("#EXTM3U")?n.indexOf("#EXTINF:")>0||n.indexOf("#EXT-X-TARGETDURATION:")>0?this._handleTrackOrLevelPlaylist(e,t,i,r):this._handleMasterPlaylist(e,t,i,r):this._handleManifestParsingError(e,i,"no EXTM3U delimiter",r)},s.loaderror=function(e,t,i){void 0===i&&(i=null),this._handleNetworkError(t,i,!1,e)},s.loadtimeout=function(e,t,i){void 0===i&&(i=null),this._handleNetworkError(t,i,!0)},s._handleMasterPlaylist=function(e,t,i,n){var a=this.hls,s=e.data,o=r.getResponseUrl(e,i),l=x.parseMasterPlaylist(s,o);if(l.length){var c=l.map((function(e){return{id:e.attrs.AUDIO,codec:e.audioCodec}})),h=x.parseMasterPlaylistMedia(s,o,"AUDIO",c),f=x.parseMasterPlaylistMedia(s,o,"SUBTITLES");if(h.length){var p=!1;h.forEach((function(e){e.url||(p=!0)})),!1===p&&l[0].audioCodec&&!l[0].attrs.AUDIO&&(u.b.log("audio codec signaled in quality level, but no embedded audio track signaled, create one"),h.unshift({type:"main",name:"main",default:!1,autoselect:!1,forced:!1,id:-1}))}a.trigger(d.a.MANIFEST_LOADED,{levels:l,audioTracks:h,subtitles:f,url:o,stats:t,networkDetails:n})}else this._handleManifestParsingError(e,i,"no level found in manifest",n)},s._handleTrackOrLevelPlaylist=function(e,t,i,a){var s=this.hls,o=i.id,u=i.level,c=i.type,h=r.getResponseUrl(e,i),f=Object(l.a)(o)?o:0,p=Object(l.a)(u)?u:f,m=r.mapContextToLevelType(i),g=x.parseLevelPlaylist(e.data,h,p,m,f);if(g.tload=t.tload,c===n.MANIFEST){var v={url:h,details:g};s.trigger(d.a.MANIFEST_LOADED,{levels:[v],audioTracks:[],url:h,stats:t,networkDetails:a})}if(t.tparsed=P.now(),g.needSidxRanges){var y=g.initSegment.url;this.load({url:y,isSidxRequest:!0,type:c,level:u,levelDetails:g,id:o,rangeStart:0,rangeEnd:2048,responseType:"arraybuffer"})}else i.levelDetails=g,this._handlePlaylistLoaded(e,t,i,a)},s._handleSidxRequest=function(e,t){if("string"==typeof e.data)throw new Error("sidx request must be made with responseType of array buffer");var i=f.a.parseSegmentIndex(new Uint8Array(e.data));if(i){var r=i.references,n=t.levelDetails;r.forEach((function(e,t){var i=e.info;if(n){var r=n.fragments[t];0===r.byteRange.length&&r.setByteRange(String(1+i.end-i.start)+"@"+String(i.start))}})),n&&n.initSegment.setByteRange(String(i.moovEndOffset)+"@0")}},s._handleManifestParsingError=function(e,t,i,r){this.hls.trigger(d.a.ERROR,{type:o.b.NETWORK_ERROR,details:o.a.MANIFEST_PARSING_ERROR,fatal:!0,url:e.url,reason:i,networkDetails:r})},s._handleNetworkError=function(e,t,i,r){var a,s;void 0===i&&(i=!1),void 0===r&&(r=null),u.b.info("A network error occured while loading a "+e.type+"-type playlist");var l=this.getInternalLoader(e);switch(e.type){case n.MANIFEST:a=i?o.a.MANIFEST_LOAD_TIMEOUT:o.a.MANIFEST_LOAD_ERROR,s=!0;break;case n.LEVEL:a=i?o.a.LEVEL_LOAD_TIMEOUT:o.a.LEVEL_LOAD_ERROR,s=!1;break;case n.AUDIO_TRACK:a=i?o.a.AUDIO_TRACK_LOAD_TIMEOUT:o.a.AUDIO_TRACK_LOAD_ERROR,s=!1;break;default:s=!1}l&&(l.abort(),this.resetInternalLoader(e.type));var c={type:o.b.NETWORK_ERROR,details:a,fatal:s,url:e.url,loader:l,context:e,networkDetails:t};r&&(c.response=r),this.hls.trigger(d.a.ERROR,c)},s._handlePlaylistLoaded=function(e,t,i,a){var s=i.type,o=i.level,l=i.id,u=i.levelDetails;if(u&&u.targetduration)if(r.canHaveQualityLevels(i.type))this.hls.trigger(d.a.LEVEL_LOADED,{details:u,level:o||0,id:l||0,stats:t,networkDetails:a});else switch(s){case n.AUDIO_TRACK:this.hls.trigger(d.a.AUDIO_TRACK_LOADED,{details:u,id:l,stats:t,networkDetails:a});break;case n.SUBTITLE_TRACK:this.hls.trigger(d.a.SUBTITLE_TRACK_LOADED,{details:u,id:l,stats:t,networkDetails:a})}else this._handleManifestParsingError(e,i,"invalid target duration",a)},r}(h),M=function(e){var t,i;function r(t){var i;return(i=e.call(this,t,d.a.FRAG_LOADING)||this).loaders={},i}i=e,(t=r).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var n=r.prototype;return n.destroy=function(){var t=this.loaders;for(var i in t){var r=t[i];r&&r.destroy()}this.loaders={},e.prototype.destroy.call(this)},n.onFragLoading=function(e){var t=e.frag,i=t.type,r=this.loaders,n=this.hls.config,a=n.fLoader,s=n.loader;t.loaded=0;var o,d,c,h=r[i];h&&(u.b.warn("abort previous fragment loader for type: "+i),h.abort()),h=r[i]=t.loader=n.fLoader?new a(n):new s(n),o={url:t.url,frag:t,responseType:"arraybuffer",progressData:!1};var f=t.byteRangeStartOffset,p=t.byteRangeEndOffset;Object(l.a)(f)&&Object(l.a)(p)&&(o.rangeStart=f,o.rangeEnd=p),d={timeout:n.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:n.fragLoadingMaxRetryTimeout},c={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this),onProgress:this.loadprogress.bind(this)},h.load(o,d,c)},n.loadsuccess=function(e,t,i,r){void 0===r&&(r=null);var n=e.data,a=i.frag;a.loader=void 0,this.loaders[a.type]=void 0,this.hls.trigger(d.a.FRAG_LOADED,{payload:n,frag:a,stats:t,networkDetails:r})},n.loaderror=function(e,t,i){void 0===i&&(i=null);var r=t.frag,n=r.loader;n&&n.abort(),this.loaders[r.type]=void 0,this.hls.trigger(d.a.ERROR,{type:o.b.NETWORK_ERROR,details:o.a.FRAG_LOAD_ERROR,fatal:!1,frag:t.frag,response:e,networkDetails:i})},n.loadtimeout=function(e,t,i){void 0===i&&(i=null);var r=t.frag,n=r.loader;n&&n.abort(),this.loaders[r.type]=void 0,this.hls.trigger(d.a.ERROR,{type:o.b.NETWORK_ERROR,details:o.a.FRAG_LOAD_TIMEOUT,fatal:!1,frag:t.frag,networkDetails:i})},n.loadprogress=function(e,t,i,r){void 0===r&&(r=null);var n=t.frag;n.loaded=e.loaded,this.hls.trigger(d.a.FRAG_LOAD_PROGRESS,{frag:n,stats:e,networkDetails:r})},r}(h),N=function(e){var t,i;function r(t){var i;return(i=e.call(this,t,d.a.KEY_LOADING)||this).loaders={},i.decryptkey=null,i.decrypturl=null,i}i=e,(t=r).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var n=r.prototype;return n.destroy=function(){for(var t in this.loaders){var i=this.loaders[t];i&&i.destroy()}this.loaders={},e.prototype.destroy.call(this)},n.onKeyLoading=function(e){var t=e.frag,i=t.type,r=this.loaders[i];if(t.decryptdata){var n=t.decryptdata.uri;if(n!==this.decrypturl||null===this.decryptkey){var a=this.hls.config;if(r&&(u.b.warn("abort previous key loader for type:"+i),r.abort()),!n)return void u.b.warn("key uri is falsy");t.loader=this.loaders[i]=new a.loader(a),this.decrypturl=n,this.decryptkey=null;var s={url:n,frag:t,responseType:"arraybuffer"},o={timeout:a.fragLoadingTimeOut,maxRetry:0,retryDelay:a.fragLoadingRetryDelay,maxRetryDelay:a.fragLoadingMaxRetryTimeout},l={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};t.loader.load(s,o,l)}else this.decryptkey&&(t.decryptdata.key=this.decryptkey,this.hls.trigger(d.a.KEY_LOADED,{frag:t}))}else u.b.warn("Missing decryption data on fragment in onKeyLoading")},n.loadsuccess=function(e,t,i){var r=i.frag;r.decryptdata?(this.decryptkey=r.decryptdata.key=new Uint8Array(e.data),r.loader=void 0,delete this.loaders[r.type],this.hls.trigger(d.a.KEY_LOADED,{frag:r})):u.b.error("after key load, decryptdata unset")},n.loaderror=function(e,t){var i=t.frag,r=i.loader;r&&r.abort(),delete this.loaders[i.type],this.hls.trigger(d.a.ERROR,{type:o.b.NETWORK_ERROR,details:o.a.KEY_LOAD_ERROR,fatal:!1,frag:i,response:e})},n.loadtimeout=function(e,t){var i=t.frag,r=i.loader;r&&r.abort(),delete this.loaders[i.type],this.hls.trigger(d.a.ERROR,{type:o.b.NETWORK_ERROR,details:o.a.KEY_LOAD_TIMEOUT,fatal:!1,frag:i})},r}(h),F="NOT_LOADED",U="APPENDING",B="PARTIAL",j=function(e){var t,i;function r(t){var i;return(i=e.call(this,t,d.a.BUFFER_APPENDED,d.a.FRAG_BUFFERED,d.a.FRAG_LOADED)||this).bufferPadding=.2,i.fragments=Object.create(null),i.timeRanges=Object.create(null),i.config=t.config,i}i=e,(t=r).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var n=r.prototype;return n.destroy=function(){this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.config=null,h.prototype.destroy.call(this),e.prototype.destroy.call(this)},n.getBufferedFrag=function(e,t){var i=this.fragments,r=Object.keys(i).filter((function(r){var n=i[r];if(n.body.type!==t)return!1;if(!n.buffered)return!1;var a=n.body;return a.startPTS<=e&&e<=a.endPTS}));if(0===r.length)return null;var n=r.pop();return i[n].body},n.detectEvictedFragments=function(e,t){var i,r,n=this;Object.keys(this.fragments).forEach((function(a){var s=n.fragments[a];if(!0===s.buffered){var o=s.range[e];if(o){i=o.time;for(var l=0;l<i.length;l++)if(r=i[l],!1===n.isTimeBuffered(r.startPTS,r.endPTS,t)){n.removeFragment(s.body);break}}}}))},n.detectPartialFragments=function(e){var t=this,i=this.getFragmentKey(e),r=this.fragments[i];r&&(r.buffered=!0,Object.keys(this.timeRanges).forEach((function(i){if(e.hasElementaryStream(i)){var n=t.timeRanges[i];r.range[i]=t.getBufferedTimes(e.startPTS,e.endPTS,n)}})))},n.getBufferedTimes=function(e,t,i){for(var r,n,a=[],s=!1,o=0;o<i.length;o++){if(r=i.start(o)-this.bufferPadding,n=i.end(o)+this.bufferPadding,e>=r&&t<=n){a.push({startPTS:Math.max(e,i.start(o)),endPTS:Math.min(t,i.end(o))});break}if(e<n&&t>r)a.push({startPTS:Math.max(e,i.start(o)),endPTS:Math.min(t,i.end(o))}),s=!0;else if(t<=r)break}return{time:a,partial:s}},n.getFragmentKey=function(e){return e.type+"_"+e.level+"_"+e.urlId+"_"+e.sn},n.getPartialFragment=function(e){var t,i,r,n=this,a=null,s=0;return Object.keys(this.fragments).forEach((function(o){var l=n.fragments[o];n.isPartial(l)&&(i=l.body.startPTS-n.bufferPadding,r=l.body.endPTS+n.bufferPadding,e>=i&&e<=r&&(t=Math.min(e-i,r-e),s<=t&&(a=l.body,s=t)))})),a},n.getState=function(e){var t=this.getFragmentKey(e),i=this.fragments[t],r=F;return void 0!==i&&(r=i.buffered?!0===this.isPartial(i)?B:"OK":U),r},n.isPartial=function(e){return!0===e.buffered&&(void 0!==e.range.video&&!0===e.range.video.partial||void 0!==e.range.audio&&!0===e.range.audio.partial)},n.isTimeBuffered=function(e,t,i){for(var r,n,a=0;a<i.length;a++){if(r=i.start(a)-this.bufferPadding,n=i.end(a)+this.bufferPadding,e>=r&&t<=n)return!0;if(t<=r)return!1}return!1},n.onFragLoaded=function(e){var t=e.frag;Object(l.a)(t.sn)&&!t.bitrateTest&&(this.fragments[this.getFragmentKey(t)]={body:t,range:Object.create(null),buffered:!1})},n.onBufferAppended=function(e){var t=this;this.timeRanges=e.timeRanges,Object.keys(this.timeRanges).forEach((function(e){var i=t.timeRanges[e];t.detectEvictedFragments(e,i)}))},n.onFragBuffered=function(e){this.detectPartialFragments(e.frag)},n.hasFragment=function(e){var t=this.getFragmentKey(e);return void 0!==this.fragments[t]},n.removeFragment=function(e){var t=this.getFragmentKey(e);delete this.fragments[t]},n.removeAllFragments=function(){this.fragments=Object.create(null)},r}(h),$=function(e,t){for(var i=0,r=e.length-1,n=null,a=null;i<=r;){var s=t(a=e[n=(i+r)/2|0]);if(s>0)i=n+1;else{if(!(s<0))return a;r=n-1}}return null},H=function(){function e(){}return e.isBuffered=function(e,t){try{if(e)for(var i=e.buffered,r=0;r<i.length;r++)if(t>=i.start(r)&&t<=i.end(r))return!0}catch(e){}return!1},e.bufferInfo=function(e,t,i){try{if(e){var r,n=e.buffered,a=[];for(r=0;r<n.length;r++)a.push({start:n.start(r),end:n.end(r)});return this.bufferedInfo(a,t,i)}}catch(e){}return{len:0,start:t,end:t,nextStart:void 0}},e.bufferedInfo=function(e,t,i){e.sort((function(e,t){return e.start-t.start||t.end-e.end}));var r=[];if(i)for(var n=0;n<e.length;n++){var a=r.length;if(a){var s=r[a-1].end;e[n].start-s<i?e[n].end>s&&(r[a-1].end=e[n].end):r.push(e[n])}else r.push(e[n])}else r=e;for(var o,l=0,d=t,u=t,c=0;c<r.length;c++){var h=r[c].start,f=r[c].end;if(t+i>=h&&t<f)d=h,l=(u=f)-t;else if(t+i<h){o=h;break}}return{len:l,start:d,end:u,nextStart:o}},e}(),G=i(8),q=i(11),K=i(9);function W(){return window.MediaSource||window.WebKitMediaSource}var V=i(5),Y=function(e){var t,i;function r(){return e.apply(this,arguments)||this}return i=e,(t=r).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i,r.prototype.trigger=function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];this.emit.apply(this,[e,e].concat(i))},r}(G.EventEmitter),z=Object(V.a)(),X=W()||{isTypeSupported:function(){return!1}},Q=function(){function e(e,t){var i=this;this.hls=e,this.id=t;var r=this.observer=new Y,n=e.config,a=function(t,r){(r=r||{}).frag=i.frag,r.id=i.id,e.trigger(t,r)};r.on(d.a.FRAG_DECRYPTED,a),r.on(d.a.FRAG_PARSING_INIT_SEGMENT,a),r.on(d.a.FRAG_PARSING_DATA,a),r.on(d.a.FRAG_PARSED,a),r.on(d.a.ERROR,a),r.on(d.a.FRAG_PARSING_METADATA,a),r.on(d.a.FRAG_PARSING_USERDATA,a),r.on(d.a.INIT_PTS_FOUND,a);var s={mp4:X.isTypeSupported("video/mp4"),mpeg:X.isTypeSupported("audio/mpeg"),mp3:X.isTypeSupported('audio/mp4; codecs="mp3"')},l=navigator.vendor;if(n.enableWorker&&"undefined"!=typeof Worker){var c;u.b.log("demuxing in webworker");try{c=this.w=q(12),this.onwmsg=this.onWorkerMessage.bind(this),c.addEventListener("message",this.onwmsg),c.onerror=function(t){e.trigger(d.a.ERROR,{type:o.b.OTHER_ERROR,details:o.a.INTERNAL_EXCEPTION,fatal:!0,event:"demuxerWorker",err:{message:t.message+" ("+t.filename+":"+t.lineno+")"}})},c.postMessage({cmd:"init",typeSupported:s,vendor:l,id:t,config:JSON.stringify(n)})}catch(e){u.b.warn("Error in worker:",e),u.b.error("Error while initializing DemuxerWorker, fallback on DemuxerInline"),c&&z.URL.revokeObjectURL(c.objectURL),this.demuxer=new K.a(r,s,n,l),this.w=void 0}}else this.demuxer=new K.a(r,s,n,l)}var t=e.prototype;return t.destroy=function(){var e=this.w;if(e)e.removeEventListener("message",this.onwmsg),e.terminate(),this.w=null;else{var t=this.demuxer;t&&(t.destroy(),this.demuxer=null)}var i=this.observer;i&&(i.removeAllListeners(),this.observer=null)},t.push=function(e,t,i,r,n,a,s,o){var d=this.w,c=Object(l.a)(n.startPTS)?n.startPTS:n.start,h=n.decryptdata,f=this.frag,p=!(f&&n.cc===f.cc),m=!(f&&n.level===f.level),g=f&&n.sn===f.sn+1,v=!m&&g;if(p&&u.b.log(this.id+":discontinuity detected"),m&&u.b.log(this.id+":switch detected"),this.frag=n,d)d.postMessage({cmd:"demux",data:e,decryptdata:h,initSegment:t,audioCodec:i,videoCodec:r,timeOffset:c,discontinuity:p,trackSwitch:m,contiguous:v,duration:a,accurateTimeOffset:s,defaultInitPTS:o},e instanceof ArrayBuffer?[e]:[]);else{var y=this.demuxer;y&&y.push(e,h,t,i,r,c,p,m,v,a,s,o)}},t.onWorkerMessage=function(e){var t=e.data,i=this.hls;switch(t.event){case"init":z.URL.revokeObjectURL(this.w.objectURL);break;case d.a.FRAG_PARSING_DATA:t.data.data1=new Uint8Array(t.data1),t.data2&&(t.data.data2=new Uint8Array(t.data2));default:t.data=t.data||{},t.data.frag=this.frag,t.data.id=this.id,i.trigger(t.event,t.data)}},e}();function J(e,t,i){switch(t){case"audio":e.audioGroupIds||(e.audioGroupIds=[]),e.audioGroupIds.push(i);break;case"text":e.textGroupIds||(e.textGroupIds=[]),e.textGroupIds.push(i)}}function Z(e,t,i){var r=e[t],n=e[i],a=n.startPTS;Object(l.a)(a)?i>t?(r.duration=a-r.start,r.duration<0&&u.b.warn("negative duration computed for frag "+r.sn+",level "+r.level+", there should be some duration drift between playlist and fragment!")):(n.duration=r.start-a,n.duration<0&&u.b.warn("negative duration computed for frag "+n.sn+",level "+n.level+", there should be some duration drift between playlist and fragment!")):n.start=i>t?r.start+r.duration:Math.max(r.start-n.duration,0)}function ee(e,t,i,r,n,a){var s=i;if(Object(l.a)(t.startPTS)){var o=Math.abs(t.startPTS-i);Object(l.a)(t.deltaPTS)?t.deltaPTS=Math.max(o,t.deltaPTS):t.deltaPTS=o,s=Math.max(i,t.startPTS),i=Math.min(i,t.startPTS),r=Math.max(r,t.endPTS),n=Math.min(n,t.startDTS),a=Math.max(a,t.endDTS)}var d=i-t.start;t.start=t.startPTS=i,t.maxStartPTS=s,t.endPTS=r,t.startDTS=n,t.endDTS=a,t.duration=r-i;var u,c,h,f=t.sn;if(!e||f<e.startSN||f>e.endSN)return 0;for(u=f-e.startSN,(c=e.fragments)[u]=t,h=u;h>0;h--)Z(c,h,h-1);for(h=u;h<c.length-1;h++)Z(c,h,h+1);return e.PTSKnown=!0,d}function te(e,t){t.initSegment&&e.initSegment&&(t.initSegment=e.initSegment);var i,r=0;if(ie(e,t,(function(e,n){r=e.cc-n.cc,Object(l.a)(e.startPTS)&&(n.start=n.startPTS=e.startPTS,n.endPTS=e.endPTS,n.duration=e.duration,n.backtracked=e.backtracked,n.dropped=e.dropped,i=n),t.PTSKnown=!0})),t.PTSKnown){if(r){u.b.log("discontinuity sliding from playlist, take drift into account");for(var n=t.fragments,a=0;a<n.length;a++)n[a].cc+=r}i?ee(t,i,i.startPTS,i.endPTS,i.startDTS,i.endDTS):function(e,t){var i=t.startSN-e.startSN,r=e.fragments,n=t.fragments;if(!(i<0||i>r.length))for(var a=0;a<n.length;a++)n[a].start+=r[i].start}(e,t),t.PTSKnown=e.PTSKnown}}function ie(e,t,i){if(e&&t)for(var r=Math.max(e.startSN,t.startSN)-t.startSN,n=Math.min(e.endSN,t.endSN)-t.startSN,a=t.startSN-e.startSN,s=r;s<=n;s++){var o=e.fragments[a+s],l=t.fragments[s];if(!o||!l)break;i(o,l,s)}}function re(e,t,i){var r=1e3*(t.averagetargetduration?t.averagetargetduration:t.targetduration),n=r/2;return e&&t.endSN===e.endSN&&(r=n),i&&(r=Math.max(n,r-(window.performance.now()-i))),Math.round(r)}var ne=function(e){for(var t="",i=e.length,r=0;r<i;r++)t+="["+e.start(r).toFixed(3)+","+e.end(r).toFixed(3)+"]";return t};function ae(e,t){t.fragments.forEach((function(t){if(t){var i=t.start+e;t.start=t.startPTS=i,t.endPTS=i+t.duration}})),t.PTSKnown=!0}function se(e,t,i){!function(e,t,i){if(function(e,t,i){var r=!1;return t&&t.details&&i&&(i.endCC>i.startCC||e&&e.cc<i.startCC)&&(r=!0),r}(e,i,t)){var r=function(e,t){var i=e.fragments,r=t.fragments;if(r.length&&i.length){var n=function(e,t){for(var i=null,r=0;r<e.length;r+=1){var n=e[r];if(n&&n.cc===t){i=n;break}}return i}(i,r[0].cc);if(n&&(!n||n.startPTS))return n;u.b.log("No frag in previous level to align on")}else u.b.log("No fragments to align")}(i.details,t);r&&(u.b.log("Adjusting PTS using last level due to CC increase within current level"),ae(r.start,t))}}(e,i,t),!i.PTSKnown&&t&&function(e,t){if(t&&t.fragments.length){if(!e.hasProgramDateTime||!t.hasProgramDateTime)return;var i=t.fragments[0].programDateTime,r=(e.fragments[0].programDateTime-i)/1e3+t.fragments[0].start;Object(l.a)(r)&&(u.b.log("adjusting PTS using programDateTime delta, sliding:"+r.toFixed(3)),ae(r,e))}}(i,t.details)}function oe(e,t,i){if(null===t||!Array.isArray(e)||!e.length||!Object(l.a)(t))return null;if(t<(e[0].programDateTime||0))return null;if(t>=(e[e.length-1].endProgramDateTime||0))return null;i=i||0;for(var r=0;r<e.length;++r){var n=e[r];if(ue(t,i,n))return n}return null}function le(e,t,i,r){void 0===i&&(i=0),void 0===r&&(r=0);var n=e?t[e.sn-t[0].sn+1]:null;return n&&!de(i,r,n)?n:$(t,de.bind(null,i,r))}function de(e,t,i){void 0===e&&(e=0),void 0===t&&(t=0);var r=Math.min(t,i.duration+(i.deltaPTS?i.deltaPTS:0));return i.start+i.duration-r<=e?1:i.start-r>e&&i.start?-1:0}function ue(e,t,i){var r=1e3*Math.min(t,i.duration+(i.deltaPTS?i.deltaPTS:0));return(i.endProgramDateTime||0)-r>e}var ce=function(){function e(e,t,i,r){this.config=e,this.media=t,this.fragmentTracker=i,this.hls=r,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1}var t=e.prototype;return t.poll=function(e){var t=this.config,i=this.media,r=this.stalled,n=i.currentTime,a=i.seeking,s=this.seeking&&!a,o=!this.seeking&&a;if(this.seeking=a,n===e){if((o||s)&&(this.stalled=null),!i.paused&&!i.ended&&0!==i.playbackRate&&i.buffered.length){var l=H.bufferInfo(i,n,0),d=l.len>0,c=l.nextStart||0;if(d||c){if(a){if(l.len>2||!c||c-n>2)return;this.moved=!1}if(!this.moved&&this.stalled){var h=Math.max(c,l.start||0)-n;if(h>0&&h<=2)return void this._trySkipBufferHole(null)}var f=self.performance.now();if(null!==r){var p=f-r;!a&&p>=250&&this._reportStall(l.len);var m=H.bufferInfo(i,n,t.maxBufferHole);this._tryFixBufferStall(m,p)}else this.stalled=f}}}else if(this.moved=!0,null!==r){if(this.stallReported){var g=self.performance.now()-r;u.b.warn("playback not stuck anymore @"+n+", after "+Math.round(g)+"ms"),this.stallReported=!1}this.stalled=null,this.nudgeRetry=0}},t._tryFixBufferStall=function(e,t){var i=this.config,r=this.fragmentTracker,n=this.media.currentTime,a=r.getPartialFragment(n);a&&this._trySkipBufferHole(a)||e.len>i.maxBufferHole&&t>1e3*i.highBufferWatchdogPeriod&&(u.b.warn("Trying to nudge playhead over buffer-hole"),this.stalled=null,this._tryNudgeBuffer())},t._reportStall=function(e){var t=this.hls,i=this.media;this.stallReported||(this.stallReported=!0,u.b.warn("Playback stalling at @"+i.currentTime+" due to low buffer"),t.trigger(d.a.ERROR,{type:o.b.MEDIA_ERROR,details:o.a.BUFFER_STALLED_ERROR,fatal:!1,buffer:e}))},t._trySkipBufferHole=function(e){for(var t=this.config,i=this.hls,r=this.media,n=r.currentTime,a=0,s=0;s<r.buffered.length;s++){var l=r.buffered.start(s);if(n+t.maxBufferHole>=a&&n<l){var c=Math.max(l+.05,r.currentTime+.1);return u.b.warn("skipping hole, adjusting currentTime from "+n+" to "+c),this.moved=!0,this.stalled=null,r.currentTime=c,e&&i.trigger(d.a.ERROR,{type:o.b.MEDIA_ERROR,details:o.a.BUFFER_SEEK_OVER_HOLE,fatal:!1,reason:"fragment loaded with buffer holes, seeking from "+n+" to "+c,frag:e}),c}a=r.buffered.end(s)}return 0},t._tryNudgeBuffer=function(){var e=this.config,t=this.hls,i=this.media,r=i.currentTime,n=(this.nudgeRetry||0)+1;if(this.nudgeRetry=n,n<e.nudgeMaxRetry){var a=r+n*e.nudgeOffset;u.b.warn("Nudging 'currentTime' from "+r+" to "+a),i.currentTime=a,t.trigger(d.a.ERROR,{type:o.b.MEDIA_ERROR,details:o.a.BUFFER_NUDGE_ON_STALL,fatal:!1})}else u.b.error("Playhead still not moving while enough data buffered @"+r+" after "+e.nudgeMaxRetry+" nudges"),t.trigger(d.a.ERROR,{type:o.b.MEDIA_ERROR,details:o.a.BUFFER_STALLED_ERROR,fatal:!0})},e}();function he(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var fe=function(e){var t,i;function r(t){for(var i,r=arguments.length,n=new Array(r>1?r-1:0),a=1;a<r;a++)n[a-1]=arguments[a];return(i=e.call.apply(e,[this,t].concat(n))||this)._boundTick=void 0,i._tickTimer=null,i._tickInterval=null,i._tickCallCount=0,i._boundTick=i.tick.bind(he(i)),i}i=e,(t=r).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var n=r.prototype;return n.onHandlerDestroying=function(){this.clearNextTick(),this.clearInterval()},n.hasInterval=function(){return!!this._tickInterval},n.hasNextTick=function(){return!!this._tickTimer},n.setInterval=function(e){return!this._tickInterval&&(this._tickInterval=self.setInterval(this._boundTick,e),!0)},n.clearInterval=function(){return!!this._tickInterval&&(self.clearInterval(this._tickInterval),this._tickInterval=null,!0)},n.clearNextTick=function(){return!!this._tickTimer&&(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0)},n.tick=function(){this._tickCallCount++,1===this._tickCallCount&&(this.doTick(),this._tickCallCount>1&&(this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)),this._tickCallCount=0)},n.doTick=function(){},r}(h),pe="STOPPED",me="STARTING",ge="IDLE",ve="PAUSED",ye="KEY_LOADING",be="FRAG_LOADING",we="FRAG_LOADING_WAITING_RETRY",_e="WAITING_TRACK",Te="PARSING",Ee="PARSED",Se="BUFFER_FLUSHING",ke="ENDED",Ae="ERROR",Ce="WAITING_INIT_PTS",Re="WAITING_LEVEL",Le=function(e){var t,i;function r(){return e.apply(this,arguments)||this}i=e,(t=r).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var n=r.prototype;return n.doTick=function(){},n.startLoad=function(){},n.stopLoad=function(){var e=this.fragCurrent;e&&(e.loader&&e.loader.abort(),this.fragmentTracker.removeFragment(e)),this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=pe},n._streamEnded=function(e,t){var i=this.fragCurrent,r=this.fragmentTracker;if(!t.live&&i&&!i.backtracked&&i.sn===t.endSN&&!e.nextStart){var n=r.getState(i);return n===B||"OK"===n}return!1},n.onMediaSeeking=function(){var e=this.config,t=this.media,i=this.mediaBuffer,r=this.state,n=t?t.currentTime:null,a=H.bufferInfo(i||t,n,this.config.maxBufferHole);if(Object(l.a)(n)&&u.b.log("media seeking to "+n.toFixed(3)),r===be){var s=this.fragCurrent;if(0===a.len&&s){var o=e.maxFragLookUpTolerance,d=s.start-o,c=s.start+s.duration+o;n<d||n>c?(s.loader&&(u.b.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),s.loader.abort()),this.fragCurrent=null,this.fragPrevious=null,this.state=ge):u.b.log("seeking outside of buffer but within currently loaded fragment range")}}else r===ke&&(0===a.len&&(this.fragPrevious=null,this.fragCurrent=null),this.state=ge);t&&(this.lastCurrentTime=n),this.loadedmetadata||(this.nextLoadPosition=this.startPosition=n),this.tick()},n.onMediaEnded=function(){this.startPosition=this.lastCurrentTime=0},n.onHandlerDestroying=function(){this.stopLoad(),e.prototype.onHandlerDestroying.call(this)},n.onHandlerDestroyed=function(){this.state=pe,this.fragmentTracker=null},n.computeLivePosition=function(e,t){var i=void 0!==this.config.liveSyncDuration?this.config.liveSyncDuration:this.config.liveSyncDurationCount*t.targetduration;return e+Math.max(0,t.totalduration-i)},r}(fe);function De(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var xe=function(e){var t,i;function r(t,i){var r;return(r=e.call(this,t,d.a.MEDIA_ATTACHED,d.a.MEDIA_DETACHING,d.a.MANIFEST_LOADING,d.a.MANIFEST_PARSED,d.a.LEVEL_LOADED,d.a.KEY_LOADED,d.a.FRAG_LOADED,d.a.FRAG_LOAD_EMERGENCY_ABORTED,d.a.FRAG_PARSING_INIT_SEGMENT,d.a.FRAG_PARSING_DATA,d.a.FRAG_PARSED,d.a.ERROR,d.a.AUDIO_TRACK_SWITCHING,d.a.AUDIO_TRACK_SWITCHED,d.a.BUFFER_CREATED,d.a.BUFFER_APPENDED,d.a.BUFFER_FLUSHED)||this).fragmentTracker=i,r.config=t.config,r.audioCodecSwap=!1,r._state=pe,r.stallReported=!1,r.gapController=null,r.altAudio=!1,r}i=e,(t=r).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var n,s,c=r.prototype;return c.startLoad=function(e){if(this.levels){var t=this.lastCurrentTime,i=this.hls;if(this.stopLoad(),this.setInterval(100),this.level=-1,this.fragLoadError=0,!this.startFragRequested){var r=i.startLevel;-1===r&&(r=0,this.bitrateTest=!0),this.level=i.nextLoadLevel=r,this.loadedmetadata=!1}t>0&&-1===e&&(u.b.log("override startPosition with lastCurrentTime @"+t.toFixed(3)),e=t),this.state=ge,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}else this.forceStartLoad=!0,this.state=pe},c.stopLoad=function(){this.forceStartLoad=!1,e.prototype.stopLoad.call(this)},c.doTick=function(){switch(this.state){case Se:this.fragLoadError=0;break;case ge:this._doTickIdle();break;case Re:var e=this.levels[this.level];e&&e.details&&(this.state=ge);break;case we:var t=window.performance.now(),i=this.retryDate;(!i||t>=i||this.media&&this.media.seeking)&&(u.b.log("mediaController: retryDate reached, switch back to IDLE state"),this.state=ge)}this._checkBuffer(),this._checkFragmentChanged()},c._doTickIdle=function(){var e=this.hls,t=e.config,i=this.media;if(void 0!==this.levelLastLoaded&&(i||!this.startFragRequested&&t.startFragPrefetch)){var r;r=this.loadedmetadata?i.currentTime:this.nextLoadPosition;var n=e.nextLoadLevel,a=this.levels[n];if(a){var s,o=a.bitrate;s=o?Math.max(8*t.maxBufferSize/o,t.maxBufferLength):t.maxBufferLength,s=Math.min(s,t.maxMaxBufferLength);var l=H.bufferInfo(this.mediaBuffer?this.mediaBuffer:i,r,t.maxBufferHole),c=l.len;if(!(c>=s)){u.b.trace("buffer length of "+c.toFixed(3)+" is below max of "+s.toFixed(3)+". checking for more payload ..."),this.level=e.nextLoadLevel=n;var h=a.details;if(!h||h.live&&this.levelLastLoaded!==n)this.state=Re;else{if(this._streamEnded(l,h)){var f={};return this.altAudio&&(f.type="video"),this.hls.trigger(d.a.BUFFER_EOS,f),void(this.state=ke)}this._fetchPayloadOrEos(r,l,h)}}}}},c._fetchPayloadOrEos=function(e,t,i){var r=this.fragPrevious,n=this.level,a=i.fragments,s=a.length;if(0!==s){var o,l=a[0].start,d=a[s-1].start+a[s-1].duration,c=t.end;if(i.initSegment&&!i.initSegment.data)o=i.initSegment;else if(i.live){var h=this.config.initialLiveManifestSize;if(s<h)return void u.b.warn("Can not start playback of a level, reason: not enough fragments "+s+" < "+h);if(null===(o=this._ensureFragmentAtLivePoint(i,c,l,d,r,a,s)))return}else c<l&&(o=a[0]);o||(o=this._findFragment(l,r,s,a,c,d,i)),o&&(o.encrypted?(u.b.log("Loading key for "+o.sn+" of ["+i.startSN+" ,"+i.endSN+"],level "+n),this._loadKey(o)):(u.b.log("Loading "+o.sn+" of ["+i.startSN+" ,"+i.endSN+"],level "+n+", currentTime:"+e.toFixed(3)+",bufferEnd:"+c.toFixed(3)),this._loadFragment(o)))}},c._ensureFragmentAtLivePoint=function(e,t,i,r,n,a,s){var o,l=this.hls.config,d=this.media,c=void 0!==l.liveMaxLatencyDuration?l.liveMaxLatencyDuration:l.liveMaxLatencyDurationCount*e.targetduration;if(t<Math.max(i-l.maxFragLookUpTolerance,r-c)){var h=this.liveSyncPosition=this.computeLivePosition(i,e);t=h,d&&!d.paused&&d.readyState&&d.duration>h&&h>d.currentTime&&(u.b.log("buffer end: "+t.toFixed(3)+" is located too far from the end of live sliding playlist, reset currentTime to : "+h.toFixed(3)),d.currentTime=h),this.nextLoadPosition=h}if(e.PTSKnown&&t>r&&d&&d.readyState)return null;if(this.startFragRequested&&!e.PTSKnown){if(n)if(e.hasProgramDateTime)u.b.log("live playlist, switching playlist, load frag with same PDT: "+n.programDateTime),o=oe(a,n.endProgramDateTime,l.maxFragLookUpTolerance);else{var f=n.sn+1;if(f>=e.startSN&&f<=e.endSN){var p=a[f-e.startSN];n.cc===p.cc&&(o=p,u.b.log("live playlist, switching playlist, load frag with next SN: "+o.sn))}o||(o=$(a,(function(e){return n.cc-e.cc})))&&u.b.log("live playlist, switching playlist, load frag with same CC: "+o.sn)}o||(o=a[Math.min(s-1,Math.round(s/2))],u.b.log("live playlist, switching playlist, unknown, load middle frag : "+o.sn))}return o},c._findFragment=function(e,t,i,r,n,a,s){var o,l=this.hls.config;if(o=n<a?le(t,r,n,n>a-l.maxFragLookUpTolerance?0:l.maxFragLookUpTolerance):r[i-1]){var d=o.sn-s.startSN,c=t&&o.level===t.level,h=r[d-1],f=r[d+1];if(t&&o.sn===t.sn)if(c&&!o.backtracked)if(o.sn<s.endSN){var p=t.deltaPTS;p&&p>l.maxBufferHole&&t.dropped&&d?(o=h,u.b.warn("Previous fragment was dropped with large PTS gap between audio and video. Maybe fragment is not starting with a keyframe? Loading previous one to try to overcome this")):(o=f,u.b.log("Re-loading fragment with SN: "+o.sn))}else o=null;else o.backtracked&&(f&&f.backtracked?(u.b.warn("Already backtracked from fragment "+f.sn+", will not backtrack to fragment "+o.sn+". Loading fragment "+f.sn),o=f):(u.b.warn("Loaded fragment with dropped frames, backtracking 1 segment to find a keyframe"),o.dropped=0,h?(o=h).backtracked=!0:d&&(o=null)))}return o},c._loadKey=function(e){this.state=ye,this.hls.trigger(d.a.KEY_LOADING,{frag:e})},c._loadFragment=function(e){var t=this.fragmentTracker.getState(e);this.fragCurrent=e,"initSegment"!==e.sn&&(this.startFragRequested=!0),Object(l.a)(e.sn)&&!e.bitrateTest&&(this.nextLoadPosition=e.start+e.duration),e.backtracked||t===F||t===B?(e.autoLevel=this.hls.autoLevelEnabled,e.bitrateTest=this.bitrateTest,this.hls.trigger(d.a.FRAG_LOADING,{frag:e}),this.demuxer||(this.demuxer=new Q(this.hls,"main")),this.state=be):t===U&&this._reduceMaxBufferLength(e.duration)&&this.fragmentTracker.removeFragment(e)},c.getBufferedFrag=function(e){return this.fragmentTracker.getBufferedFrag(e,a.MAIN)},c.followingBufferedFrag=function(e){return e?this.getBufferedFrag(e.endPTS+.5):null},c._checkFragmentChanged=function(){var e,t,i=this.media;if(i&&i.readyState&&!1===i.seeking&&((t=i.currentTime)>this.lastCurrentTime&&(this.lastCurrentTime=t),H.isBuffered(i,t)?e=this.getBufferedFrag(t):H.isBuffered(i,t+.1)&&(e=this.getBufferedFrag(t+.1)),e)){var r=e;if(r!==this.fragPlaying){this.hls.trigger(d.a.FRAG_CHANGED,{frag:r});var n=r.level;this.fragPlaying&&this.fragPlaying.level===n||this.hls.trigger(d.a.LEVEL_SWITCHED,{level:n}),this.fragPlaying=r}}},c.immediateLevelSwitch=function(){if(u.b.log("immediateLevelSwitch"),!this.immediateSwitch){this.immediateSwitch=!0;var e,t=this.media;t?(e=t.paused,t.pause()):e=!0,this.previouslyPaused=e}var i=this.fragCurrent;i&&i.loader&&i.loader.abort(),this.fragCurrent=null,this.flushMainBuffer(0,Number.POSITIVE_INFINITY)},c.immediateLevelSwitchEnd=function(){var e=this.media;e&&e.buffered.length&&(this.immediateSwitch=!1,H.isBuffered(e,e.currentTime)&&(e.currentTime-=1e-4),this.previouslyPaused||e.play())},c.nextLevelSwitch=function(){var e=this.media;if(e&&e.readyState){var t,i,r;if((i=this.getBufferedFrag(e.currentTime))&&i.startPTS>1&&this.flushMainBuffer(0,i.startPTS-1),e.paused)t=0;else{var n=this.hls.nextLoadLevel,a=this.levels[n],s=this.fragLastKbps;t=s&&this.fragCurrent?this.fragCurrent.duration*a.bitrate/(1e3*s)+1:0}if((r=this.getBufferedFrag(e.currentTime+t))&&(r=this.followingBufferedFrag(r))){var o=this.fragCurrent;o&&o.loader&&o.loader.abort(),this.fragCurrent=null,this.flushMainBuffer(r.maxStartPTS,Number.POSITIVE_INFINITY)}}},c.flushMainBuffer=function(e,t){this.state=Se;var i={startOffset:e,endOffset:t};this.altAudio&&(i.type="video"),this.hls.trigger(d.a.BUFFER_FLUSHING,i)},c.onMediaAttached=function(e){var t=this.media=this.mediaBuffer=e.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),this.onvended=this.onMediaEnded.bind(this),t.addEventListener("seeking",this.onvseeking),t.addEventListener("seeked",this.onvseeked),t.addEventListener("ended",this.onvended);var i=this.config;this.levels&&i.autoStartLoad&&this.hls.startLoad(i.startPosition),this.gapController=new ce(i,t,this.fragmentTracker,this.hls)},c.onMediaDetaching=function(){var e=this.media;e&&e.ended&&(u.b.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0);var t=this.levels;t&&t.forEach((function(e){e.details&&e.details.fragments.forEach((function(e){e.backtracked=void 0}))})),e&&(e.removeEventListener("seeking",this.onvseeking),e.removeEventListener("seeked",this.onvseeked),e.removeEventListener("ended",this.onvended),this.onvseeking=this.onvseeked=this.onvended=null),this.fragmentTracker.removeAllFragments(),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.stopLoad()},c.onMediaSeeked=function(){var e=this.media,t=e?e.currentTime:void 0;Object(l.a)(t)&&u.b.log("media seeked to "+t.toFixed(3)),this.tick()},c.onManifestLoading=function(){u.b.log("trigger BUFFER_RESET"),this.hls.trigger(d.a.BUFFER_RESET),this.fragmentTracker.removeAllFragments(),this.stalled=!1,this.startPosition=this.lastCurrentTime=0},c.onManifestParsed=function(e){var t,i=!1,r=!1;e.levels.forEach((function(e){(t=e.audioCodec)&&(-1!==t.indexOf("mp4a.40.2")&&(i=!0),-1!==t.indexOf("mp4a.40.5")&&(r=!0))})),this.audioCodecSwitch=i&&r,this.audioCodecSwitch&&u.b.log("both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.altAudio=e.altAudio,this.levels=e.levels,this.startFragRequested=!1;var n=this.config;(n.autoStartLoad||this.forceStartLoad)&&this.hls.startLoad(n.startPosition)},c.onLevelLoaded=function(e){var t=e.details,i=e.level,r=this.levels[this.levelLastLoaded],n=this.levels[i],a=t.totalduration,s=0;if(u.b.log("level "+i+" loaded ["+t.startSN+","+t.endSN+"],duration:"+a),t.live){var o=n.details;o&&t.fragments.length>0?(te(o,t),s=t.fragments[0].start,this.liveSyncPosition=this.computeLivePosition(s,o),t.PTSKnown&&Object(l.a)(s)?u.b.log("live playlist sliding:"+s.toFixed(3)):(u.b.log("live playlist - outdated PTS, unknown sliding"),se(this.fragPrevious,r,t))):(u.b.log("live playlist - first load, unknown sliding"),t.PTSKnown=!1,se(this.fragPrevious,r,t))}else t.PTSKnown=!1;if(n.details=t,this.levelLastLoaded=i,this.hls.trigger(d.a.LEVEL_UPDATED,{details:t,level:i}),!1===this.startFragRequested){if(-1===this.startPosition||-1===this.lastCurrentTime){var c=t.startTimeOffset;Object(l.a)(c)?(c<0&&(u.b.log("negative start time offset "+c+", count from end of last fragment"),c=s+a+c),u.b.log("start time offset found in playlist, adjust startPosition to "+c),this.startPosition=c):t.live?(this.startPosition=this.computeLivePosition(s,t),u.b.log("configure startPosition to "+this.startPosition)):this.startPosition=0,this.lastCurrentTime=this.startPosition}this.nextLoadPosition=this.startPosition}this.state===Re&&(this.state=ge),this.tick()},c.onKeyLoaded=function(){this.state===ye&&(this.state=ge,this.tick())},c.onFragLoaded=function(e){var t=this.fragCurrent,i=this.hls,r=this.levels,n=this.media,a=e.frag;if(this.state===be&&t&&"main"===a.type&&a.level===t.level&&a.sn===t.sn){var s=e.stats,o=r[t.level],l=o.details;if(this.bitrateTest=!1,this.stats=s,u.b.log("Loaded "+t.sn+" of ["+l.startSN+" ,"+l.endSN+"],level "+t.level),a.bitrateTest&&i.nextLoadLevel)this.state=ge,this.startFragRequested=!1,s.tparsed=s.tbuffered=window.performance.now(),i.trigger(d.a.FRAG_BUFFERED,{stats:s,frag:t,id:"main"}),this.tick();else if("initSegment"===a.sn)this.state=ge,s.tparsed=s.tbuffered=window.performance.now(),l.initSegment.data=e.payload,i.trigger(d.a.FRAG_BUFFERED,{stats:s,frag:t,id:"main"}),this.tick();else{u.b.log("Parsing "+t.sn+" of ["+l.startSN+" ,"+l.endSN+"],level "+t.level+", cc "+t.cc),this.state=Te,this.pendingBuffering=!0,this.appended=!1,a.bitrateTest&&(a.bitrateTest=!1,this.fragmentTracker.onFragLoaded({frag:a}));var c=!(n&&n.seeking)&&(l.PTSKnown||!l.live),h=l.initSegment?l.initSegment.data:[],f=this._getAudioCodec(o);(this.demuxer=this.demuxer||new Q(this.hls,"main")).push(e.payload,h,f,o.videoCodec,t,l.totalduration,c)}}this.fragLoadError=0},c.onFragParsingInitSegment=function(e){var t=this.fragCurrent,i=e.frag;if(t&&"main"===e.id&&i.sn===t.sn&&i.level===t.level&&this.state===Te){var r,n,a=e.tracks;if(a.audio&&this.altAudio&&delete a.audio,n=a.audio){var s=this.levels[this.level].audioCodec,o=navigator.userAgent.toLowerCase();s&&this.audioCodecSwap&&(u.b.log("swapping playlist audio codec"),s=-1!==s.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5"),this.audioCodecSwitch&&1!==n.metadata.channelCount&&-1===o.indexOf("firefox")&&(s="mp4a.40.5"),-1!==o.indexOf("android")&&"audio/mpeg"!==n.container&&(s="mp4a.40.2",u.b.log("Android: force audio codec to "+s)),n.levelCodec=s,n.id=e.id}for(r in(n=a.video)&&(n.levelCodec=this.levels[this.level].videoCodec,n.id=e.id),this.hls.trigger(d.a.BUFFER_CODECS,a),a){n=a[r],u.b.log("main track:"+r+",container:"+n.container+",codecs[level/parsed]=["+n.levelCodec+"/"+n.codec+"]");var l=n.initSegment;l&&(this.appended=!0,this.pendingBuffering=!0,this.hls.trigger(d.a.BUFFER_APPENDING,{type:r,data:l,parent:"main",content:"initSegment"}))}this.tick()}},c.onFragParsingData=function(e){var t=this,i=this.fragCurrent,r=e.frag;if(i&&"main"===e.id&&r.sn===i.sn&&r.level===i.level&&("audio"!==e.type||!this.altAudio)&&this.state===Te){var n=this.levels[this.level],a=i;if(Object(l.a)(e.endPTS)||(e.endPTS=e.startPTS+i.duration,e.endDTS=e.startDTS+i.duration),!0===e.hasAudio&&a.addElementaryStream(m.AUDIO),!0===e.hasVideo&&a.addElementaryStream(m.VIDEO),u.b.log("Parsed "+e.type+",PTS:["+e.startPTS.toFixed(3)+","+e.endPTS.toFixed(3)+"],DTS:["+e.startDTS.toFixed(3)+"/"+e.endDTS.toFixed(3)+"],nb:"+e.nb+",dropped:"+(e.dropped||0)),"video"===e.type)if(a.dropped=e.dropped,a.dropped)if(a.backtracked)u.b.warn("Already backtracked on this fragment, appending with the gap",a.sn);else{var s=n.details;if(!s||a.sn!==s.startSN)return u.b.warn("missing video frame(s), backtracking fragment",a.sn),this.fragmentTracker.removeFragment(a),a.backtracked=!0,this.nextLoadPosition=e.startPTS,this.state=ge,this.fragPrevious=a,void this.tick();u.b.warn("missing video frame(s) on first frag, appending with gap",a.sn)}else a.backtracked=!1;var o=ee(n.details,a,e.startPTS,e.endPTS,e.startDTS,e.endDTS),c=this.hls;c.trigger(d.a.LEVEL_PTS_UPDATED,{details:n.details,level:this.level,drift:o,type:e.type,start:e.startPTS,end:e.endPTS}),[e.data1,e.data2].forEach((function(i){i&&i.length&&t.state===Te&&(t.appended=!0,t.pendingBuffering=!0,c.trigger(d.a.BUFFER_APPENDING,{type:e.type,data:i,parent:"main",content:"data"}))})),this.tick()}},c.onFragParsed=function(e){var t=this.fragCurrent,i=e.frag;t&&"main"===e.id&&i.sn===t.sn&&i.level===t.level&&this.state===Te&&(this.stats.tparsed=window.performance.now(),this.state=Ee,this._checkAppendedParsed())},c.onAudioTrackSwitching=function(e){var t=!!e.url,i=e.id;if(!t){if(this.mediaBuffer!==this.media){u.b.log("switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;var r=this.fragCurrent;r.loader&&(u.b.log("switching to main audio track, cancel main fragment load"),r.loader.abort()),this.fragCurrent=null,this.fragPrevious=null,this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.state=ge}var n=this.hls;n.trigger(d.a.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"}),n.trigger(d.a.AUDIO_TRACK_SWITCHED,{id:i}),this.altAudio=!1}},c.onAudioTrackSwitched=function(e){var t=e.id,i=!!this.hls.audioTracks[t].url;if(i){var r=this.videoBuffer;r&&this.mediaBuffer!==r&&(u.b.log("switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=r)}this.altAudio=i,this.tick()},c.onBufferCreated=function(e){var t,i,r=e.tracks,n=!1;for(var a in r){var s=r[a];"main"===s.id?(i=a,t=s,"video"===a&&(this.videoBuffer=r[a].buffer)):n=!0}n&&t?(u.b.log("alternate track found, use "+i+".buffered to schedule main fragment loading"),this.mediaBuffer=t.buffer):this.mediaBuffer=this.media},c.onBufferAppended=function(e){if("main"===e.parent){var t=this.state;t!==Te&&t!==Ee||(this.pendingBuffering=e.pending>0,this._checkAppendedParsed())}},c._checkAppendedParsed=function(){if(!(this.state!==Ee||this.appended&&this.pendingBuffering)){var e=this.fragCurrent;if(e){var t=this.mediaBuffer?this.mediaBuffer:this.media;u.b.log("main buffered : "+ne(t.buffered)),this.fragPrevious=e;var i=this.stats;i.tbuffered=window.performance.now(),this.fragLastKbps=Math.round(8*i.total/(i.tbuffered-i.tfirst)),this.hls.trigger(d.a.FRAG_BUFFERED,{stats:i,frag:e,id:"main"}),this.state=ge}this.tick()}},c.onError=function(e){var t=e.frag||this.fragCurrent;if(!t||"main"===t.type){var i=!!this.media&&H.isBuffered(this.media,this.media.currentTime)&&H.isBuffered(this.media,this.media.currentTime+.5);switch(e.details){case o.a.FRAG_LOAD_ERROR:case o.a.FRAG_LOAD_TIMEOUT:case o.a.KEY_LOAD_ERROR:case o.a.KEY_LOAD_TIMEOUT:if(!e.fatal)if(this.fragLoadError+1<=this.config.fragLoadingMaxRetry){var r=Math.min(Math.pow(2,this.fragLoadError)*this.config.fragLoadingRetryDelay,this.config.fragLoadingMaxRetryTimeout);u.b.warn("mediaController: frag loading failed, retry in "+r+" ms"),this.retryDate=window.performance.now()+r,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.fragLoadError++,this.state=we}else u.b.error("mediaController: "+e.details+" reaches max retry, redispatch as fatal ..."),e.fatal=!0,this.state=Ae;break;case o.a.LEVEL_LOAD_ERROR:case o.a.LEVEL_LOAD_TIMEOUT:this.state!==Ae&&(e.fatal?(this.state=Ae,u.b.warn("streamController: "+e.details+",switch to "+this.state+" state ...")):e.levelRetry||this.state!==Re||(this.state=ge));break;case o.a.BUFFER_FULL_ERROR:"main"!==e.parent||this.state!==Te&&this.state!==Ee||(i?(this._reduceMaxBufferLength(this.config.maxBufferLength),this.state=ge):(u.b.warn("buffer full error also media.currentTime is not buffered, flush everything"),this.fragCurrent=null,this.flushMainBuffer(0,Number.POSITIVE_INFINITY)))}}},c._reduceMaxBufferLength=function(e){var t=this.config;return t.maxMaxBufferLength>=e&&(t.maxMaxBufferLength/=2,u.b.warn("main:reduce max buffer length to "+t.maxMaxBufferLength+"s"),!0)},c._checkBuffer=function(){var e=this.media;if(e&&0!==e.readyState){var t=(this.mediaBuffer?this.mediaBuffer:e).buffered;!this.loadedmetadata&&t.length?(this.loadedmetadata=!0,this._seekToStartPos()):this.immediateSwitch?this.immediateLevelSwitchEnd():this.gapController.poll(this.lastCurrentTime,t)}},c.onFragLoadEmergencyAborted=function(){this.state=ge,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tick()},c.onBufferFlushed=function(){var e=this.mediaBuffer?this.mediaBuffer:this.media;e&&this.fragmentTracker.detectEvictedFragments(m.VIDEO,e.buffered),this.state=ge,this.fragPrevious=null},c.swapAudioCodec=function(){this.audioCodecSwap=!this.audioCodecSwap},c._seekToStartPos=function(){var e=this.media,t=e.currentTime,i=e.seeking?t:this.startPosition;t!==i&&i>=0&&(u.b.log("target start position not buffered, seek to buffered.start(0) "+i+" from current time "+t+" "),e.currentTime=i)},c._getAudioCodec=function(e){var t=this.config.defaultAudioCodec||e.audioCodec;return this.audioCodecSwap&&(u.b.log("swapping playlist audio codec"),t&&(t=-1!==t.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5")),t},n=r,(s=[{key:"state",set:function(e){if(this.state!==e){var t=this.state;this._state=e,u.b.log("main stream-controller: "+t+"->"+e),this.hls.trigger(d.a.STREAM_STATE_TRANSITION,{previousState:t,nextState:e})}},get:function(){return this._state}},{key:"currentLevel",get:function(){var e=this.media;if(e){var t=this.getBufferedFrag(e.currentTime);if(t)return t.level}return-1}},{key:"nextBufferedFrag",get:function(){var e=this.media;return e?this.followingBufferedFrag(this.getBufferedFrag(e.currentTime)):null}},{key:"nextLevel",get:function(){var e=this.nextBufferedFrag;return e?e.level:-1}},{key:"liveSyncPosition",get:function(){return this._liveSyncPosition},set:function(e){this._liveSyncPosition=e}}])&&De(n.prototype,s),r}(Le);function Oe(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}window.performance;var Pe,Ie=function(e){var t,i;function r(t){var i;return(i=e.call(this,t,d.a.MANIFEST_LOADED,d.a.LEVEL_LOADED,d.a.AUDIO_TRACK_SWITCHED,d.a.FRAG_LOADED,d.a.ERROR)||this).canload=!1,i.currentLevelIndex=null,i.manualLevelIndex=-1,i.timer=null,Pe=/chrome|firefox/.test(navigator.userAgent.toLowerCase()),i}i=e,(t=r).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var n,a,s=r.prototype;return s.onHandlerDestroying=function(){this.clearTimer(),this.manualLevelIndex=-1},s.clearTimer=function(){null!==this.timer&&(clearTimeout(this.timer),this.timer=null)},s.startLoad=function(){var e=this._levels;this.canload=!0,this.levelRetryCount=0,e&&e.forEach((function(e){e.loadError=0;var t=e.details;t&&t.live&&(e.details=void 0)})),null!==this.timer&&this.loadLevel()},s.stopLoad=function(){this.canload=!1},s.onManifestLoaded=function(e){var t,i=[],r=[],n={},a=null,s=!1,l=!1;if(e.levels.forEach((function(e){var t=e.attrs;e.loadError=0,e.fragmentError=!1,s=s||!!e.videoCodec,l=l||!!e.audioCodec,Pe&&e.audioCodec&&-1!==e.audioCodec.indexOf("mp4a.40.34")&&(e.audioCodec=void 0),(a=n[e.bitrate])?a.url.push(e.url):(e.url=[e.url],e.urlId=0,n[e.bitrate]=e,i.push(e)),t&&(t.AUDIO&&(l=!0,J(a||e,"audio",t.AUDIO)),t.SUBTITLES&&J(a||e,"text",t.SUBTITLES))})),s&&l&&(i=i.filter((function(e){return!!e.videoCodec}))),i=i.filter((function(e){var t=e.audioCodec,i=e.videoCodec;return(!t||k(t,"audio"))&&(!i||k(i,"video"))})),e.audioTracks&&(r=e.audioTracks.filter((function(e){return!e.audioCodec||k(e.audioCodec,"audio")}))).forEach((function(e,t){e.id=t})),i.length>0){t=i[0].bitrate,i.sort((function(e,t){return e.bitrate-t.bitrate})),this._levels=i;for(var c=0;c<i.length;c++)if(i[c].bitrate===t){this._firstLevel=c,u.b.log("manifest loaded,"+i.length+" level(s) found, first bitrate:"+t);break}this.hls.trigger(d.a.MANIFEST_PARSED,{levels:i,audioTracks:r,firstLevel:this._firstLevel,stats:e.stats,audio:l,video:s,altAudio:r.some((function(e){return!!e.url}))})}else this.hls.trigger(d.a.ERROR,{type:o.b.MEDIA_ERROR,details:o.a.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:this.hls.url,reason:"no level with compatible codecs found in manifest"})},s.setLevelInternal=function(e){var t=this._levels,i=this.hls;if(e>=0&&e<t.length){if(this.clearTimer(),this.currentLevelIndex!==e){u.b.log("switching to level "+e),this.currentLevelIndex=e;var r=t[e];r.level=e,i.trigger(d.a.LEVEL_SWITCHING,r)}var n=t[e],a=n.details;if(!a||a.live){var s=n.urlId;i.trigger(d.a.LEVEL_LOADING,{url:n.url[s],level:e,id:s})}}else i.trigger(d.a.ERROR,{type:o.b.OTHER_ERROR,details:o.a.LEVEL_SWITCH_ERROR,level:e,fatal:!1,reason:"invalid level idx"})},s.onError=function(e){if(e.fatal)e.type===o.b.NETWORK_ERROR&&this.clearTimer();else{var t,i=!1,r=!1;switch(e.details){case o.a.FRAG_LOAD_ERROR:case o.a.FRAG_LOAD_TIMEOUT:case o.a.KEY_LOAD_ERROR:case o.a.KEY_LOAD_TIMEOUT:t=e.frag.level,r=!0;break;case o.a.LEVEL_LOAD_ERROR:case o.a.LEVEL_LOAD_TIMEOUT:t=e.context.level,i=!0;break;case o.a.REMUX_ALLOC_ERROR:t=e.level,i=!0}void 0!==t&&this.recoverLevel(e,t,i,r)}},s.recoverLevel=function(e,t,i,r){var n,a,s,o=this,l=this.hls.config,d=e.details,c=this._levels[t];if(c.loadError++,c.fragmentError=r,i){if(!(this.levelRetryCount+1<=l.levelLoadingMaxRetry))return u.b.error("level controller, cannot recover from "+d+" error"),this.currentLevelIndex=null,this.clearTimer(),void(e.fatal=!0);a=Math.min(Math.pow(2,this.levelRetryCount)*l.levelLoadingRetryDelay,l.levelLoadingMaxRetryTimeout),this.timer=setTimeout((function(){return o.loadLevel()}),a),e.levelRetry=!0,this.levelRetryCount++,u.b.warn("level controller, "+d+", retry in "+a+" ms, current retry count is "+this.levelRetryCount)}(i||r)&&((n=c.url.length)>1&&c.loadError<n?(c.urlId=(c.urlId+1)%n,c.details=void 0,u.b.warn("level controller, "+d+" for level "+t+": switching to redundant URL-id "+c.urlId)):-1===this.manualLevelIndex?(s=0===t?this._levels.length-1:t-1,u.b.warn("level controller, "+d+": switch to "+s),this.hls.nextAutoLevel=this.currentLevelIndex=s):r&&(u.b.warn("level controller, "+d+": reload a fragment"),this.currentLevelIndex=null))},s.onFragLoaded=function(e){var t=e.frag;if(void 0!==t&&"main"===t.type){var i=this._levels[t.level];void 0!==i&&(i.fragmentError=!1,i.loadError=0,this.levelRetryCount=0)}},s.onLevelLoaded=function(e){var t=this,i=e.level,r=e.details;if(i===this.currentLevelIndex){var n=this._levels[i];if(n.fragmentError||(n.loadError=0,this.levelRetryCount=0),r.live){var a=re(n.details,r,e.stats.trequest);u.b.log("live playlist, reload in "+Math.round(a)+" ms"),this.timer=setTimeout((function(){return t.loadLevel()}),a)}else this.clearTimer()}},s.onAudioTrackSwitched=function(e){var t=this.hls.audioTracks[e.id].groupId,i=this.hls.levels[this.currentLevelIndex];if(i&&i.audioGroupIds){for(var r=-1,n=0;n<i.audioGroupIds.length;n++)if(i.audioGroupIds[n]===t){r=n;break}r!==i.urlId&&(i.urlId=r,this.startLoad())}},s.loadLevel=function(){if(u.b.debug("call to loadLevel"),null!==this.currentLevelIndex&&this.canload){var e=this._levels[this.currentLevelIndex];if("object"==typeof e&&e.url.length>0){var t=this.currentLevelIndex,i=e.urlId,r=e.url[i];u.b.log("Attempt loading level index "+t+" with URL-id "+i),this.hls.trigger(d.a.LEVEL_LOADING,{url:r,level:t,id:i})}}},n=r,(a=[{key:"levels",get:function(){return this._levels}},{key:"level",get:function(){return this.currentLevelIndex},set:function(e){var t=this._levels;t&&(e=Math.min(e,t.length-1),this.currentLevelIndex===e&&t[e].details||this.setLevelInternal(e))}},{key:"manualLevel",get:function(){return this.manualLevelIndex},set:function(e){this.manualLevelIndex=e,void 0===this._startLevel&&(this._startLevel=e),-1!==e&&(this.level=e)}},{key:"firstLevel",get:function(){return this._firstLevel},set:function(e){this._firstLevel=e}},{key:"startLevel",get:function(){if(void 0===this._startLevel){var e=this.hls.config.startLevel;return void 0!==e?e:this._firstLevel}return this._startLevel},set:function(e){this._startLevel=e}},{key:"nextLoadLevel",get:function(){return-1!==this.manualLevelIndex?this.manualLevelIndex:this.hls.nextAutoLevel},set:function(e){this.level=e,-1===this.manualLevelIndex&&(this.hls.nextAutoLevel=e)}}])&&Oe(n.prototype,a),r}(h),Me=i(4);function Ne(e,t){var i;try{i=new Event("addtrack")}catch(e){(i=document.createEvent("Event")).initEvent("addtrack",!1,!1)}i.track=e,t.dispatchEvent(i)}function Fe(e){if(e&&e.cues)for(;e.cues.length>0;)e.removeCue(e.cues[0])}var Ue=function(e){var t,i;function r(t){var i;return(i=e.call(this,t,d.a.MEDIA_ATTACHED,d.a.MEDIA_DETACHING,d.a.FRAG_PARSING_METADATA,d.a.LIVE_BACK_BUFFER_REACHED)||this).id3Track=void 0,i.media=void 0,i}i=e,(t=r).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var n=r.prototype;return n.destroy=function(){h.prototype.destroy.call(this)},n.onMediaAttached=function(e){this.media=e.media,this.media},n.onMediaDetaching=function(){Fe(this.id3Track),this.id3Track=void 0,this.media=void 0},n.getID3Track=function(e){for(var t=0;t<e.length;t++){var i=e[t];if("metadata"===i.kind&&"id3"===i.label)return Ne(i,this.media),i}return this.media.addTextTrack("metadata","id3")},n.onFragParsingMetadata=function(e){var t=e.frag,i=e.samples;this.id3Track||(this.id3Track=this.getID3Track(this.media.textTracks),this.id3Track.mode="hidden");for(var r=window.WebKitDataCue||window.VTTCue||window.TextTrackCue,n=0;n<i.length;n++){var a=Me.a.getID3Frames(i[n].data);if(a){var s=i[n].pts,o=n<i.length-1?i[n+1].pts:t.endPTS;s===o?o+=1e-4:s>o&&(u.b.warn("detected an id3 sample with endTime < startTime, adjusting endTime to (startTime + 0.25)"),o=s+.25);for(var l=0;l<a.length;l++){var d=a[l];if(!Me.a.isTimeStampFrame(d)){var c=new r(s,o,"");c.value=d,this.id3Track.addCue(c)}}}}},n.onLiveBackBufferReached=function(e){var t=e.bufferEnd,i=this.id3Track;if(i&&i.cues&&i.cues.length){var r=function(e,t){if(t<e[0].endTime)return e[0];if(t>e[e.length-1].endTime)return e[e.length-1];for(var i=0,r=e.length-1;i<=r;){var n=Math.floor((r+i)/2);if(t<e[n].endTime)r=n-1;else{if(!(t>e[n].endTime))return e[n];i=n+1}}return e[i].endTime-t<t-e[r].endTime?e[i]:e[r]}(i.cues,t);if(r)for(;i.cues[0]!==r;)i.removeCue(i.cues[0])}},r}(h),Be=function(){function e(e){this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.alpha_=e?Math.exp(Math.log(.5)/e):0,this.estimate_=0,this.totalWeight_=0}var t=e.prototype;return t.sample=function(e,t){var i=Math.pow(this.alpha_,e);this.estimate_=t*(1-i)+i*this.estimate_,this.totalWeight_+=e},t.getTotalWeight=function(){return this.totalWeight_},t.getEstimate=function(){if(this.alpha_){var e=1-Math.pow(this.alpha_,this.totalWeight_);return this.estimate_/e}return this.estimate_},e}(),je=function(){function e(e,t,i,r){this.hls=void 0,this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.hls=e,this.defaultEstimate_=r,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new Be(t),this.fast_=new Be(i)}var t=e.prototype;return t.sample=function(e,t){var i=(e=Math.max(e,this.minDelayMs_))/1e3,r=8*t/i;this.fast_.sample(i,r),this.slow_.sample(i,r)},t.canEstimate=function(){var e=this.fast_;return e&&e.getTotalWeight()>=this.minWeight_},t.getEstimate=function(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_},t.destroy=function(){},e}();function $e(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var He=window.performance,Ge=function(e){var t,i;function r(t){var i;return(i=e.call(this,t,d.a.FRAG_LOADING,d.a.FRAG_LOADED,d.a.FRAG_BUFFERED,d.a.ERROR)||this).lastLoadedFragLevel=0,i._nextAutoLevel=-1,i.hls=t,i.timer=null,i._bwEstimator=null,i.onCheck=i._abandonRulesCheck.bind(function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(i)),i}i=e,(t=r).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var n,a,s=r.prototype;return s.destroy=function(){this.clearTimer(),h.prototype.destroy.call(this)},s.onFragLoading=function(e){var t=e.frag;if("main"===t.type&&(this.timer||(this.fragCurrent=t,this.timer=setInterval(this.onCheck,100)),!this._bwEstimator)){var i,r,n=this.hls,a=n.config,s=t.level;n.levels[s].details.live?(i=a.abrEwmaFastLive,r=a.abrEwmaSlowLive):(i=a.abrEwmaFastVoD,r=a.abrEwmaSlowVoD),this._bwEstimator=new je(n,r,i,a.abrEwmaDefaultEstimate)}},s._abandonRulesCheck=function(){var e=this.hls,t=e.media,i=this.fragCurrent;if(i){var r=i.loader,n=e.minAutoLevel;if(!r||r.stats&&r.stats.aborted)return u.b.warn("frag loader destroy or aborted, disarm abandonRules"),this.clearTimer(),void(this._nextAutoLevel=-1);var a=r.stats;if(t&&a&&(!t.paused&&0!==t.playbackRate||!t.readyState)&&i.autoLevel&&i.level){var s=He.now()-a.trequest,o=Math.abs(t.playbackRate);if(s>500*i.duration/o){var l=e.levels,c=Math.max(1,a.bw?a.bw/8:1e3*a.loaded/s),h=l[i.level],f=h.realBitrate?Math.max(h.realBitrate,h.bitrate):h.bitrate,p=a.total?a.total:Math.max(a.loaded,Math.round(i.duration*f/8)),m=t.currentTime,g=(p-a.loaded)/c,v=(H.bufferInfo(t,m,e.config.maxBufferHole).end-m)/o;if(v<2*i.duration/o&&g>v){var y;for(y=i.level-1;y>n;y--){var b=l[y].realBitrate?Math.max(l[y].realBitrate,l[y].bitrate):l[y].bitrate;if(i.duration*b/(6.4*c)<v)break}void 0<g&&(u.b.warn("loading too slow, abort fragment loading and switch to level "+y+":fragLoadedDelay["+y+"]<fragLoadedDelay["+(i.level-1)+"];bufferStarvationDelay:"+(void 0).toFixed(1)+"<"+g.toFixed(1)+":"+v.toFixed(1)),e.nextLoadLevel=y,this._bwEstimator.sample(s,a.loaded),r.abort(),this.clearTimer(),e.trigger(d.a.FRAG_LOAD_EMERGENCY_ABORTED,{frag:i,stats:a}))}}}}},s.onFragLoaded=function(e){var t=e.frag;if("main"===t.type&&Object(l.a)(t.sn)){if(this.clearTimer(),this.lastLoadedFragLevel=t.level,this._nextAutoLevel=-1,this.hls.config.abrMaxWithRealBitrate){var i=this.hls.levels[t.level],r=(i.loaded?i.loaded.bytes:0)+e.stats.loaded,n=(i.loaded?i.loaded.duration:0)+e.frag.duration;i.loaded={bytes:r,duration:n},i.realBitrate=Math.round(8*r/n)}if(e.frag.bitrateTest){var a=e.stats;a.tparsed=a.tbuffered=a.tload,this.onFragBuffered(e)}}},s.onFragBuffered=function(e){var t=e.stats,i=e.frag;if(!0!==t.aborted&&"main"===i.type&&Object(l.a)(i.sn)&&(!i.bitrateTest||t.tload===t.tbuffered)){var r=t.tparsed-t.trequest;u.b.log("latency/loading/parsing/append/kbps:"+Math.round(t.tfirst-t.trequest)+"/"+Math.round(t.tload-t.tfirst)+"/"+Math.round(t.tparsed-t.tload)+"/"+Math.round(t.tbuffered-t.tparsed)+"/"+Math.round(8*t.loaded/(t.tbuffered-t.trequest))),this._bwEstimator.sample(r,t.loaded),t.bwEstimate=this._bwEstimator.getEstimate(),i.bitrateTest?this.bitrateTestDelay=r/1e3:this.bitrateTestDelay=0}},s.onError=function(e){switch(e.details){case o.a.FRAG_LOAD_ERROR:case o.a.FRAG_LOAD_TIMEOUT:this.clearTimer()}},s.clearTimer=function(){clearInterval(this.timer),this.timer=null},s._findBestLevel=function(e,t,i,r,n,a,s,o,l){for(var d=n;d>=r;d--){var c=l[d];if(c){var h,f=c.details,p=f?f.totalduration/f.fragments.length:t,m=!!f&&f.live;h=d<=e?s*i:o*i;var g=l[d].realBitrate?Math.max(l[d].realBitrate,l[d].bitrate):l[d].bitrate,v=g*p/h;if(u.b.trace("level/adjustedbw/bitrate/avgDuration/maxFetchDuration/fetchDuration: "+d+"/"+Math.round(h)+"/"+g+"/"+p+"/"+a+"/"+v),h>g&&(!v||m&&!this.bitrateTestDelay||v<a))return d}}return-1},n=r,(a=[{key:"nextAutoLevel",get:function(){var e=this._nextAutoLevel,t=this._bwEstimator;if(!(-1===e||t&&t.canEstimate()))return e;var i=this._nextABRAutoLevel;return-1!==e&&(i=Math.min(e,i)),i},set:function(e){this._nextAutoLevel=e}},{key:"_nextABRAutoLevel",get:function(){var e=this.hls,t=e.maxAutoLevel,i=e.levels,r=e.config,n=e.minAutoLevel,a=e.media,s=this.lastLoadedFragLevel,o=this.fragCurrent?this.fragCurrent.duration:0,l=a?a.currentTime:0,d=a&&0!==a.playbackRate?Math.abs(a.playbackRate):1,c=this._bwEstimator?this._bwEstimator.getEstimate():r.abrEwmaDefaultEstimate,h=(H.bufferInfo(a,l,r.maxBufferHole).end-l)/d,f=this._findBestLevel(s,o,c,n,t,h,r.abrBandWidthFactor,r.abrBandWidthUpFactor,i);if(f>=0)return f;u.b.trace("rebuffering expected to happen, lets try to find a quality level minimizing the rebuffering");var p=o?Math.min(o,r.maxStarvationDelay):r.maxStarvationDelay,m=r.abrBandWidthFactor,g=r.abrBandWidthUpFactor;if(0===h){var v=this.bitrateTestDelay;v&&(p=(o?Math.min(o,r.maxLoadingDelay):r.maxLoadingDelay)-v,u.b.trace("bitrate test took "+Math.round(1e3*v)+"ms, set first fragment max fetchDuration to "+Math.round(1e3*p)+" ms"),m=g=1)}return f=this._findBestLevel(s,o,c,n,t,h+p,m,g,i),Math.max(f,0)}}])&&$e(n.prototype,a),r}(h),qe=W(),Ke=function(e){var t,i;function r(t){var i;return(i=e.call(this,t,d.a.MEDIA_ATTACHING,d.a.MEDIA_DETACHING,d.a.MANIFEST_PARSED,d.a.BUFFER_RESET,d.a.BUFFER_APPENDING,d.a.BUFFER_CODECS,d.a.BUFFER_EOS,d.a.BUFFER_FLUSHING,d.a.LEVEL_PTS_UPDATED,d.a.LEVEL_UPDATED)||this)._msDuration=null,i._levelDuration=null,i._levelTargetDuration=10,i._live=null,i._objectUrl=null,i._needsFlush=!1,i._needsEos=!1,i.config=void 0,i.audioTimestampOffset=void 0,i.bufferCodecEventsExpected=0,i._bufferCodecEventsTotal=0,i.media=null,i.mediaSource=null,i.segments=[],i.parent=void 0,i.appending=!1,i.appended=0,i.appendError=0,i.flushBufferCounter=0,i.tracks={},i.pendingTracks={},i.sourceBuffer={},i.flushRange=[],i._onMediaSourceOpen=function(){u.b.log("media source opened"),i.hls.trigger(d.a.MEDIA_ATTACHED,{media:i.media});var e=i.mediaSource;e&&e.removeEventListener("sourceopen",i._onMediaSourceOpen),i.checkPendingTracks()},i._onMediaSourceClose=function(){u.b.log("media source closed")},i._onMediaSourceEnded=function(){u.b.log("media source ended")},i._onSBUpdateEnd=function(){if(i.audioTimestampOffset&&i.sourceBuffer.audio){var e=i.sourceBuffer.audio;u.b.warn("change mpeg audio timestamp offset from "+e.timestampOffset+" to "+i.audioTimestampOffset),e.timestampOffset=i.audioTimestampOffset,delete i.audioTimestampOffset}i._needsFlush&&i.doFlush(),i._needsEos&&i.checkEos(),i.appending=!1;var t=i.parent,r=i.segments.reduce((function(e,i){return i.parent===t?e+1:e}),0),n={},a=i.sourceBuffer;for(var s in a){var o=a[s];if(!o)throw Error("handling source buffer update end error: source buffer for "+s+" uninitilized and unable to update buffered TimeRanges.");n[s]=o.buffered}i.hls.trigger(d.a.BUFFER_APPENDED,{parent:t,pending:r,timeRanges:n}),i._needsFlush||i.doAppending(),i.updateMediaElementDuration(),0===r&&i.flushLiveBackBuffer()},i._onSBUpdateError=function(e){u.b.error("sourceBuffer error:",e),i.hls.trigger(d.a.ERROR,{type:o.b.MEDIA_ERROR,details:o.a.BUFFER_APPENDING_ERROR,fatal:!1})},i.config=t.config,i}i=e,(t=r).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var n=r.prototype;return n.destroy=function(){h.prototype.destroy.call(this)},n.onLevelPtsUpdated=function(e){var t=e.type,i=this.tracks.audio;if("audio"===t&&i&&"audio/mpeg"===i.container){var r=this.sourceBuffer.audio;if(!r)throw Error("Level PTS Updated and source buffer for audio uninitalized");if(Math.abs(r.timestampOffset-e.start)>.1){var n=r.updating;try{r.abort()}catch(e){u.b.warn("can not abort audio buffer: "+e)}n?this.audioTimestampOffset=e.start:(u.b.warn("change mpeg audio timestamp offset from "+r.timestampOffset+" to "+e.start),r.timestampOffset=e.start)}}},n.onManifestParsed=function(e){this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=e.altAudio?2:1,u.b.log(this.bufferCodecEventsExpected+" bufferCodec event(s) expected")},n.onMediaAttaching=function(e){var t=this.media=e.media;if(t&&qe){var i=this.mediaSource=new qe;i.addEventListener("sourceopen",this._onMediaSourceOpen),i.addEventListener("sourceended",this._onMediaSourceEnded),i.addEventListener("sourceclose",this._onMediaSourceClose),t.src=window.URL.createObjectURL(i),this._objectUrl=t.src}},n.onMediaDetaching=function(){u.b.log("media source detaching");var e=this.mediaSource;if(e){if("open"===e.readyState)try{e.endOfStream()}catch(e){u.b.warn("onMediaDetaching:"+e.message+" while calling endOfStream")}e.removeEventListener("sourceopen",this._onMediaSourceOpen),e.removeEventListener("sourceended",this._onMediaSourceEnded),e.removeEventListener("sourceclose",this._onMediaSourceClose),this.media&&(this._objectUrl&&window.URL.revokeObjectURL(this._objectUrl),this.media.src===this._objectUrl?(this.media.removeAttribute("src"),this.media.load()):u.b.warn("media.src was changed by a third party - skip cleanup")),this.mediaSource=null,this.media=null,this._objectUrl=null,this.bufferCodecEventsExpected=this._bufferCodecEventsTotal,this.pendingTracks={},this.tracks={},this.sourceBuffer={},this.flushRange=[],this.segments=[],this.appended=0}this.hls.trigger(d.a.MEDIA_DETACHED)},n.checkPendingTracks=function(){var e=this.bufferCodecEventsExpected,t=this.pendingTracks,i=Object.keys(t).length;(i&&!e||2===i)&&(this.createSourceBuffers(t),this.pendingTracks={},this.doAppending())},n.onBufferReset=function(){var e=this.sourceBuffer;for(var t in e){var i=e[t];try{i&&(this.mediaSource&&this.mediaSource.removeSourceBuffer(i),i.removeEventListener("updateend",this._onSBUpdateEnd),i.removeEventListener("error",this._onSBUpdateError))}catch(e){}}this.sourceBuffer={},this.flushRange=[],this.segments=[],this.appended=0},n.onBufferCodecs=function(e){var t=this;Object.keys(this.sourceBuffer).length||(Object.keys(e).forEach((function(i){t.pendingTracks[i]=e[i]})),this.bufferCodecEventsExpected=Math.max(this.bufferCodecEventsExpected-1,0),this.mediaSource&&"open"===this.mediaSource.readyState&&this.checkPendingTracks())},n.createSourceBuffers=function(e){var t=this.sourceBuffer,i=this.mediaSource;if(!i)throw Error("createSourceBuffers called when mediaSource was null");for(var r in e)if(!t[r]){var n=e[r];if(!n)throw Error("source buffer exists for track "+r+", however track does not");var a=n.levelCodec||n.codec,s=n.container+";codecs="+a;u.b.log("creating sourceBuffer("+s+")");try{var l=t[r]=i.addSourceBuffer(s);l.addEventListener("updateend",this._onSBUpdateEnd),l.addEventListener("error",this._onSBUpdateError),this.tracks[r]={buffer:l,codec:a,id:n.id,container:n.container,levelCodec:n.levelCodec}}catch(e){u.b.error("error while trying to add sourceBuffer:"+e.message),this.hls.trigger(d.a.ERROR,{type:o.b.MEDIA_ERROR,details:o.a.BUFFER_ADD_CODEC_ERROR,fatal:!1,err:e,mimeType:s})}}this.hls.trigger(d.a.BUFFER_CREATED,{tracks:this.tracks})},n.onBufferAppending=function(e){this._needsFlush||(this.segments?this.segments.push(e):this.segments=[e],this.doAppending())},n.onBufferEos=function(e){for(var t in this.sourceBuffer)if(!e.type||e.type===t){var i=this.sourceBuffer[t];i&&!i.ended&&(i.ended=!0,u.b.log(t+" sourceBuffer now EOS"))}this.checkEos()},n.checkEos=function(){var e=this.sourceBuffer,t=this.mediaSource;if(t&&"open"===t.readyState){for(var i in e){var r=e[i];if(r){if(!r.ended)return;if(r.updating)return void(this._needsEos=!0)}}u.b.log("all media data are available, signal endOfStream() to MediaSource and stop loading fragment");try{t.endOfStream()}catch(e){u.b.warn("exception while calling mediaSource.endOfStream()")}this._needsEos=!1}else this._needsEos=!1},n.onBufferFlushing=function(e){e.type?this.flushRange.push({start:e.startOffset,end:e.endOffset,type:e.type}):(this.flushRange.push({start:e.startOffset,end:e.endOffset,type:"video"}),this.flushRange.push({start:e.startOffset,end:e.endOffset,type:"audio"})),this.flushBufferCounter=0,this.doFlush()},n.flushLiveBackBuffer=function(){if(this._live){var e=this.config.liveBackBufferLength;if(isFinite(e)&&!(e<0))if(this.media)for(var t=this.media.currentTime,i=this.sourceBuffer,r=Object.keys(i),n=t-Math.max(e,this._levelTargetDuration),a=r.length-1;a>=0;a--){var s=r[a],o=i[s];if(o){var l=o.buffered;l.length>0&&n>l.start(0)&&this.removeBufferRange(s,o,0,n)&&this.hls.trigger(d.a.LIVE_BACK_BUFFER_REACHED,{bufferEnd:n})}}else u.b.error("flushLiveBackBuffer called without attaching media")}},n.onLevelUpdated=function(e){var t=e.details;t.fragments.length>0&&(this._levelDuration=t.totalduration+t.fragments[0].start,this._levelTargetDuration=t.averagetargetduration||t.targetduration||10,this._live=t.live,this.updateMediaElementDuration())},n.updateMediaElementDuration=function(){var e,t=this.config;if(null!==this._levelDuration&&this.media&&this.mediaSource&&this.sourceBuffer&&0!==this.media.readyState&&"open"===this.mediaSource.readyState){for(var i in this.sourceBuffer){var r=this.sourceBuffer[i];if(r&&!0===r.updating)return}e=this.media.duration,null===this._msDuration&&(this._msDuration=this.mediaSource.duration),!0===this._live&&!0===t.liveDurationInfinity?(u.b.log("Media Source duration is set to Infinity"),this._msDuration=this.mediaSource.duration=1/0):(this._levelDuration>this._msDuration&&this._levelDuration>e||!Object(l.a)(e))&&(u.b.log("Updating Media Source duration to "+this._levelDuration.toFixed(3)),this._msDuration=this.mediaSource.duration=this._levelDuration)}},n.doFlush=function(){for(;this.flushRange.length;){var e=this.flushRange[0];if(!this.flushBuffer(e.start,e.end,e.type))return void(this._needsFlush=!0);this.flushRange.shift(),this.flushBufferCounter=0}if(0===this.flushRange.length){this._needsFlush=!1;var t=0,i=this.sourceBuffer;try{for(var r in i){var n=i[r];n&&(t+=n.buffered.length)}}catch(e){u.b.error("error while accessing sourceBuffer.buffered")}this.appended=t,this.hls.trigger(d.a.BUFFER_FLUSHED)}},n.doAppending=function(){var e=this.config,t=this.hls,i=this.segments,r=this.sourceBuffer;if(Object.keys(r).length){if(!this.media||this.media.error)return this.segments=[],void u.b.error("trying to append although a media error occured, flush segment and abort");if(!this.appending){var n=i.shift();if(n)try{var a=r[n.type];if(!a)return void this._onSBUpdateEnd();if(a.updating)return void i.unshift(n);a.ended=!1,this.parent=n.parent,a.appendBuffer(n.data),this.appendError=0,this.appended++,this.appending=!0}catch(r){u.b.error("error while trying to append buffer:"+r.message),i.unshift(n);var s={type:o.b.MEDIA_ERROR,parent:n.parent,details:"",fatal:!1};22===r.code?(this.segments=[],s.details=o.a.BUFFER_FULL_ERROR):(this.appendError++,s.details=o.a.BUFFER_APPEND_ERROR,this.appendError>e.appendErrorMaxRetry&&(u.b.log("fail "+e.appendErrorMaxRetry+" times to append segment in sourceBuffer"),this.segments=[],s.fatal=!0)),t.trigger(d.a.ERROR,s)}}}},n.flushBuffer=function(e,t,i){var r=this.sourceBuffer;if(!Object.keys(r).length)return!0;var n="null";if(this.media&&(n=this.media.currentTime.toFixed(3)),u.b.log("flushBuffer,pos/start/end: "+n+"/"+e+"/"+t),this.flushBufferCounter>=this.appended)return u.b.warn("abort flushing too many retries"),!0;var a=r[i];if(a){if(a.ended=!1,a.updating)return u.b.warn("cannot flush, sb updating in progress"),!1;if(this.removeBufferRange(i,a,e,t))return this.flushBufferCounter++,!1}return u.b.log("buffer flushed"),!0},n.removeBufferRange=function(e,t,i,r){try{for(var n=0;n<t.buffered.length;n++){var a=t.buffered.start(n),s=t.buffered.end(n),o=Math.max(a,i),l=Math.min(s,r);if(Math.min(l,s)-o>.5){var d="null";return this.media&&(d=this.media.currentTime.toString()),u.b.log("sb remove "+e+" ["+o+","+l+"], of ["+a+","+s+"], pos:"+d),t.remove(o,l),!0}}}catch(e){u.b.warn("removeBufferRange failed",e)}return!1},r}(h);function We(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Ve=function(e){var t,i;function r(t){var i;return(i=e.call(this,t,d.a.FPS_DROP_LEVEL_CAPPING,d.a.MEDIA_ATTACHING,d.a.MANIFEST_PARSED,d.a.BUFFER_CODECS,d.a.MEDIA_DETACHING)||this).autoLevelCapping=Number.POSITIVE_INFINITY,i.firstLevel=null,i.levels=[],i.media=null,i.restrictedLevels=[],i.timer=null,i}i=e,(t=r).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var n,a,s,o=r.prototype;return o.destroy=function(){this.hls.config.capLevelToPlayerSize&&(this.media=null,this.stopCapping())},o.onFpsDropLevelCapping=function(e){r.isLevelAllowed(e.droppedLevel,this.restrictedLevels)&&this.restrictedLevels.push(e.droppedLevel)},o.onMediaAttaching=function(e){this.media=e.media instanceof window.HTMLVideoElement?e.media:null},o.onManifestParsed=function(e){var t=this.hls;this.restrictedLevels=[],this.levels=e.levels,this.firstLevel=e.firstLevel,t.config.capLevelToPlayerSize&&e.video&&this.startCapping()},o.onBufferCodecs=function(e){this.hls.config.capLevelToPlayerSize&&e.video&&this.startCapping()},o.onLevelsUpdated=function(e){this.levels=e.levels},o.onMediaDetaching=function(){this.stopCapping()},o.detectPlayerSize=function(){if(this.media){var e=this.levels?this.levels.length:0;if(e){var t=this.hls;t.autoLevelCapping=this.getMaxLevel(e-1),t.autoLevelCapping>this.autoLevelCapping&&t.streamController.nextLevelSwitch(),this.autoLevelCapping=t.autoLevelCapping}}},o.getMaxLevel=function(e){var t=this;if(!this.levels)return-1;var i=this.levels.filter((function(i,n){return r.isLevelAllowed(n,t.restrictedLevels)&&n<=e}));return r.getMaxLevelByMediaSize(i,this.mediaWidth,this.mediaHeight)},o.startCapping=function(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,this.hls.firstLevel=this.getMaxLevel(this.firstLevel),clearInterval(this.timer),this.timer=setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())},o.stopCapping=function(){this.restrictedLevels=[],this.firstLevel=null,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(this.timer=clearInterval(this.timer),this.timer=null)},r.isLevelAllowed=function(e,t){return void 0===t&&(t=[]),-1===t.indexOf(e)},r.getMaxLevelByMediaSize=function(e,t,i){if(!e||e&&!e.length)return-1;for(var r,n,a=e.length-1,s=0;s<e.length;s+=1){var o=e[s];if((o.width>=t||o.height>=i)&&(r=o,!(n=e[s+1])||r.width!==n.width||r.height!==n.height)){a=s;break}}return a},n=r,s=[{key:"contentScaleFactor",get:function(){var e=1;try{e=window.devicePixelRatio}catch(e){}return e}}],(a=[{key:"mediaWidth",get:function(){var e,t=this.media;return t&&(e=t.width||t.clientWidth||t.offsetWidth,e*=r.contentScaleFactor),e}},{key:"mediaHeight",get:function(){var e,t=this.media;return t&&(e=t.height||t.clientHeight||t.offsetHeight,e*=r.contentScaleFactor),e}}])&&We(n.prototype,a),s&&We(n,s),r}(h),Ye=window.performance,ze=function(e){var t,i;function r(t){return e.call(this,t,d.a.MEDIA_ATTACHING)||this}i=e,(t=r).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var n=r.prototype;return n.destroy=function(){this.timer&&clearInterval(this.timer),this.isVideoPlaybackQualityAvailable=!1},n.onMediaAttaching=function(e){var t=this.hls.config;t.capLevelOnFPSDrop&&("function"==typeof(this.video=e.media instanceof window.HTMLVideoElement?e.media:null).getVideoPlaybackQuality&&(this.isVideoPlaybackQualityAvailable=!0),clearInterval(this.timer),this.timer=setInterval(this.checkFPSInterval.bind(this),t.fpsDroppedMonitoringPeriod))},n.checkFPS=function(e,t,i){var r=Ye.now();if(t){if(this.lastTime){var n=r-this.lastTime,a=i-this.lastDroppedFrames,s=t-this.lastDecodedFrames,o=1e3*a/n,l=this.hls;if(l.trigger(d.a.FPS_DROP,{currentDropped:a,currentDecoded:s,totalDroppedFrames:i}),o>0&&a>l.config.fpsDroppedMonitoringThreshold*s){var c=l.currentLevel;u.b.warn("drop FPS ratio greater than max allowed value for currentLevel: "+c),c>0&&(-1===l.autoLevelCapping||l.autoLevelCapping>=c)&&(c-=1,l.trigger(d.a.FPS_DROP_LEVEL_CAPPING,{level:c,droppedLevel:l.currentLevel}),l.autoLevelCapping=c,l.streamController.nextLevelSwitch())}}this.lastTime=r,this.lastDroppedFrames=i,this.lastDecodedFrames=t}},n.checkFPSInterval=function(){var e=this.video;if(e)if(this.isVideoPlaybackQualityAvailable){var t=e.getVideoPlaybackQuality();this.checkFPS(e,t.totalVideoFrames,t.droppedVideoFrames)}else this.checkFPS(e,e.webkitDecodedFrameCount,e.webkitDroppedFrameCount)},r}(h),Xe=window,Qe=Xe.performance,Je=Xe.XMLHttpRequest,Ze=function(){function e(e){e&&e.xhrSetup&&(this.xhrSetup=e.xhrSetup)}var t=e.prototype;return t.destroy=function(){this.abort(),this.loader=null},t.abort=function(){var e=this.loader;e&&4!==e.readyState&&(this.stats.aborted=!0,e.abort()),window.clearTimeout(this.requestTimeout),this.requestTimeout=null,window.clearTimeout(this.retryTimeout),this.retryTimeout=null},t.load=function(e,t,i){this.context=e,this.config=t,this.callbacks=i,this.stats={trequest:Qe.now(),retry:0},this.retryDelay=t.retryDelay,this.loadInternal()},t.loadInternal=function(){var e,t=this.context;e=this.loader=new Je;var i=this.stats;i.tfirst=0,i.loaded=0;var r=this.xhrSetup;try{if(r)try{r(e,t.url)}catch(i){e.open("GET",t.url,!0),r(e,t.url)}e.readyState||e.open("GET",t.url,!0)}catch(i){return void this.callbacks.onError({code:e.status,text:i.message},t,e)}t.rangeEnd&&e.setRequestHeader("Range","bytes="+t.rangeStart+"-"+(t.rangeEnd-1)),e.onreadystatechange=this.readystatechange.bind(this),e.onprogress=this.loadprogress.bind(this),e.responseType=t.responseType,this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),this.config.timeout),e.send()},t.readystatechange=function(e){var t=e.currentTarget,i=t.readyState,r=this.stats,n=this.context,a=this.config;if(!r.aborted&&i>=2)if(window.clearTimeout(this.requestTimeout),0===r.tfirst&&(r.tfirst=Math.max(Qe.now(),r.trequest)),4===i){var s=t.status;if(s>=200&&s<300){var o,l;r.tload=Math.max(r.tfirst,Qe.now()),l="arraybuffer"===n.responseType?(o=t.response).byteLength:(o=t.responseText).length,r.loaded=r.total=l;var d={url:t.responseURL,data:o};this.callbacks.onSuccess(d,r,n,t)}else r.retry>=a.maxRetry||s>=400&&s<499?(u.b.error(s+" while loading "+n.url),this.callbacks.onError({code:s,text:t.statusText},n,t)):(u.b.warn(s+" while loading "+n.url+", retrying in "+this.retryDelay+"..."),this.destroy(),this.retryTimeout=window.setTimeout(this.loadInternal.bind(this),this.retryDelay),this.retryDelay=Math.min(2*this.retryDelay,a.maxRetryDelay),r.retry++)}else this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),a.timeout)},t.loadtimeout=function(){u.b.warn("timeout while loading "+this.context.url),this.callbacks.onTimeout(this.stats,this.context,null)},t.loadprogress=function(e){var t=e.currentTarget,i=this.stats;i.loaded=e.loaded,e.lengthComputable&&(i.total=e.total);var r=this.callbacks.onProgress;r&&r(i,this.context,null,t)},e}();function et(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var tt=function(e){var t,i;function r(t){var i;return(i=e.call(this,t,d.a.MANIFEST_LOADING,d.a.MANIFEST_PARSED,d.a.AUDIO_TRACK_LOADED,d.a.AUDIO_TRACK_SWITCHED,d.a.LEVEL_LOADED,d.a.ERROR)||this)._trackId=-1,i._selectDefaultTrack=!0,i.tracks=[],i.trackIdBlacklist=Object.create(null),i.audioGroupId=null,i}i=e,(t=r).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var n,a,s=r.prototype;return s.onManifestLoading=function(){this.tracks=[],this._trackId=-1,this._selectDefaultTrack=!0},s.onManifestParsed=function(e){var t=this.tracks=e.audioTracks||[];this.hls.trigger(d.a.AUDIO_TRACKS_UPDATED,{audioTracks:t}),this._selectAudioGroup(this.hls.nextLoadLevel)},s.onAudioTrackLoaded=function(e){if(e.id>=this.tracks.length)u.b.warn("Invalid audio track id:",e.id);else{if(u.b.log("audioTrack "+e.id+" loaded"),this.tracks[e.id].details=e.details,e.details.live&&!this.hasInterval()){var t=1e3*e.details.targetduration;this.setInterval(t)}!e.details.live&&this.hasInterval()&&this.clearInterval()}},s.onAudioTrackSwitched=function(e){var t=this.tracks[e.id].groupId;t&&this.audioGroupId!==t&&(this.audioGroupId=t)},s.onLevelLoaded=function(e){this._selectAudioGroup(e.level)},s.onError=function(e){e.type===o.b.NETWORK_ERROR&&(e.fatal&&this.clearInterval(),e.details===o.a.AUDIO_TRACK_LOAD_ERROR&&(u.b.warn("Network failure on audio-track id:",e.context.id),this._handleLoadError()))},s._setAudioTrack=function(e){if(this._trackId===e&&this.tracks[this._trackId].details)u.b.debug("Same id as current audio-track passed, and track details available -> no-op");else if(e<0||e>=this.tracks.length)u.b.warn("Invalid id passed to audio-track controller");else{var t=this.tracks[e];u.b.log("Now switching to audio-track index "+e),this.clearInterval(),this._trackId=e;var i=t.url,r=t.type,n=t.id;this.hls.trigger(d.a.AUDIO_TRACK_SWITCHING,{id:n,type:r,url:i}),this._loadTrackDetailsIfNeeded(t)}},s.doTick=function(){this._updateTrack(this._trackId)},s._selectAudioGroup=function(e){var t=this.hls.levels[e];if(t&&t.audioGroupIds){var i=t.audioGroupIds[t.urlId];this.audioGroupId!==i&&(this.audioGroupId=i,this._selectInitialAudioTrack())}},s._selectInitialAudioTrack=function(){var e=this,t=this.tracks;if(t.length){var i=this.tracks[this._trackId],r=null;if(i&&(r=i.name),this._selectDefaultTrack){var n=t.filter((function(e){return e.default}));n.length?t=n:u.b.warn("No default audio tracks defined")}var a=!1,s=function(){t.forEach((function(t){a||e.audioGroupId&&t.groupId!==e.audioGroupId||r&&r!==t.name||(e._setAudioTrack(t.id),a=!0)}))};s(),a||(r=null,s()),a||(u.b.error("No track found for running audio group-ID: "+this.audioGroupId),this.hls.trigger(d.a.ERROR,{type:o.b.MEDIA_ERROR,details:o.a.AUDIO_TRACK_LOAD_ERROR,fatal:!0}))}},s._needsTrackLoading=function(e){var t=e.details,i=e.url;return!(t&&!t.live||!i)},s._loadTrackDetailsIfNeeded=function(e){if(this._needsTrackLoading(e)){var t=e.url,i=e.id;u.b.log("loading audio-track playlist for id: "+i),this.hls.trigger(d.a.AUDIO_TRACK_LOADING,{url:t,id:i})}},s._updateTrack=function(e){if(!(e<0||e>=this.tracks.length)){this.clearInterval(),this._trackId=e,u.b.log("trying to update audio-track "+e);var t=this.tracks[e];this._loadTrackDetailsIfNeeded(t)}},s._handleLoadError=function(){this.trackIdBlacklist[this._trackId]=!0;var e=this._trackId,t=this.tracks[e],i=t.name,r=t.language,n=t.groupId;u.b.warn("Loading failed on audio track id: "+e+", group-id: "+n+', name/language: "'+i+'" / "'+r+'"');for(var a=e,s=0;s<this.tracks.length;s++)if(!this.trackIdBlacklist[s]&&this.tracks[s].name===i){a=s;break}a!==e?(u.b.log("Attempting audio-track fallback id:",a,"group-id:",this.tracks[a].groupId),this._setAudioTrack(a)):u.b.warn('No fallback audio-track found for name/language: "'+i+'" / "'+r+'"')},n=r,(a=[{key:"audioTracks",get:function(){return this.tracks}},{key:"audioTrack",get:function(){return this._trackId},set:function(e){this._setAudioTrack(e),this._selectDefaultTrack=!1}}])&&et(n.prototype,a),r}(fe);function it(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var rt=window.performance,nt=function(e){var t,i;function r(t,i){var r;return(r=e.call(this,t,d.a.MEDIA_ATTACHED,d.a.MEDIA_DETACHING,d.a.AUDIO_TRACKS_UPDATED,d.a.AUDIO_TRACK_SWITCHING,d.a.AUDIO_TRACK_LOADED,d.a.KEY_LOADED,d.a.FRAG_LOADED,d.a.FRAG_PARSING_INIT_SEGMENT,d.a.FRAG_PARSING_DATA,d.a.FRAG_PARSED,d.a.ERROR,d.a.BUFFER_RESET,d.a.BUFFER_CREATED,d.a.BUFFER_APPENDED,d.a.BUFFER_FLUSHED,d.a.INIT_PTS_FOUND)||this).fragmentTracker=i,r.config=t.config,r.audioCodecSwap=!1,r._state=pe,r.initPTS=[],r.waitingFragment=null,r.videoTrackCC=null,r}i=e,(t=r).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var n,a,s=r.prototype;return s.onInitPtsFound=function(e){var t=e.id,i=e.frag.cc,r=e.initPTS;"main"===t&&(this.initPTS[i]=r,this.videoTrackCC=i,u.b.log("InitPTS for cc: "+i+" found from video track: "+r),this.state===Ce&&this.tick())},s.startLoad=function(e){if(this.tracks){var t=this.lastCurrentTime;this.stopLoad(),this.setInterval(100),this.fragLoadError=0,t>0&&-1===e?(u.b.log("audio:override startPosition with lastCurrentTime @"+t.toFixed(3)),this.state=ge):(this.lastCurrentTime=this.startPosition?this.startPosition:e,this.state=me),this.nextLoadPosition=this.startPosition=this.lastCurrentTime,this.tick()}else this.startPosition=e,this.state=pe},s.doTick=function(){var e,t,i,r=this.hls,n=r.config;switch(this.state){case Ae:case ve:case Se:break;case me:this.state=_e,this.loadedmetadata=!1;break;case ge:var a=this.tracks;if(!a)break;if(!this.media&&(this.startFragRequested||!n.startFragPrefetch))break;if(this.loadedmetadata)e=this.media.currentTime;else if(void 0===(e=this.nextLoadPosition))break;var s=this.mediaBuffer?this.mediaBuffer:this.media,o=this.videoBuffer?this.videoBuffer:this.media,c=H.bufferInfo(s,e,n.maxBufferHole),h=H.bufferInfo(o,e,n.maxBufferHole),f=c.len,p=c.end,m=this.fragPrevious,g=Math.min(n.maxBufferLength,n.maxMaxBufferLength),v=Math.max(g,h.len),y=this.audioSwitch,b=this.trackId;if((f<v||y)&&b<a.length){if(void 0===(i=a[b].details)){this.state=_e;break}if(!y&&this._streamEnded(c,i))return this.hls.trigger(d.a.BUFFER_EOS,{type:"audio"}),void(this.state=ke);var w,_=i.fragments,T=_.length,E=_[0].start,S=_[T-1].start+_[T-1].duration;if(y)if(i.live&&!i.PTSKnown)u.b.log("switching audiotrack, live stream, unknown PTS,load first fragment"),p=0;else if(p=e,i.PTSKnown&&e<E){if(!(c.end>E||c.nextStart))return;u.b.log("alt audio track ahead of main track, seek to start of alt audio track"),this.media.currentTime=E+.05}if(i.initSegment&&!i.initSegment.data)w=i.initSegment;else if(p<=E){if(w=_[0],null!==this.videoTrackCC&&w.cc!==this.videoTrackCC&&(w=function(e,t){return $(e,(function(e){return e.cc<t?1:e.cc>t?-1:0}))}(_,this.videoTrackCC)),i.live&&w.loadIdx&&w.loadIdx===this.fragLoadIdx){var k=c.nextStart?c.nextStart:E;return u.b.log("no alt audio available @currentTime:"+this.media.currentTime+", seeking @"+(k+.05)),void(this.media.currentTime=k+.05)}}else{var A,C=n.maxFragLookUpTolerance,R=m?_[m.sn-_[0].sn+1]:void 0,L=function(e){var t=Math.min(C,e.duration);return e.start+e.duration-t<=p?1:e.start-t>p&&e.start?-1:0};p<S?(p>S-C&&(C=0),A=R&&!L(R)?R:$(_,L)):A=_[T-1],A&&(w=A,E=A.start,m&&w.level===m.level&&w.sn===m.sn&&(w.sn<i.endSN?(w=_[w.sn+1-i.startSN],u.b.log("SN just loaded, load next one: "+w.sn)):w=null))}w&&(w.encrypted?(u.b.log("Loading key for "+w.sn+" of ["+i.startSN+" ,"+i.endSN+"],track "+b),this.state=ye,r.trigger(d.a.KEY_LOADING,{frag:w})):(u.b.log("Loading "+w.sn+", cc: "+w.cc+" of ["+i.startSN+" ,"+i.endSN+"],track "+b+", currentTime:"+e+",bufferEnd:"+p.toFixed(3)),this.fragCurrent=w,(y||this.fragmentTracker.getState(w)===F)&&("initSegment"!==w.sn&&(this.startFragRequested=!0),Object(l.a)(w.sn)&&(this.nextLoadPosition=w.start+w.duration),r.trigger(d.a.FRAG_LOADING,{frag:w}),this.state=be)))}break;case _e:(t=this.tracks[this.trackId])&&t.details&&(this.state=ge);break;case we:var D=rt.now(),x=this.retryDate,O=(s=this.media)&&s.seeking;(!x||D>=x||O)&&(u.b.log("audioStreamController: retryDate reached, switch back to IDLE state"),this.state=ge);break;case Ce:var P=this.videoTrackCC;if(void 0===this.initPTS[P])break;var I=this.waitingFragment;if(I){var M=I.frag.cc;P!==M?(t=this.tracks[this.trackId]).details&&t.details.live&&(u.b.warn("Waiting fragment CC ("+M+") does not match video track CC ("+P+")"),this.waitingFragment=null,this.state=ge):(this.state=be,this.onFragLoaded(this.waitingFragment),this.waitingFragment=null)}else this.state=ge}},s.onMediaAttached=function(e){var t=this.media=this.mediaBuffer=e.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),t.addEventListener("seeking",this.onvseeking),t.addEventListener("ended",this.onvended);var i=this.config;this.tracks&&i.autoStartLoad&&this.startLoad(i.startPosition)},s.onMediaDetaching=function(){var e=this.media;e&&e.ended&&(u.b.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),e&&(e.removeEventListener("seeking",this.onvseeking),e.removeEventListener("ended",this.onvended),this.onvseeking=this.onvseeked=this.onvended=null),this.media=this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()},s.onAudioTracksUpdated=function(e){u.b.log("audio tracks updated"),this.tracks=e.audioTracks},s.onAudioTrackSwitching=function(e){var t=!!e.url;this.trackId=e.id,this.fragCurrent=null,this.state=ve,this.waitingFragment=null,t?this.setInterval(100):this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),t&&(this.audioSwitch=!0,this.state=ge),this.tick()},s.onAudioTrackLoaded=function(e){var t=e.details,i=e.id,r=this.tracks[i],n=t.totalduration,a=0;if(u.b.log("track "+i+" loaded ["+t.startSN+","+t.endSN+"],duration:"+n),t.live){var s=r.details;s&&t.fragments.length>0?(te(s,t),a=t.fragments[0].start,t.PTSKnown?u.b.log("live audio playlist sliding:"+a.toFixed(3)):u.b.log("live audio playlist - outdated PTS, unknown sliding")):(t.PTSKnown=!1,u.b.log("live audio playlist - first load, unknown sliding"))}else t.PTSKnown=!1;if(r.details=t,!this.startFragRequested){if(-1===this.startPosition){var o=t.startTimeOffset;Object(l.a)(o)?(u.b.log("start time offset found in playlist, adjust startPosition to "+o),this.startPosition=o):t.live?(this.startPosition=this.computeLivePosition(a,t),u.b.log("compute startPosition for audio-track to "+this.startPosition)):this.startPosition=0}this.nextLoadPosition=this.startPosition}this.state===_e&&(this.state=ge),this.tick()},s.onKeyLoaded=function(){this.state===ye&&(this.state=ge,this.tick())},s.onFragLoaded=function(e){var t=this.fragCurrent,i=e.frag;if(this.state===be&&t&&"audio"===i.type&&i.level===t.level&&i.sn===t.sn){var r=this.tracks[this.trackId],n=r.details,a=n.totalduration,s=t.level,o=t.sn,l=t.cc,c=this.config.defaultAudioCodec||r.audioCodec||"mp4a.40.2",h=this.stats=e.stats;if("initSegment"===o)this.state=ge,h.tparsed=h.tbuffered=rt.now(),n.initSegment.data=e.payload,this.hls.trigger(d.a.FRAG_BUFFERED,{stats:h,frag:t,id:"audio"}),this.tick();else{this.state=Te,this.appended=!1,this.demuxer||(this.demuxer=new Q(this.hls,"audio"));var f=this.initPTS[l],p=n.initSegment?n.initSegment.data:[];n.initSegment||void 0!==f?(this.pendingBuffering=!0,u.b.log("Demuxing "+o+" of ["+n.startSN+" ,"+n.endSN+"],track "+s),this.demuxer.push(e.payload,p,c,null,t,a,!1,f)):(u.b.log("unknown video PTS for continuity counter "+l+", waiting for video PTS before demuxing audio frag "+o+" of ["+n.startSN+" ,"+n.endSN+"],track "+s),this.waitingFragment=e,this.state=Ce)}}this.fragLoadError=0},s.onFragParsingInitSegment=function(e){var t=this.fragCurrent,i=e.frag;if(t&&"audio"===e.id&&i.sn===t.sn&&i.level===t.level&&this.state===Te){var r,n=e.tracks;if(n.video&&delete n.video,r=n.audio){r.levelCodec=r.codec,r.id=e.id,this.hls.trigger(d.a.BUFFER_CODECS,n),u.b.log("audio track:audio,container:"+r.container+",codecs[level/parsed]=["+r.levelCodec+"/"+r.codec+"]");var a=r.initSegment;if(a){var s={type:"audio",data:a,parent:"audio",content:"initSegment"};this.audioSwitch?this.pendingData=[s]:(this.appended=!0,this.pendingBuffering=!0,this.hls.trigger(d.a.BUFFER_APPENDING,s))}this.tick()}}},s.onFragParsingData=function(e){var t=this,i=this.fragCurrent,r=e.frag;if(i&&"audio"===e.id&&"audio"===e.type&&r.sn===i.sn&&r.level===i.level&&this.state===Te){var n=this.trackId,a=this.tracks[n],s=this.hls;Object(l.a)(e.endPTS)||(e.endPTS=e.startPTS+i.duration,e.endDTS=e.startDTS+i.duration),i.addElementaryStream(m.AUDIO),u.b.log("parsed "+e.type+",PTS:["+e.startPTS.toFixed(3)+","+e.endPTS.toFixed(3)+"],DTS:["+e.startDTS.toFixed(3)+"/"+e.endDTS.toFixed(3)+"],nb:"+e.nb),ee(a.details,i,e.startPTS,e.endPTS);var c=this.audioSwitch,h=this.media,f=!1;if(c)if(h&&h.readyState){var p=h.currentTime;u.b.log("switching audio track : currentTime:"+p),p>=e.startPTS&&(u.b.log("switching audio track : flushing all audio"),this.state=Se,s.trigger(d.a.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"}),f=!0,this.audioSwitch=!1,s.trigger(d.a.AUDIO_TRACK_SWITCHED,{id:n}))}else this.audioSwitch=!1,s.trigger(d.a.AUDIO_TRACK_SWITCHED,{id:n});var g=this.pendingData;if(!g)return u.b.warn("Apparently attempt to enqueue media payload without codec initialization data upfront"),void s.trigger(d.a.ERROR,{type:o.b.MEDIA_ERROR,details:null,fatal:!0});this.audioSwitch||([e.data1,e.data2].forEach((function(t){t&&t.length&&g.push({type:e.type,data:t,parent:"audio",content:"data"})})),!f&&g.length&&(g.forEach((function(e){t.state===Te&&(t.pendingBuffering=!0,t.hls.trigger(d.a.BUFFER_APPENDING,e))})),this.pendingData=[],this.appended=!0)),this.tick()}},s.onFragParsed=function(e){var t=this.fragCurrent,i=e.frag;t&&"audio"===e.id&&i.sn===t.sn&&i.level===t.level&&this.state===Te&&(this.stats.tparsed=rt.now(),this.state=Ee,this._checkAppendedParsed())},s.onBufferReset=function(){this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1},s.onBufferCreated=function(e){var t=e.tracks.audio;t&&(this.mediaBuffer=t.buffer,this.loadedmetadata=!0),e.tracks.video&&(this.videoBuffer=e.tracks.video.buffer)},s.onBufferAppended=function(e){if("audio"===e.parent){var t=this.state;t!==Te&&t!==Ee||(this.pendingBuffering=e.pending>0,this._checkAppendedParsed())}},s._checkAppendedParsed=function(){if(!(this.state!==Ee||this.appended&&this.pendingBuffering)){var e=this.fragCurrent,t=this.stats,i=this.hls;if(e){this.fragPrevious=e,t.tbuffered=rt.now(),i.trigger(d.a.FRAG_BUFFERED,{stats:t,frag:e,id:"audio"});var r=this.mediaBuffer?this.mediaBuffer:this.media;r&&u.b.log("audio buffered : "+ne(r.buffered)),this.audioSwitch&&this.appended&&(this.audioSwitch=!1,i.trigger(d.a.AUDIO_TRACK_SWITCHED,{id:this.trackId})),this.state=ge}this.tick()}},s.onError=function(e){var t=e.frag;if(!t||"audio"===t.type)switch(e.details){case o.a.FRAG_LOAD_ERROR:case o.a.FRAG_LOAD_TIMEOUT:var i=e.frag;if(i&&"audio"!==i.type)break;if(!e.fatal){var r=this.fragLoadError;r?r++:r=1;var n=this.config;if(r<=n.fragLoadingMaxRetry){this.fragLoadError=r;var a=Math.min(Math.pow(2,r-1)*n.fragLoadingRetryDelay,n.fragLoadingMaxRetryTimeout);u.b.warn("AudioStreamController: frag loading failed, retry in "+a+" ms"),this.retryDate=rt.now()+a,this.state=we}else u.b.error("AudioStreamController: "+e.details+" reaches max retry, redispatch as fatal ..."),e.fatal=!0,this.state=Ae}break;case o.a.AUDIO_TRACK_LOAD_ERROR:case o.a.AUDIO_TRACK_LOAD_TIMEOUT:case o.a.KEY_LOAD_ERROR:case o.a.KEY_LOAD_TIMEOUT:this.state!==Ae&&(this.state=e.fatal?Ae:ge,u.b.warn("AudioStreamController: "+e.details+" while loading frag, now switching to "+this.state+" state ..."));break;case o.a.BUFFER_FULL_ERROR:if("audio"===e.parent&&(this.state===Te||this.state===Ee)){var s=this.mediaBuffer,l=this.media.currentTime;if(s&&H.isBuffered(s,l)&&H.isBuffered(s,l+.5)){var c=this.config;c.maxMaxBufferLength>=c.maxBufferLength&&(c.maxMaxBufferLength/=2,u.b.warn("AudioStreamController: reduce max buffer length to "+c.maxMaxBufferLength+"s")),this.state=ge}else u.b.warn("AudioStreamController: buffer full error also media.currentTime is not buffered, flush audio buffer"),this.fragCurrent=null,this.state=Se,this.hls.trigger(d.a.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"})}}},s.onBufferFlushed=function(){var e=this,t=this.pendingData;t&&t.length?(u.b.log("AudioStreamController: appending pending audio data after buffer flushed"),t.forEach((function(t){e.hls.trigger(d.a.BUFFER_APPENDING,t)})),this.appended=!0,this.pendingData=[],this.state=Ee):(this.state=ge,this.fragPrevious=null,this.tick())},n=r,(a=[{key:"state",set:function(e){if(this.state!==e){var t=this.state;this._state=e,u.b.log("audio stream:"+t+"->"+e)}},get:function(){return this._state}}])&&it(n.prototype,a),r}(Le),at=function(){if("undefined"!=typeof window&&window.VTTCue)return window.VTTCue;var e={"":!0,lr:!0,rl:!0},t={start:!0,middle:!0,end:!0,left:!0,right:!0};function i(e){return"string"==typeof e&&!!t[e.toLowerCase()]&&e.toLowerCase()}function r(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)e[r]=i[r]}return e}function n(t,n,a){var s=this,o={enumerable:!0};s.hasBeenReset=!1;var l="",d=!1,u=t,c=n,h=a,f=null,p="",m=!0,g="auto",v="start",y=50,b="middle",w=50,_="middle";Object.defineProperty(s,"id",r({},o,{get:function(){return l},set:function(e){l=""+e}})),Object.defineProperty(s,"pauseOnExit",r({},o,{get:function(){return d},set:function(e){d=!!e}})),Object.defineProperty(s,"startTime",r({},o,{get:function(){return u},set:function(e){if("number"!=typeof e)throw new TypeError("Start time must be set to a number.");u=e,this.hasBeenReset=!0}})),Object.defineProperty(s,"endTime",r({},o,{get:function(){return c},set:function(e){if("number"!=typeof e)throw new TypeError("End time must be set to a number.");c=e,this.hasBeenReset=!0}})),Object.defineProperty(s,"text",r({},o,{get:function(){return h},set:function(e){h=""+e,this.hasBeenReset=!0}})),Object.defineProperty(s,"region",r({},o,{get:function(){return f},set:function(e){f=e,this.hasBeenReset=!0}})),Object.defineProperty(s,"vertical",r({},o,{get:function(){return p},set:function(t){var i=function(t){return"string"==typeof t&&!!e[t.toLowerCase()]&&t.toLowerCase()}(t);if(!1===i)throw new SyntaxError("An invalid or illegal string was specified.");p=i,this.hasBeenReset=!0}})),Object.defineProperty(s,"snapToLines",r({},o,{get:function(){return m},set:function(e){m=!!e,this.hasBeenReset=!0}})),Object.defineProperty(s,"line",r({},o,{get:function(){return g},set:function(e){if("number"!=typeof e&&"auto"!==e)throw new SyntaxError("An invalid number or illegal string was specified.");g=e,this.hasBeenReset=!0}})),Object.defineProperty(s,"lineAlign",r({},o,{get:function(){return v},set:function(e){var t=i(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");v=t,this.hasBeenReset=!0}})),Object.defineProperty(s,"position",r({},o,{get:function(){return y},set:function(e){if(e<0||e>100)throw new Error("Position must be between 0 and 100.");y=e,this.hasBeenReset=!0}})),Object.defineProperty(s,"positionAlign",r({},o,{get:function(){return b},set:function(e){var t=i(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");b=t,this.hasBeenReset=!0}})),Object.defineProperty(s,"size",r({},o,{get:function(){return w},set:function(e){if(e<0||e>100)throw new Error("Size must be between 0 and 100.");w=e,this.hasBeenReset=!0}})),Object.defineProperty(s,"align",r({},o,{get:function(){return _},set:function(e){var t=i(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");_=t,this.hasBeenReset=!0}})),s.displayState=void 0}return n.prototype.getCueAsHTML=function(){return window.WebVTT.convertCueToDOMTree(window,this.text)},n}(),st=function(){return{decode:function(e){if(!e)return"";if("string"!=typeof e)throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}}};function ot(){this.window=window,this.state="INITIAL",this.buffer="",this.decoder=new st,this.regionList=[]}function lt(){this.values=Object.create(null)}function dt(e,t,i,r){var n=r?e.split(r):[e];for(var a in n)if("string"==typeof n[a]){var s=n[a].split(i);2===s.length&&t(s[0],s[1])}}lt.prototype={set:function(e,t){this.get(e)||""===t||(this.values[e]=t)},get:function(e,t,i){return i?this.has(e)?this.values[e]:t[i]:this.has(e)?this.values[e]:t},has:function(e){return e in this.values},alt:function(e,t,i){for(var r=0;r<i.length;++r)if(t===i[r]){this.set(e,t);break}},integer:function(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10))},percent:function(e,t){return!!(t.match(/^([\d]{1,3})(\.[\d]*)?%$/)&&(t=parseFloat(t))>=0&&t<=100)&&(this.set(e,t),!0)}};var ut=new at(0,0,0),ct="middle"===ut.align?"middle":"center";function ht(e,t,i){var r=e;function n(){var t=function(e){function t(e,t,i,r){return 3600*(0|e)+60*(0|t)+(0|i)+(0|r)/1e3}var i=e.match(/^(\d+):(\d{2})(:\d{2})?\.(\d{3})/);return i?i[3]?t(i[1],i[2],i[3].replace(":",""),i[4]):i[1]>59?t(i[1],i[2],0,i[4]):t(0,i[1],i[2],i[4]):null}(e);if(null===t)throw new Error("Malformed timestamp: "+r);return e=e.replace(/^[^\sa-zA-Z-]+/,""),t}function a(){e=e.replace(/^\s+/,"")}if(a(),t.startTime=n(),a(),"--\x3e"!==e.substr(0,3))throw new Error("Malformed time stamp (time stamps must be separated by '--\x3e'): "+r);e=e.substr(3),a(),t.endTime=n(),a(),function(e,t){var r=new lt;dt(e,(function(e,t){switch(e){case"region":for(var n=i.length-1;n>=0;n--)if(i[n].id===t){r.set(e,i[n].region);break}break;case"vertical":r.alt(e,t,["rl","lr"]);break;case"line":var a=t.split(","),s=a[0];r.integer(e,s),r.percent(e,s)&&r.set("snapToLines",!1),r.alt(e,s,["auto"]),2===a.length&&r.alt("lineAlign",a[1],["start",ct,"end"]);break;case"position":a=t.split(","),r.percent(e,a[0]),2===a.length&&r.alt("positionAlign",a[1],["start",ct,"end","line-left","line-right","auto"]);break;case"size":r.percent(e,t);break;case"align":r.alt(e,t,["start",ct,"end","left","right"])}}),/:/,/\s/),t.region=r.get("region",null),t.vertical=r.get("vertical","");var n=r.get("line","auto");"auto"===n&&-1===ut.line&&(n=-1),t.line=n,t.lineAlign=r.get("lineAlign","start"),t.snapToLines=r.get("snapToLines",!0),t.size=r.get("size",100),t.align=r.get("align",ct);var a=r.get("position","auto");"auto"===a&&50===ut.position&&(a="start"===t.align||"left"===t.align?0:"end"===t.align||"right"===t.align?100:50),t.position=a}(e,t)}function ft(e){return e.replace(/<br(?: \/)?>/gi,"\n")}ot.prototype={parse:function(e){var t=this;function i(){var e=t.buffer,i=0;for(e=ft(e);i<e.length&&"\r"!==e[i]&&"\n"!==e[i];)++i;var r=e.substr(0,i);return"\r"===e[i]&&++i,"\n"===e[i]&&++i,t.buffer=e.substr(i),r}e&&(t.buffer+=t.decoder.decode(e,{stream:!0}));try{var r;if("INITIAL"===t.state){if(!/\r\n|\n/.test(t.buffer))return this;var n=(r=i()).match(/^(ï»¿)?WEBVTT([ \t].*)?$/);if(!n||!n[0])throw new Error("Malformed WebVTT signature.");t.state="HEADER"}for(var a=!1;t.buffer;){if(!/\r\n|\n/.test(t.buffer))return this;switch(a?a=!1:r=i(),t.state){case"HEADER":/:/.test(r)?dt(r,(function(e,t){}),/:/):r||(t.state="ID");continue;case"NOTE":r||(t.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(r)){t.state="NOTE";break}if(!r)continue;if(t.cue=new at(0,0,""),t.state="CUE",-1===r.indexOf("--\x3e")){t.cue.id=r;continue}case"CUE":try{ht(r,t.cue,t.regionList)}catch(e){t.cue=null,t.state="BADCUE";continue}t.state="CUETEXT";continue;case"CUETEXT":var s=-1!==r.indexOf("--\x3e");if(!r||s&&(a=!0)){t.oncue&&t.oncue(t.cue),t.cue=null,t.state="ID";continue}t.cue.text&&(t.cue.text+="\n"),t.cue.text+=r;continue;case"BADCUE":r||(t.state="ID");continue}}}catch(e){"CUETEXT"===t.state&&t.cue&&t.oncue&&t.oncue(t.cue),t.cue=null,t.state="INITIAL"===t.state?"BADWEBVTT":"BADCUE"}return this},flush:function(){try{if(this.buffer+=this.decoder.decode(),(this.cue||"HEADER"===this.state)&&(this.buffer+="\n\n",this.parse()),"INITIAL"===this.state)throw new Error("Malformed WebVTT signature.")}catch(e){throw e}return this.onflush&&this.onflush(),this}};var pt=ot;function mt(e,t,i,r){for(var n,a,s,o,l,d=window.VTTCue||TextTrackCue,u=0;u<r.rows.length;u++)if(s=!0,o=0,l="",!(n=r.rows[u]).isEmpty()){for(var c=0;c<n.chars.length;c++)n.chars[c].uchar.match(/\s/)&&s?o++:(l+=n.chars[c].uchar,s=!1);n.cueStartTime=t,t===i&&(i+=1e-4),a=new d(t,i,ft(l.trim())),o>=16?o--:o++,navigator.userAgent.match(/Firefox\//)?a.line=u+1:a.line=u>7?u-2:u+1,a.align="left",a.position=Math.max(0,Math.min(100,o/32*100)),e.addCue(a)}}var gt,vt={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},yt=function(e){var t=e;return vt.hasOwnProperty(e)&&(t=vt[e]),String.fromCharCode(t)},bt={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},wt={17:2,18:4,21:6,22:8,23:10,19:13,20:15},_t={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},Tt={25:2,26:4,29:6,30:8,31:10,27:13,28:15},Et=["white","green","blue","cyan","red","yellow","magenta","black","transparent"];!function(e){e[e.ERROR=0]="ERROR",e[e.TEXT=1]="TEXT",e[e.WARNING=2]="WARNING",e[e.INFO=2]="INFO",e[e.DEBUG=3]="DEBUG",e[e.DATA=3]="DATA"}(gt||(gt={}));var St={verboseFilter:{DATA:3,DEBUG:3,INFO:2,WARNING:2,TEXT:1,ERROR:0},time:null,verboseLevel:0,setTime:function(e){this.time=e},log:function(e,t){this.verboseFilter[e],this.verboseLevel}},kt=function(e){for(var t=[],i=0;i<e.length;i++)t.push(e[i].toString(16));return t},At=function(){function e(e,t,i,r,n){this.foreground=void 0,this.underline=void 0,this.italics=void 0,this.background=void 0,this.flash=void 0,this.foreground=e||"white",this.underline=t||!1,this.italics=i||!1,this.background=r||"black",this.flash=n||!1}var t=e.prototype;return t.reset=function(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1},t.setStyles=function(e){for(var t=["foreground","underline","italics","background","flash"],i=0;i<t.length;i++){var r=t[i];e.hasOwnProperty(r)&&(this[r]=e[r])}},t.isDefault=function(){return"white"===this.foreground&&!this.underline&&!this.italics&&"black"===this.background&&!this.flash},t.equals=function(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash},t.copy=function(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash},t.toString=function(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash},e}(),Ct=function(){function e(e,t,i,r,n,a){this.uchar=void 0,this.penState=void 0,this.uchar=e||" ",this.penState=new At(t,i,r,n,a)}var t=e.prototype;return t.reset=function(){this.uchar=" ",this.penState.reset()},t.setChar=function(e,t){this.uchar=e,this.penState.copy(t)},t.setPenState=function(e){this.penState.copy(e)},t.equals=function(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)},t.copy=function(e){this.uchar=e.uchar,this.penState.copy(e.penState)},t.isEmpty=function(){return" "===this.uchar&&this.penState.isDefault()},e}(),Rt=function(){function e(){this.chars=void 0,this.pos=void 0,this.currPenState=void 0,this.cueStartTime=void 0,this.chars=[];for(var e=0;e<100;e++)this.chars.push(new Ct);this.pos=0,this.currPenState=new At}var t=e.prototype;return t.equals=function(e){for(var t=!0,i=0;i<100;i++)if(!this.chars[i].equals(e.chars[i])){t=!1;break}return t},t.copy=function(e){for(var t=0;t<100;t++)this.chars[t].copy(e.chars[t])},t.isEmpty=function(){for(var e=!0,t=0;t<100;t++)if(!this.chars[t].isEmpty()){e=!1;break}return e},t.setCursor=function(e){this.pos!==e&&(this.pos=e),this.pos<0?(St.log("ERROR","Negative cursor position "+this.pos),this.pos=0):this.pos>100&&(St.log("ERROR","Too large cursor position "+this.pos),this.pos=100)},t.moveCursor=function(e){var t=this.pos+e;if(e>1)for(var i=this.pos+1;i<t+1;i++)this.chars[i].setPenState(this.currPenState);this.setCursor(t)},t.backSpace=function(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)},t.insertChar=function(e){e>=144&&this.backSpace();var t=yt(e);this.pos>=100?St.log("ERROR","Cannot insert "+e.toString(16)+" ("+t+") at position "+this.pos+". Skipping it!"):(this.chars[this.pos].setChar(t,this.currPenState),this.moveCursor(1))},t.clearFromPos=function(e){var t;for(t=e;t<100;t++)this.chars[t].reset()},t.clear=function(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()},t.clearToEndOfRow=function(){this.clearFromPos(this.pos)},t.getTextString=function(){for(var e=[],t=!0,i=0;i<100;i++){var r=this.chars[i].uchar;" "!==r&&(t=!1),e.push(r)}return t?"":e.join("")},t.setPenStyles=function(e){this.currPenState.setStyles(e),this.chars[this.pos].setPenState(this.currPenState)},e}(),Lt=function(){function e(){this.rows=void 0,this.currRow=void 0,this.nrRollUpRows=void 0,this.lastOutputScreen=void 0,this.rows=[];for(var e=0;e<15;e++)this.rows.push(new Rt);this.currRow=14,this.nrRollUpRows=null,this.reset()}var t=e.prototype;return t.reset=function(){for(var e=0;e<15;e++)this.rows[e].clear();this.currRow=14},t.equals=function(e){for(var t=!0,i=0;i<15;i++)if(!this.rows[i].equals(e.rows[i])){t=!1;break}return t},t.copy=function(e){for(var t=0;t<15;t++)this.rows[t].copy(e.rows[t])},t.isEmpty=function(){for(var e=!0,t=0;t<15;t++)if(!this.rows[t].isEmpty()){e=!1;break}return e},t.backSpace=function(){this.rows[this.currRow].backSpace()},t.clearToEndOfRow=function(){this.rows[this.currRow].clearToEndOfRow()},t.insertChar=function(e){this.rows[this.currRow].insertChar(e)},t.setPen=function(e){this.rows[this.currRow].setPenStyles(e)},t.moveCursor=function(e){this.rows[this.currRow].moveCursor(e)},t.setCursor=function(e){St.log("INFO","setCursor: "+e),this.rows[this.currRow].setCursor(e)},t.setPAC=function(e){St.log("INFO","pacData = "+JSON.stringify(e));var t=e.row-1;if(this.nrRollUpRows&&t<this.nrRollUpRows-1&&(t=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==t){for(var i=0;i<15;i++)this.rows[i].clear();var r=this.currRow+1-this.nrRollUpRows,n=this.lastOutputScreen;if(n){var a=n.rows[r].cueStartTime;if(a&&St.time&&a<St.time)for(var s=0;s<this.nrRollUpRows;s++)this.rows[t-this.nrRollUpRows+s+1].copy(n.rows[r+s])}}this.currRow=t;var o=this.rows[this.currRow];if(null!==e.indent){var l=e.indent,d=Math.max(l-1,0);o.setCursor(e.indent),e.color=o.chars[d].penState.foreground}var u={foreground:e.color,underline:e.underline,italics:e.italics,background:"black",flash:!1};this.setPen(u)},t.setBkgData=function(e){St.log("INFO","bkgData = "+JSON.stringify(e)),this.backSpace(),this.setPen(e),this.insertChar(32)},t.setRollUpRows=function(e){this.nrRollUpRows=e},t.rollUp=function(){if(null!==this.nrRollUpRows){St.log("TEXT",this.getDisplayText());var e=this.currRow+1-this.nrRollUpRows,t=this.rows.splice(e,1)[0];t.clear(),this.rows.splice(this.currRow,0,t),St.log("INFO","Rolling up")}else St.log("DEBUG","roll_up but nrRollUpRows not set yet")},t.getDisplayText=function(e){e=e||!1;for(var t=[],i="",r=-1,n=0;n<15;n++){var a=this.rows[n].getTextString();a&&(r=n+1,e?t.push("Row "+r+": '"+a+"'"):t.push(a.trim()))}return t.length>0&&(i=e?"["+t.join(" | ")+"]":t.join("\n")),i},t.getTextAndFormat=function(){return this.rows},e}(),Dt=function(){function e(e,t){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.lastCueEndTime=void 0,this.chNr=e,this.outputFilter=t,this.mode=null,this.verbose=0,this.displayedMemory=new Lt,this.nonDisplayedMemory=new Lt,this.lastOutputScreen=new Lt,this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}var t=e.prototype;return t.reset=function(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null},t.getHandler=function(){return this.outputFilter},t.setHandler=function(e){this.outputFilter=e},t.setPAC=function(e){this.writeScreen.setPAC(e)},t.setBkgData=function(e){this.writeScreen.setBkgData(e)},t.setMode=function(e){e!==this.mode&&(this.mode=e,St.log("INFO","MODE="+e),"MODE_POP-ON"===this.mode?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),"MODE_ROLL-UP"!==this.mode&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e)},t.insertChars=function(e){for(var t=0;t<e.length;t++)this.writeScreen.insertChar(e[t]);var i=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";St.log("INFO",i+": "+this.writeScreen.getDisplayText(!0)),"MODE_PAINT-ON"!==this.mode&&"MODE_ROLL-UP"!==this.mode||(St.log("TEXT","DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())},t.ccRCL=function(){St.log("INFO","RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")},t.ccBS=function(){St.log("INFO","BS - BackSpace"),"MODE_TEXT"!==this.mode&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())},t.ccAOF=function(){},t.ccAON=function(){},t.ccDER=function(){St.log("INFO","DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()},t.ccRU=function(e){St.log("INFO","RU("+e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(e)},t.ccFON=function(){St.log("INFO","FON - Flash On"),this.writeScreen.setPen({flash:!0})},t.ccRDC=function(){St.log("INFO","RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")},t.ccTR=function(){St.log("INFO","TR"),this.setMode("MODE_TEXT")},t.ccRTD=function(){St.log("INFO","RTD"),this.setMode("MODE_TEXT")},t.ccEDM=function(){St.log("INFO","EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)},t.ccCR=function(){St.log("INFO","CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)},t.ccENM=function(){St.log("INFO","ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()},t.ccEOC=function(){if(St.log("INFO","EOC - End Of Caption"),"MODE_POP-ON"===this.mode){var e=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=e,this.writeScreen=this.nonDisplayedMemory,St.log("TEXT","DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)},t.ccTO=function(e){St.log("INFO","TO("+e+") - Tab Offset"),this.writeScreen.moveCursor(e)},t.ccMIDROW=function(e){var t={flash:!1};if(t.underline=e%2==1,t.italics=e>=46,t.italics)t.foreground="white";else{var i=Math.floor(e/2)-16;t.foreground=["white","green","blue","cyan","red","yellow","magenta"][i]}St.log("INFO","MIDROW: "+JSON.stringify(t)),this.writeScreen.setPen(t)},t.outputDataUpdate=function(e){void 0===e&&(e=!1);var t=St.time;null!==t&&this.outputFilter&&(null!==this.cueStartTime||this.displayedMemory.isEmpty()?this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,t,this.lastOutputScreen),e&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:t):this.cueStartTime=t,this.lastOutputScreen.copy(this.displayedMemory))},t.cueSplitAtTime=function(e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e))},e}(),xt=function(){function e(e,t,i){this.field=void 0,this.outputs=void 0,this.channels=void 0,this.currChNr=void 0,this.lastCmdA=void 0,this.lastCmdB=void 0,this.lastTime=void 0,this.dataCounters=void 0,this.field=e||1,this.outputs=[t,i],this.channels=[new Dt(1,t),new Dt(2,i)],this.currChNr=-1,this.lastCmdA=null,this.lastCmdB=null,this.lastTime=null,this.dataCounters={padding:0,char:0,cmd:0,other:0}}var t=e.prototype;return t.getHandler=function(e){return this.channels[e].getHandler()},t.setHandler=function(e,t){this.channels[e].setHandler(t)},t.addData=function(e,t){var i,r,n,a=!1;this.lastTime=e,St.setTime(e);for(var s=0;s<t.length;s+=2)r=127&t[s],n=127&t[s+1],0!==r||0!==n?(St.log("DATA","["+kt([t[s],t[s+1]])+"] -> ("+kt([r,n])+")"),(i=this.parseCmd(r,n))||(i=this.parseMidrow(r,n)),i||(i=this.parsePAC(r,n)),i||(i=this.parseBackgroundAttributes(r,n)),i||(a=this.parseChars(r,n))&&(this.currChNr&&this.currChNr>=0?this.channels[this.currChNr-1].insertChars(a):St.log("WARNING","No channel found yet. TEXT-MODE?")),i?this.dataCounters.cmd+=2:a?this.dataCounters.char+=2:(this.dataCounters.other+=2,St.log("WARNING","Couldn't parse cleaned data "+kt([r,n])+" orig: "+kt([t[s],t[s+1]])))):this.dataCounters.padding+=2},t.parseCmd=function(e,t){var i;if(!((20===e||28===e)&&t>=32&&t<=47||(23===e||31===e)&&t>=33&&t<=35))return!1;if(e===this.lastCmdA&&t===this.lastCmdB)return this.lastCmdA=null,this.lastCmdB=null,St.log("DEBUG","Repeated command ("+kt([e,t])+") is dropped"),!0;i=20===e||23===e?1:2;var r=this.channels[i-1];return 20===e||28===e?32===t?r.ccRCL():33===t?r.ccBS():34===t?r.ccAOF():35===t?r.ccAON():36===t?r.ccDER():37===t?r.ccRU(2):38===t?r.ccRU(3):39===t?r.ccRU(4):40===t?r.ccFON():41===t?r.ccRDC():42===t?r.ccTR():43===t?r.ccRTD():44===t?r.ccEDM():45===t?r.ccCR():46===t?r.ccENM():47===t&&r.ccEOC():r.ccTO(t-32),this.lastCmdA=e,this.lastCmdB=t,this.currChNr=i,!0},t.parseMidrow=function(e,t){var i=null;return(17===e||25===e)&&t>=32&&t<=47&&((i=17===e?1:2)!==this.currChNr?(St.log("ERROR","Mismatch channel in midrow parsing"),!1):(this.channels[i-1].ccMIDROW(t),St.log("DEBUG","MIDROW ("+kt([e,t])+")"),!0))},t.parsePAC=function(e,t){var i,r;if(!((e>=17&&e<=23||e>=25&&e<=31)&&t>=64&&t<=127||(16===e||24===e)&&t>=64&&t<=95))return!1;if(e===this.lastCmdA&&t===this.lastCmdB)return this.lastCmdA=null,this.lastCmdB=null,!0;i=e<=23?1:2,r=t>=64&&t<=95?1===i?bt[e]:_t[e]:1===i?wt[e]:Tt[e];var n=this.interpretPAC(r,t);return this.channels[i-1].setPAC(n),this.lastCmdA=e,this.lastCmdB=t,this.currChNr=i,!0},t.interpretPAC=function(e,t){var i,r={color:null,italics:!1,indent:null,underline:!1,row:e};return i=t>95?t-96:t-64,r.underline=1==(1&i),i<=13?r.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(i/2)]:i<=15?(r.italics=!0,r.color="white"):r.indent=4*Math.floor((i-16)/2),r},t.parseChars=function(e,t){var i=null,r=null,n=null;if(e>=25?(i=2,n=e-8):(i=1,n=e),n>=17&&n<=19){var a;a=17===n?t+80:18===n?t+112:t+144,St.log("INFO","Special char '"+yt(a)+"' in channel "+i),r=[a]}else e>=32&&e<=127&&(r=0===t?[e]:[e,t]);if(r){var s=kt(r);St.log("DEBUG","Char codes =  "+s.join(",")),this.lastCmdA=null,this.lastCmdB=null}return r},t.parseBackgroundAttributes=function(e,t){var i,r,n;return((16===e||24===e)&&t>=32&&t<=47||(23===e||31===e)&&t>=45&&t<=47)&&(i={},16===e||24===e?(r=Math.floor((t-32)/2),i.background=Et[r],t%2==1&&(i.background=i.background+"_semi")):45===t?i.background="transparent":(i.foreground="black",47===t&&(i.underline=!0)),n=e<24?1:2,this.channels[n-1].setBkgData(i),this.lastCmdA=null,this.lastCmdB=null,!0)},t.reset=function(){for(var e=0;e<this.channels.length;e++)this.channels[e]&&this.channels[e].reset();this.lastCmdA=null,this.lastCmdB=null},t.cueSplitAtTime=function(e){for(var t=0;t<this.channels.length;t++)this.channels[t]&&this.channels[t].cueSplitAtTime(e)},e}(),Ot=function(){function e(e,t){this.timelineController=void 0,this.trackName=void 0,this.startTime=void 0,this.endTime=void 0,this.screen=void 0,this.timelineController=e,this.trackName=t,this.startTime=null,this.endTime=null,this.screen=null}var t=e.prototype;return t.dispatchCue=function(){null!==this.startTime&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen),this.startTime=null)},t.newCue=function(e,t,i){(null===this.startTime||this.startTime>e)&&(this.startTime=e),this.endTime=t,this.screen=i,this.timelineController.createCaptionsTrack(this.trackName)},e}(),Pt=function(e,t,i){return e.substr(i||0,t.length)===t},It=function(e){for(var t=5381,i=e.length;i;)t=33*t^e.charCodeAt(--i);return(t>>>0).toString()},Mt=function(e,t,i,r,n,a){var s,o=Object(Me.b)(new Uint8Array(e)).trim().replace(/\r\n|\n\r|\n|\r/g,"\n").split("\n"),d="00:00.000",u=0,c=0,h=0,f=[],p=!0,m=!1,g=new pt;g.oncue=function(e){var t=i[r],n=i.ccOffset;t&&t.new&&(void 0!==c?n=i.ccOffset=t.start:function(e,t,i){var r=e[t],n=e[r.prevCC];if(!n||!n.new&&r.new)return e.ccOffset=e.presentationOffset=r.start,void(r.new=!1);for(;n&&n.new;)e.ccOffset+=r.start-n.start,r.new=!1,n=e[(r=n).prevCC];e.presentationOffset=i}(i,r,h)),h&&(n=h-i.presentationOffset),m&&(e.startTime+=n-c,e.endTime+=n-c),e.id=It(e.startTime.toString())+It(e.endTime.toString())+It(e.text),e.text=decodeURIComponent(encodeURIComponent(e.text)),e.endTime>0&&f.push(e)},g.onparsingerror=function(e){s=e},g.onflush=function(){s&&a?a(s):n(f)},o.forEach((function(e){if(p){if(Pt(e,"X-TIMESTAMP-MAP=")){p=!1,m=!0,e.substr(16).split(",").forEach((function(e){Pt(e,"LOCAL:")?d=e.substr(6):Pt(e,"MPEGTS:")&&(u=parseInt(e.substr(7)))}));try{t+(9e4*i[r].start||0)<0&&(t+=8589934592),u-=t,c=function(e){var t=parseInt(e.substr(-3)),i=parseInt(e.substr(-6,2)),r=parseInt(e.substr(-9,2)),n=e.length>9?parseInt(e.substr(0,e.indexOf(":"))):0;if(!(Object(l.a)(t)&&Object(l.a)(i)&&Object(l.a)(r)&&Object(l.a)(n)))throw Error("Malformed X-TIMESTAMP-MAP: Local:"+e);return t+=1e3*i,(t+=6e4*r)+36e5*n}(d)/1e3,h=u/9e4}catch(e){m=!1,s=e}return}""===e&&(p=!1)}g.parse(e+"\n")})),g.flush()};function Nt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ft(e,t){return e&&e.label===t.name&&!(e.textTrack1||e.textTrack2)}var Ut=function(e){var t,i;function r(t){var i;if((i=e.call(this,t,d.a.MEDIA_ATTACHING,d.a.MEDIA_DETACHING,d.a.FRAG_PARSING_USERDATA,d.a.FRAG_DECRYPTED,d.a.MANIFEST_LOADING,d.a.MANIFEST_LOADED,d.a.FRAG_LOADED,d.a.INIT_PTS_FOUND)||this).media=null,i.config=void 0,i.enabled=!0,i.Cues=void 0,i.textTracks=[],i.tracks=[],i.initPTS=[],i.unparsedVttFrags=[],i.cueRanges=[],i.captionsTracks={},i.captionsProperties=void 0,i.cea608Parser=void 0,i.lastSn=-1,i.prevCC=-1,i.vttCCs=null,i.hls=t,i.config=t.config,i.Cues=t.config.cueHandler,i.captionsProperties={textTrack1:{label:i.config.captionsTextTrack1Label,languageCode:i.config.captionsTextTrack1LanguageCode},textTrack2:{label:i.config.captionsTextTrack2Label,languageCode:i.config.captionsTextTrack2LanguageCode}},i.config.enableCEA708Captions){var r=new Ot(Nt(i),"textTrack1"),n=new Ot(Nt(i),"textTrack2");i.cea608Parser=new xt(0,r,n)}return i}i=e,(t=r).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var n=r.prototype;return n.addCues=function(e,t,i,r){for(var n,a,s,o,l=this.cueRanges,d=!1,u=l.length;u--;){var c=l[u],h=(n=c[0],a=c[1],s=t,o=i,Math.min(a,o)-Math.max(n,s));if(h>=0&&(c[0]=Math.min(c[0],t),c[1]=Math.max(c[1],i),d=!0,h/(i-t)>.5))return}d||l.push([t,i]),this.Cues.newCue(this.captionsTracks[e],t,i,r)},n.onInitPtsFound=function(e){var t=this,i=e.frag,r=e.id,n=e.initPTS,a=this.unparsedVttFrags;"main"===r&&(this.initPTS[i.cc]=n),a.length&&(this.unparsedVttFrags=[],a.forEach((function(e){t.onFragLoaded(e)})))},n.getExistingTrack=function(e){var t=this.media;if(t)for(var i=0;i<t.textTracks.length;i++){var r=t.textTracks[i];if(r[e])return r}return null},n.createCaptionsTrack=function(e){var t=this.captionsProperties,i=this.captionsTracks,r=this.media,n=t[e],a=n.label,s=n.languageCode;if(!i[e]){var o=this.getExistingTrack(e);if(o)i[e]=o,Fe(i[e]),Ne(i[e],r);else{var l=this.createTextTrack("captions",a,s);l&&(l[e]=!0,i[e]=l)}}},n.createTextTrack=function(e,t,i){var r=this.media;if(r)return r.addTextTrack(e,t,i)},n.destroy=function(){e.prototype.destroy.call(this)},n.onMediaAttaching=function(e){this.media=e.media,this._cleanTracks()},n.onMediaDetaching=function(){var e=this.captionsTracks;Object.keys(e).forEach((function(t){Fe(e[t]),delete e[t]}))},n.onManifestLoading=function(){this.lastSn=-1,this.prevCC=-1,this.vttCCs={ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!1}},this._cleanTracks()},n._cleanTracks=function(){var e=this.media;if(e){var t=e.textTracks;if(t)for(var i=0;i<t.length;i++)Fe(t[i])}},n.onManifestLoaded=function(e){var t=this;if(this.textTracks=[],this.unparsedVttFrags=this.unparsedVttFrags||[],this.initPTS=[],this.cueRanges=[],this.config.enableWebVTT){this.tracks=e.subtitles||[];var i=this.media?this.media.textTracks:[];this.tracks.forEach((function(e,r){var n;if(r<i.length){for(var a=null,s=0;s<i.length;s++)if(Ft(i[s],e)){a=i[s];break}a&&(n=a)}n||(n=t.createTextTrack("subtitles",e.name,e.lang)),e.default?n.mode=t.hls.subtitleDisplay?"showing":"hidden":n.mode="disabled",t.textTracks.push(n)}))}},n.onFragLoaded=function(e){var t=e.frag,i=e.payload,r=this.cea608Parser,n=this.initPTS,a=this.lastSn,s=this.unparsedVttFrags;if("main"===t.type){var o=t.sn;t.sn!==a+1&&r&&r.reset(),this.lastSn=o}else if("subtitle"===t.type)if(i.byteLength){if(!Object(l.a)(n[t.cc]))return s.push(e),void(n.length&&this.hls.trigger(d.a.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:t}));var u=t.decryptdata;null!=u&&null!=u.key&&"AES-128"===u.method||this._parseVTTs(t,i)}else this.hls.trigger(d.a.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:t})},n._parseVTTs=function(e,t){var i=this.hls,r=this.prevCC,n=this.textTracks,a=this.vttCCs;a[e.cc]||(a[e.cc]={start:e.start,prevCC:r,new:!0},this.prevCC=e.cc),Mt(t,this.initPTS[e.cc],a,e.cc,(function(t){var r=n[e.level];"disabled"!==r.mode?(t.forEach((function(e){if(!r.cues.getCueById(e.id))try{if(r.addCue(e),!r.cues.getCueById(e.id))throw new Error("addCue is failed for: "+e)}catch(i){u.b.debug("Failed occurred on adding cues: "+i);var t=new window.TextTrackCue(e.startTime,e.endTime,e.text);t.id=e.id,r.addCue(t)}})),i.trigger(d.a.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:e})):i.trigger(d.a.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e})}),(function(t){u.b.log("Failed to parse VTT cue: "+t),i.trigger(d.a.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e})}))},n.onFragDecrypted=function(e){var t=e.frag,i=e.payload;if("subtitle"===t.type){if(!Object(l.a)(this.initPTS[t.cc]))return void this.unparsedVttFrags.push(e);this._parseVTTs(t,i)}},n.onFragParsingUserdata=function(e){if(this.enabled&&this.cea608Parser)for(var t=0;t<e.samples.length;t++){var i=e.samples[t].bytes;if(i){var r=this.extractCea608Data(i);this.cea608Parser.addData(e.samples[t].pts,r)}}},n.extractCea608Data=function(e){for(var t,i,r,n=31&e[0],a=2,s=[],o=0;o<n;o++)t=e[a++],i=127&e[a++],r=127&e[a++],0===i&&0===r||0!=(4&t)&&0==(3&t)&&(s.push(i),s.push(r));return s},r}(h);function Bt(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function jt(e){for(var t=[],i=0;i<e.length;i++){var r=e[i];"subtitles"===r.kind&&r.label&&t.push(e[i])}return t}var $t,Ht=function(e){var t,i;function r(t){var i;return(i=e.call(this,t,d.a.MEDIA_ATTACHED,d.a.MEDIA_DETACHING,d.a.MANIFEST_LOADED,d.a.SUBTITLE_TRACK_LOADED)||this).tracks=[],i.trackId=-1,i.media=null,i.stopped=!0,i.subtitleDisplay=!0,i.queuedDefaultTrack=null,i}i=e,(t=r).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var n,a,s=r.prototype;return s.destroy=function(){h.prototype.destroy.call(this)},s.onMediaAttached=function(e){var t=this;this.media=e.media,this.media&&(Object(l.a)(this.queuedDefaultTrack)&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=null),this.trackChangeListener=this._onTextTracksChanged.bind(this),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.subtitlePollingInterval=setInterval((function(){t.trackChangeListener()}),500):this.media.textTracks.addEventListener("change",this.trackChangeListener))},s.onMediaDetaching=function(){this.media&&(this.useTextTrackPolling?clearInterval(this.subtitlePollingInterval):this.media.textTracks.removeEventListener("change",this.trackChangeListener),Object(l.a)(this.subtitleTrack)&&(this.queuedDefaultTrack=this.subtitleTrack),jt(this.media.textTracks).forEach((function(e){Fe(e)})),this.subtitleTrack=-1,this.media=null)},s.onManifestLoaded=function(e){var t=this,i=e.subtitles||[];this.tracks=i,this.hls.trigger(d.a.SUBTITLE_TRACKS_UPDATED,{subtitleTracks:i}),i.forEach((function(e){e.default&&(t.media?t.subtitleTrack=e.id:t.queuedDefaultTrack=e.id)}))},s.onSubtitleTrackLoaded=function(e){var t=this,i=e.id,r=e.details,n=this.trackId,a=this.tracks,s=a[n];if(i>=a.length||i!==n||!s||this.stopped)this._clearReloadTimer();else if(u.b.log("subtitle track "+i+" loaded"),r.live){var o=re(s.details,r,e.stats.trequest);u.b.log("Reloading live subtitle playlist in "+o+"ms"),this.timer=setTimeout((function(){t._loadCurrentTrack()}),o)}else this._clearReloadTimer()},s.startLoad=function(){this.stopped=!1,this._loadCurrentTrack()},s.stopLoad=function(){this.stopped=!0,this._clearReloadTimer()},s._clearReloadTimer=function(){this.timer&&(clearTimeout(this.timer),this.timer=null)},s._loadCurrentTrack=function(){var e=this.trackId,t=this.tracks,i=this.hls,r=t[e];e<0||!r||r.details&&!r.details.live||(u.b.log("Loading subtitle track "+e),i.trigger(d.a.SUBTITLE_TRACK_LOADING,{url:r.url,id:e}))},s._toggleTrackModes=function(e){var t=this.media,i=this.subtitleDisplay,r=this.trackId;if(t){var n=jt(t.textTracks);if(-1===e)[].slice.call(n).forEach((function(e){e.mode="disabled"}));else{var a=n[r];a&&(a.mode="disabled")}var s=n[e];s&&(s.mode=i?"showing":"hidden")}},s._setSubtitleTrackInternal=function(e){var t=this.hls,i=this.tracks;!Object(l.a)(e)||e<-1||e>=i.length||(this.trackId=e,u.b.log("Switching to subtitle track "+e),t.trigger(d.a.SUBTITLE_TRACK_SWITCH,{id:e}),this._loadCurrentTrack())},s._onTextTracksChanged=function(){if(this.media){for(var e=-1,t=jt(this.media.textTracks),i=0;i<t.length;i++)if("hidden"===t[i].mode)e=i;else if("showing"===t[i].mode){e=i;break}this.subtitleTrack=e}},n=r,(a=[{key:"subtitleTracks",get:function(){return this.tracks}},{key:"subtitleTrack",get:function(){return this.trackId},set:function(e){this.trackId!==e&&(this._toggleTrackModes(e),this._setSubtitleTrackInternal(e))}}])&&Bt(n.prototype,a),r}(h),Gt=i(7),qt=window.performance,Kt=function(e){var t,i;function r(t,i){var r;return(r=e.call(this,t,d.a.MEDIA_ATTACHED,d.a.MEDIA_DETACHING,d.a.ERROR,d.a.KEY_LOADED,d.a.FRAG_LOADED,d.a.SUBTITLE_TRACKS_UPDATED,d.a.SUBTITLE_TRACK_SWITCH,d.a.SUBTITLE_TRACK_LOADED,d.a.SUBTITLE_FRAG_PROCESSED,d.a.LEVEL_UPDATED)||this).fragmentTracker=i,r.config=t.config,r.state=pe,r.tracks=[],r.tracksBuffered=[],r.currentTrackId=-1,r.decrypter=new Gt.a(t,t.config),r.lastAVStart=0,r._onMediaSeeking=r.onMediaSeeking.bind(function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(r)),r}i=e,(t=r).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var n=r.prototype;return n.onSubtitleFragProcessed=function(e){var t=e.frag,i=e.success;if(this.fragPrevious=t,this.state=ge,i){var r=this.tracksBuffered[this.currentTrackId];if(r){for(var n,a=t.start,s=0;s<r.length;s++)if(a>=r[s].start&&a<=r[s].end){n=r[s];break}var o=t.start+t.duration;n?n.end=o:(n={start:a,end:o},r.push(n))}}},n.onMediaAttached=function(e){var t=e.media;this.media=t,t.addEventListener("seeking",this._onMediaSeeking),this.state=ge},n.onMediaDetaching=function(){var e=this;this.media&&(this.media.removeEventListener("seeking",this._onMediaSeeking),this.fragmentTracker.removeAllFragments(),this.currentTrackId=-1,this.tracks.forEach((function(t){e.tracksBuffered[t.id]=[]})),this.media=null,this.state=pe)},n.onError=function(e){var t=e.frag;t&&"subtitle"===t.type&&(this.state=ge)},n.onSubtitleTracksUpdated=function(e){var t=this;u.b.log("subtitle tracks updated"),this.tracksBuffered=[],this.tracks=e.subtitleTracks,this.tracks.forEach((function(e){t.tracksBuffered[e.id]=[]}))},n.onSubtitleTrackSwitch=function(e){if(this.currentTrackId=e.id,this.tracks&&this.tracks.length&&-1!==this.currentTrackId){var t=this.tracks[this.currentTrackId];t&&t.details&&this.setInterval(500)}else this.clearInterval()},n.onSubtitleTrackLoaded=function(e){var t=e.id,i=e.details,r=this.currentTrackId,n=this.tracks,a=n[r];t>=n.length||t!==r||!a||(i.live&&function(e,t,i){void 0===i&&(i=0);var r=-1;ie(e,t,(function(e,t,i){t.start=e.start,r=i}));var n=t.fragments;if(r<0)n.forEach((function(e){e.start+=i}));else for(var a=r+1;a<n.length;a++)n[a].start=n[a-1].start+n[a-1].duration}(a.details,i,this.lastAVStart),a.details=i,this.setInterval(500))},n.onKeyLoaded=function(){this.state===ye&&(this.state=ge)},n.onFragLoaded=function(e){var t=this.fragCurrent,i=e.frag.decryptdata,r=e.frag,n=this.hls;if(this.state===be&&t&&"subtitle"===e.frag.type&&t.sn===e.frag.sn&&e.payload.byteLength>0&&i&&i.key&&"AES-128"===i.method){var a=qt.now();this.decrypter.decrypt(e.payload,i.key.buffer,i.iv.buffer,(function(e){var t=qt.now();n.trigger(d.a.FRAG_DECRYPTED,{frag:r,payload:e,stats:{tstart:a,tdecrypt:t}})}))}},n.onLevelUpdated=function(e){var t=e.details.fragments;this.lastAVStart=t.length?t[0].start:0},n.doTick=function(){if(this.media)switch(this.state){case ge:var e=this.config,t=this.currentTrackId,i=this.fragmentTracker,r=this.media,n=this.tracks;if(!n||!n[t]||!n[t].details)break;var a,s=e.maxBufferHole,o=e.maxFragLookUpTolerance,l=Math.min(e.maxBufferLength,e.maxMaxBufferLength),c=H.bufferedInfo(this._getBuffered(),r.currentTime,s),h=c.end,f=c.len,p=n[t].details,m=p.fragments,g=m.length,v=m[g-1].start+m[g-1].duration;if(f>l)return;var y=this.fragPrevious;h<v?(y&&p.hasProgramDateTime&&(a=oe(m,y.endProgramDateTime,o)),a||(a=le(y,m,h,o))):a=m[g-1],a&&a.encrypted?(u.b.log("Loading key for "+a.sn),this.state=ye,this.hls.trigger(d.a.KEY_LOADING,{frag:a})):a&&i.getState(a)===F&&(this.fragCurrent=a,this.state=be,this.hls.trigger(d.a.FRAG_LOADING,{frag:a}))}else this.state=ge},n.stopLoad=function(){this.lastAVStart=0,e.prototype.stopLoad.call(this)},n._getBuffered=function(){return this.tracksBuffered[this.currentTrackId]||[]},n.onMediaSeeking=function(){this.fragPrevious=null},r}(Le);!function(e){e.WIDEVINE="com.widevine.alpha",e.PLAYREADY="com.microsoft.playready"}($t||($t={}));var Wt="undefined"!=typeof window&&window.navigator&&window.navigator.requestMediaKeySystemAccess?window.navigator.requestMediaKeySystemAccess.bind(window.navigator):null;function Vt(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Yt=function(e){var t,i;function r(t){var i;return(i=e.call(this,t,d.a.MEDIA_ATTACHED,d.a.MEDIA_DETACHED,d.a.MANIFEST_PARSED)||this)._widevineLicenseUrl=void 0,i._licenseXhrSetup=void 0,i._emeEnabled=void 0,i._requestMediaKeySystemAccess=void 0,i._config=void 0,i._mediaKeysList=[],i._media=null,i._hasSetMediaKeys=!1,i._requestLicenseFailureCount=0,i._onMediaEncrypted=function(e){u.b.log('Media is encrypted using "'+e.initDataType+'" init data type'),i._attemptSetMediaKeys(),i._generateRequestWithPreferredKeySession(e.initDataType,e.initData)},i._config=t.config,i._widevineLicenseUrl=i._config.widevineLicenseUrl,i._licenseXhrSetup=i._config.licenseXhrSetup,i._emeEnabled=i._config.emeEnabled,i._requestMediaKeySystemAccess=i._config.requestMediaKeySystemAccessFunc,i}i=e,(t=r).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var n,a,s=r.prototype;return s.getLicenseServerUrl=function(e){switch(e){case $t.WIDEVINE:if(!this._widevineLicenseUrl)break;return this._widevineLicenseUrl}throw new Error('no license server URL configured for key-system "'+e+'"')},s._attemptKeySystemAccess=function(e,t,i){var r=this,n=function(e,t,i){switch(e){case $t.WIDEVINE:return function(e,t){var i={videoCapabilities:[]};return t.forEach((function(e){i.videoCapabilities.push({contentType:'video/mp4; codecs="'+e+'"'})})),[i]}(0,i);default:throw new Error("Unknown key-system: "+e)}}(e,0,i);u.b.log("Requesting encrypted media key-system access"),this.requestMediaKeySystemAccess(e,n).then((function(t){r._onMediaKeySystemAccessObtained(e,t)})).catch((function(t){u.b.error('Failed to obtain key-system "'+e+'" access:',t)}))},s._onMediaKeySystemAccessObtained=function(e,t){var i=this;u.b.log('Access for key-system "'+e+'" obtained');var r={mediaKeysSessionInitialized:!1,mediaKeySystemAccess:t,mediaKeySystemDomain:e};this._mediaKeysList.push(r),t.createMediaKeys().then((function(t){r.mediaKeys=t,u.b.log('Media-keys created for key-system "'+e+'"'),i._onMediaKeysCreated()})).catch((function(e){u.b.error("Failed to create media-keys:",e)}))},s._onMediaKeysCreated=function(){var e=this;this._mediaKeysList.forEach((function(t){t.mediaKeysSession||(t.mediaKeysSession=t.mediaKeys.createSession(),e._onNewMediaKeySession(t.mediaKeysSession))}))},s._onNewMediaKeySession=function(e){var t=this;u.b.log("New key-system session "+e.sessionId),e.addEventListener("message",(function(i){t._onKeySessionMessage(e,i.message)}),!1)},s._onKeySessionMessage=function(e,t){u.b.log("Got EME message event, creating license request"),this._requestLicense(t,(function(t){u.b.log("Received license data (length: "+(t?t.byteLength:t)+"), updating key-session"),e.update(t)}))},s._attemptSetMediaKeys=function(){if(!this._media)throw new Error("Attempted to set mediaKeys without first attaching a media element");if(!this._hasSetMediaKeys){var e=this._mediaKeysList[0];if(!e||!e.mediaKeys)return u.b.error("Fatal: Media is encrypted but no CDM access or no keys have been obtained yet"),void this.hls.trigger(d.a.ERROR,{type:o.b.KEY_SYSTEM_ERROR,details:o.a.KEY_SYSTEM_NO_KEYS,fatal:!0});u.b.log("Setting keys for encrypted media"),this._media.setMediaKeys(e.mediaKeys),this._hasSetMediaKeys=!0}},s._generateRequestWithPreferredKeySession=function(e,t){var i=this,r=this._mediaKeysList[0];if(!r)return u.b.error("Fatal: Media is encrypted but not any key-system access has been obtained yet"),void this.hls.trigger(d.a.ERROR,{type:o.b.KEY_SYSTEM_ERROR,details:o.a.KEY_SYSTEM_NO_ACCESS,fatal:!0});if(r.mediaKeysSessionInitialized)u.b.warn("Key-Session already initialized but requested again");else{var n=r.mediaKeysSession;if(!n)return u.b.error("Fatal: Media is encrypted but no key-session existing"),void this.hls.trigger(d.a.ERROR,{type:o.b.KEY_SYSTEM_ERROR,details:o.a.KEY_SYSTEM_NO_SESSION,fatal:!0});if(!t)return u.b.warn("Fatal: initData required for generating a key session is null"),void this.hls.trigger(d.a.ERROR,{type:o.b.KEY_SYSTEM_ERROR,details:o.a.KEY_SYSTEM_NO_INIT_DATA,fatal:!0});u.b.log('Generating key-session request for "'+e+'" init data type'),r.mediaKeysSessionInitialized=!0,n.generateRequest(e,t).then((function(){u.b.debug("Key-session generation succeeded")})).catch((function(e){u.b.error("Error generating key-session request:",e),i.hls.trigger(d.a.ERROR,{type:o.b.KEY_SYSTEM_ERROR,details:o.a.KEY_SYSTEM_NO_SESSION,fatal:!1})}))}},s._createLicenseXhr=function(e,t,i){var r=new XMLHttpRequest,n=this._licenseXhrSetup;try{if(n)try{n(r,e)}catch(t){r.open("POST",e,!0),n(r,e)}r.readyState||r.open("POST",e,!0)}catch(e){throw new Error("issue setting up KeySystem license XHR "+e)}return r.responseType="arraybuffer",r.onreadystatechange=this._onLicenseRequestReadyStageChange.bind(this,r,e,t,i),r},s._onLicenseRequestReadyStageChange=function(e,t,i,r){switch(e.readyState){case 4:if(200===e.status)this._requestLicenseFailureCount=0,u.b.log("License request succeeded"),"arraybuffer"!==e.responseType&&u.b.warn("xhr response type was not set to the expected arraybuffer for license request"),r(e.response);else{if(u.b.error("License Request XHR failed ("+t+"). Status: "+e.status+" ("+e.statusText+")"),this._requestLicenseFailureCount++,this._requestLicenseFailureCount>3)return void this.hls.trigger(d.a.ERROR,{type:o.b.KEY_SYSTEM_ERROR,details:o.a.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0});var n=3-this._requestLicenseFailureCount+1;u.b.warn("Retrying license request, "+n+" attempts left"),this._requestLicense(i,r)}}},s._generateLicenseRequestChallenge=function(e,t){switch(e.mediaKeySystemDomain){case $t.WIDEVINE:return t}throw new Error("unsupported key-system: "+e.mediaKeySystemDomain)},s._requestLicense=function(e,t){u.b.log("Requesting content license for key-system");var i=this._mediaKeysList[0];if(!i)return u.b.error("Fatal error: Media is encrypted but no key-system access has been obtained yet"),void this.hls.trigger(d.a.ERROR,{type:o.b.KEY_SYSTEM_ERROR,details:o.a.KEY_SYSTEM_NO_ACCESS,fatal:!0});try{var r=this.getLicenseServerUrl(i.mediaKeySystemDomain),n=this._createLicenseXhr(r,e,t);u.b.log("Sending license request to URL: "+r);var a=this._generateLicenseRequestChallenge(i,e);n.send(a)}catch(e){u.b.error("Failure requesting DRM license: "+e),this.hls.trigger(d.a.ERROR,{type:o.b.KEY_SYSTEM_ERROR,details:o.a.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0})}},s.onMediaAttached=function(e){if(this._emeEnabled){var t=e.media;this._media=t,t.addEventListener("encrypted",this._onMediaEncrypted)}},s.onMediaDetached=function(){this._media&&(this._media.removeEventListener("encrypted",this._onMediaEncrypted),this._media=null)},s.onManifestParsed=function(e){if(this._emeEnabled){var t=e.levels.map((function(e){return e.audioCodec})),i=e.levels.map((function(e){return e.videoCodec}));this._attemptKeySystemAccess($t.WIDEVINE,t,i)}},n=r,(a=[{key:"requestMediaKeySystemAccess",get:function(){if(!this._requestMediaKeySystemAccess)throw new Error("No requestMediaKeySystemAccess function configured");return this._requestMediaKeySystemAccess}}])&&Vt(n.prototype,a),r}(h);function zt(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var Xt=function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{},r=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(i).filter((function(e){return Object.getOwnPropertyDescriptor(i,e).enumerable})))),r.forEach((function(t){zt(e,t,i[t])}))}return e}({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,initialLiveManifestSize:1,maxBufferLength:30,maxBufferSize:6e7,maxBufferHole:.5,lowBufferWatchdogPeriod:.5,highBufferWatchdogPeriod:3,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,liveDurationInfinity:!1,liveBackBufferLength:1/0,maxMaxBufferLength:600,enableWorker:!0,enableSoftwareAES:!0,manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,startLevel:void 0,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:Ze,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,abrController:Ge,bufferController:Ke,capLevelController:Ve,fpsController:ze,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,requestMediaKeySystemAccessFunc:Wt},{cueHandler:r,enableCEA708Captions:!0,enableWebVTT:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es"},{subtitleStreamController:Kt,subtitleTrackController:Ht,timelineController:Ut,audioStreamController:nt,audioTrackController:tt,emeController:Yt});function Qt(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function Jt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Zt(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ei(e,t,i){return t&&Zt(e.prototype,t),i&&Zt(e,i),e}i.d(t,"default",(function(){return ti}));var ti=function(e){var t,i;function r(t){var i;void 0===t&&(t={}),(i=e.call(this)||this).config=void 0,i._autoLevelCapping=void 0,i.abrController=void 0,i.capLevelController=void 0,i.levelController=void 0,i.streamController=void 0,i.networkControllers=void 0,i.audioTrackController=void 0,i.subtitleTrackController=void 0,i.emeController=void 0,i.coreComponents=void 0,i.media=null,i.url=null;var n=r.DefaultConfig;if((t.liveSyncDurationCount||t.liveMaxLatencyDurationCount)&&(t.liveSyncDuration||t.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");i.config=function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{},r=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(i).filter((function(e){return Object.getOwnPropertyDescriptor(i,e).enumerable})))),r.forEach((function(t){Qt(e,t,i[t])}))}return e}({},n,t);var a=Jt(i).config;if(void 0!==a.liveMaxLatencyDurationCount&&a.liveMaxLatencyDurationCount<=a.liveSyncDurationCount)throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be gt "liveSyncDurationCount"');if(void 0!==a.liveMaxLatencyDuration&&(void 0===a.liveSyncDuration||a.liveMaxLatencyDuration<=a.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be gt "liveSyncDuration"');Object(u.a)(a.debug),i._autoLevelCapping=-1;var s=i.abrController=new a.abrController(Jt(i)),o=new a.bufferController(Jt(i)),l=i.capLevelController=new a.capLevelController(Jt(i)),d=new a.fpsController(Jt(i)),c=new I(Jt(i)),h=new M(Jt(i)),f=new N(Jt(i)),p=new Ue(Jt(i)),m=i.levelController=new Ie(Jt(i)),g=new j(Jt(i)),v=[m,i.streamController=new xe(Jt(i),g)],y=a.audioStreamController;y&&v.push(new y(Jt(i),g)),i.networkControllers=v;var b=[c,h,f,s,o,l,d,p,g];if(y=a.audioTrackController){var w=new y(Jt(i));i.audioTrackController=w,b.push(w)}if(y=a.subtitleTrackController){var _=new y(Jt(i));i.subtitleTrackController=_,v.push(_)}if(y=a.emeController){var T=new y(Jt(i));i.emeController=T,b.push(T)}return(y=a.subtitleStreamController)&&v.push(new y(Jt(i),g)),(y=a.timelineController)&&b.push(new y(Jt(i))),i.coreComponents=b,i}i=e,(t=r).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i,r.isSupported=function(){return function(){var e=W();if(!e)return!1;var t=self.SourceBuffer||self.WebKitSourceBuffer,i=e&&"function"==typeof e.isTypeSupported&&e.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),r=!t||t.prototype&&"function"==typeof t.prototype.appendBuffer&&"function"==typeof t.prototype.remove;return!!i&&!!r}()},ei(r,null,[{key:"version",get:function(){return"0.13.2"}},{key:"Events",get:function(){return d.a}},{key:"ErrorTypes",get:function(){return o.b}},{key:"ErrorDetails",get:function(){return o.a}},{key:"DefaultConfig",get:function(){return r.defaultConfig?r.defaultConfig:Xt},set:function(e){r.defaultConfig=e}}]);var n=r.prototype;return n.destroy=function(){u.b.log("destroy"),this.trigger(d.a.DESTROYING),this.detachMedia(),this.coreComponents.concat(this.networkControllers).forEach((function(e){e.destroy()})),this.url=null,this.removeAllListeners(),this._autoLevelCapping=-1},n.attachMedia=function(e){u.b.log("attachMedia"),this.media=e,this.trigger(d.a.MEDIA_ATTACHING,{media:e})},n.detachMedia=function(){u.b.log("detachMedia"),this.trigger(d.a.MEDIA_DETACHING),this.media=null},n.loadSource=function(e){e=s.buildAbsoluteURL(window.location.href,e,{alwaysNormalize:!0}),u.b.log("loadSource:"+e),this.url=e,this.trigger(d.a.MANIFEST_LOADING,{url:e})},n.startLoad=function(e){void 0===e&&(e=-1),u.b.log("startLoad("+e+")"),this.networkControllers.forEach((function(t){t.startLoad(e)}))},n.stopLoad=function(){u.b.log("stopLoad"),this.networkControllers.forEach((function(e){e.stopLoad()}))},n.swapAudioCodec=function(){u.b.log("swapAudioCodec"),this.streamController.swapAudioCodec()},n.recoverMediaError=function(){u.b.log("recoverMediaError");var e=this.media;this.detachMedia(),e&&this.attachMedia(e)},ei(r,[{key:"levels",get:function(){return this.levelController.levels}},{key:"currentLevel",get:function(){return this.streamController.currentLevel},set:function(e){u.b.log("set currentLevel:"+e),this.loadLevel=e,this.streamController.immediateLevelSwitch()}},{key:"nextLevel",get:function(){return this.streamController.nextLevel},set:function(e){u.b.log("set nextLevel:"+e),this.levelController.manualLevel=e,this.streamController.nextLevelSwitch()}},{key:"loadLevel",get:function(){return this.levelController.level},set:function(e){u.b.log("set loadLevel:"+e),this.levelController.manualLevel=e}},{key:"nextLoadLevel",get:function(){return this.levelController.nextLoadLevel},set:function(e){this.levelController.nextLoadLevel=e}},{key:"firstLevel",get:function(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)},set:function(e){u.b.log("set firstLevel:"+e),this.levelController.firstLevel=e}},{key:"startLevel",get:function(){return this.levelController.startLevel},set:function(e){u.b.log("set startLevel:"+e),-1!==e&&(e=Math.max(e,this.minAutoLevel)),this.levelController.startLevel=e}},{key:"capLevelToPlayerSize",set:function(e){var t=!!e;t!==this.config.capLevelToPlayerSize&&(t?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=t)}},{key:"autoLevelCapping",get:function(){return this._autoLevelCapping},set:function(e){u.b.log("set autoLevelCapping:"+e),this._autoLevelCapping=e}},{key:"bandwidthEstimate",get:function(){var e=this.abrController._bwEstimator;return e?e.getEstimate():NaN}},{key:"autoLevelEnabled",get:function(){return-1===this.levelController.manualLevel}},{key:"manualLevel",get:function(){return this.levelController.manualLevel}},{key:"minAutoLevel",get:function(){for(var e=this.levels,t=this.config.minAutoBitrate,i=e?e.length:0,r=0;r<i;r++)if((e[r].realBitrate?Math.max(e[r].realBitrate,e[r].bitrate):e[r].bitrate)>t)return r;return 0}},{key:"maxAutoLevel",get:function(){var e=this.levels,t=this.autoLevelCapping;return-1===t&&e&&e.length?e.length-1:t}},{key:"nextAutoLevel",get:function(){return Math.min(Math.max(this.abrController.nextAutoLevel,this.minAutoLevel),this.maxAutoLevel)},set:function(e){this.abrController.nextAutoLevel=Math.max(this.minAutoLevel,e)}},{key:"audioTracks",get:function(){var e=this.audioTrackController;return e?e.audioTracks:[]}},{key:"audioTrack",get:function(){var e=this.audioTrackController;return e?e.audioTrack:-1},set:function(e){var t=this.audioTrackController;t&&(t.audioTrack=e)}},{key:"liveSyncPosition",get:function(){return this.streamController.liveSyncPosition}},{key:"subtitleTracks",get:function(){var e=this.subtitleTrackController;return e?e.subtitleTracks:[]}},{key:"subtitleTrack",get:function(){var e=this.subtitleTrackController;return e?e.subtitleTrack:-1},set:function(e){var t=this.subtitleTrackController;t&&(t.subtitleTrack=e)}},{key:"subtitleDisplay",get:function(){var e=this.subtitleTrackController;return!!e&&e.subtitleDisplay},set:function(e){var t=this.subtitleTrackController;t&&(t.subtitleDisplay=e)}}]),r}(Y);ti.defaultConfig=void 0}]).default})),window.Playlist={},window.players=[],function(e){"use strict";Playlist=function(t,i,r){var n=this;this.player=null,this.active=0,this.repeat=!1,this.shuffle=!1,this.adsing=!1,this.items=i||[],this.oitems=e.merge([],i),this.timeout=null,this.adsInter=1,this.timer=0,this.live=!1,this.livePaused=!0,this.liveServer="",this.async=!0,this.type="audio",this.provider="html5",this.resource=!0,this.autoplay=!1,this.preview=!1,this.init=!1,this.options=e.extend(!0,{},this._options,r),this.el=e.extend({},this._el(),t),e.get(this.options.iconUrl,(function(e){var t=document.createElement("div");t.setAttribute("hidden",""),t.setAttribute("id","plyr-sprite"),t.innerHTML=(new XMLSerializer).serializeToString(e.documentElement),document.body.insertBefore(t,document.body.childNodes[0])})),e.each(this.el,(function(e,t){"playlist"!==e&&"controls"!==e&&(n.el[e]=n.el.playlist+" "+n.el[e])})),this.player=new Plyr(this.el.player,this.options),players.push(this.player),this.log("Init"),this._init()},Playlist.prototype={_options:{theme:0,bufferingClass:"is-buffering",initingClass:"plyr-initing",liveClass:"plyr--live",adsClass:"plyr--adsing",adsInterval:3,timeoutCount:1e4,debug:!1,iconUrl:"",autoplay:!1,hideControls:!0,history:!0,fullscreen:{enabled:!0},controls:["play","progress","current-time","duration","mute","volume","captions","settings","pip","airplay","fullscreen"],i18n:{queue:"Queue",clear:"Clear",nextup:"Next up",empty:"Your queue is empty",live:"Live",preview:"Preview"}},_el:function(){return{playlist:"#playlist",player:"audio",plyr:".plyr",control:".plyr__controls",wrap:".plyr-list-wrap",items:".plyr-list",item:".plyr-item",clear:".plyr-clear",poster:".plyr__controls .plyr__poster",title:".plyr__title",author:".plyr__author",info:".plyr__info",progress:".plyr__progress__container",time:".plyr__time",current:".plyr__time--current",duration:".plyr__time--duration",queue:".plyr__queue",volume:".plyr__volume",prev:'[data-plyr="prev"]',play:'[data-plyr="play"]',playLarge:'[data-plyr="play"]',next:'[data-plyr="next"]',shuffle:'[data-plyr="shuffle"]',repeat:'[data-plyr="repeat"]',like:'[data-plyr="like"]',download:'[data-plyr="download"]',purchase:'[data-plyr="purchase"]',captions:'[data-plyr="captions"]',pip:'[data-plyr="pip"]',airplay:'[data-plyr="airplay"]',video:'[data-plyr="video"]',fullscreen:'[data-plyr="fullscreen"]',menu:".plyr__menu",close:'[data-plyr="close"]',list:'[data-plyr="list"]',msg:".plyr__msg",waveform:".plyr__waveform",controls:{wrap:'<div class="plyr-list-wrap"><div class="plyr-list"><div class="plyr-list-header"><h4>'+this.options.i18n.nextup+'</h4><button class="plyr-clear">'+this.options.i18n.clear+'</button></div><div class="plyr-list-content"></div></div></div>',prev:'<button type="button" class="plyr__control" data-plyr="prev"><svg role="presentation"><use xlink:href="#plyr-prev"></use></svg></button>',next:'<button type="button" class="plyr__control" data-plyr="next"><svg role="presentation"><use xlink:href="#plyr-next"></use></svg></button>',shuffle:'<button type="button" class="plyr__control" data-plyr="shuffle"><svg role="presentation"><use xlink:href="#plyr-shuffle"></use></svg></button>',repeat:'<button type="button" class="plyr__control" data-plyr="repeat"><svg role="presentation"><use xlink:href="#plyr-repeat"></use></svg></button>',poster:'<div class="plyr__poster"></div>',info:'<div class="plyr__info"><a class="plyr__title ajax" href="#"></a><span class="plyr-preview">'+this.options.i18n.preview+'</span><div class="plyr__author"></div></div>',like:'<button type="button" class="plyr__control btn-like" data-action="like" data-type="post" data-plyr="like"><svg role="presentation"><use xlink:href="#plyr-like"></use></svg></button>',download:'<a target="_blank" class="plyr__control no-ajax" data-plyr="download"><svg role="presentation"><use xlink:href="#plyr-download"></use></svg></a>',purchase:'<a target="_blank" class="plyr__control" data-plyr="purchase"></a>',list:'<button type="button" class="plyr__control" data-plyr="list"><svg role="presentation"><use xlink:href="#plyr-list"></use></svg></button>',video:'<button type="button" class="plyr__control" data-plyr="video"><svg role="presentation"><use xlink:href="#plyr-video"></use></svg></button>',msg:'<div class="plyr__msg"><div class="plyr__msg_content"><div class="plyr__msg_desc"></div><button class="close">&times;</button></div></div>',mini:'<button type="button" class="plyr__control" data-plyr="mini"><svg role="presentation"><use xlink:href="#plyr-mini"></use></svg></button>',max:'<button type="button" class="plyr__control" data-plyr="max"><svg role="presentation"><use xlink:href="#plyr-max"></use></svg></button>',queue:'<div class="plyr__queue" data-plyr="list"><span></span><svg role="presentation"><use xlink:href="#plyr-expander"></use></svg></span>',item:'<div class="plyr-item"><div class="plyr-item-poster"><button class="btn-play"></button></div><div class="plyr-item-content"><a class="plyr-item-title"></a><div class="plyr-item-author"></div></div><button class="plyr-item-close close">&times;</button><button data-action="like" data-type="post" class="btn-like"><svg role="presentation"><use xlink:href="#plyr-like"></use></svg></button></div>',close:'<button class="plyr__control" data-plyr="close"><svg role="presentation"><use xlink:href="#plyr-close"></use></svg></button>',waveform:'<div class="plyr__waveform waveform"><div class="waveform-container"></div></div>'}}},_init:function(){var e=this;e._createItems(),e._initPlayerEvent(),e._initNavigatorPlayer()},_initPlayerEvent:function(){var t=this;this.log("Init plyr event"),this.player.on("ready",(function(i){if(e(t.el.plyr).removeClass(t.options.initingClass),t._createControls(),t._initEvents(),t._initState(),t.autoplay){t.isIOS()&&"youtube"==t.provider&&(t.player.currentTime=0),t.log("Play");var r=t.player.play();void 0!==r&&r.catch((function(e){t.log(e)})).then((function(){}))}else t._initHistory()})),this.player.on("play",(function(e){t._activeItem(),players.forEach((function(e){e!==t.player&&e.pause()})),t.live&&t.livePaused&&(t.log("Live restart"),t._play(t.active),t.livePaused=!1),t.isPlayable()||t.player.stop()})),this.player.on("pause",(function(i){t._activeItem(),e("html").removeClass(t.options.bufferingClass),t.live&&(t.livePaused=!0)})),this.player.on("enterfullscreen",(function(i){e(t.el.plyr).addClass("plyr-fullscreen")})),this.player.on("exitfullscreen",(function(i){e(t.el.plyr).removeClass("plyr-fullscreen")})),this.player.on("loadstart",(function(i){e("html").addClass(t.options.bufferingClass)})),this.player.on("waiting",(function(i){e("html").addClass(t.options.bufferingClass)})),this.player.on("seeking",(function(i){e("html").addClass(t.options.bufferingClass)})),this.player.on("canplay",(function(i){e("html").removeClass(t.options.bufferingClass)})),this.player.on("playing",(function(i){e("html").removeClass(t.options.bufferingClass)})),this.player.on("seeked",(function(i){e("html").removeClass(t.options.bufferingClass)})),this.player.on("pause",(function(i){e("html").removeClass(t.options.bufferingClass)})),this.player.on("stop",(function(i){e("html").removeClass(t.options.bufferingClass)})),this.player.on("error",(function(e){t.showMsg(t.options.i18n.error)})),this.player.on("adsimpression",(function(i){e("html").removeClass(t.options.bufferingClass),t.adsing=!0,t.player.pause(),e(t.el.plyr).addClass(t.options.adsClass)})),this.player.on("adscomplete",(function(i){t.adsing=!1,e(t.el.plyr).removeClass(t.options.adsClass)})),this.player.on("timeupdate",(function(i){if(t.timer++,t.timer==t.options.timeoutCount/1e3*4){var r=t.getCurrent();e(document).trigger("played",{id:r.id})}5==t.timer&&(0==t.player.duration||t.player.duration>=2**32)&&(t.live=!0,e(t.el.plyr).addClass(t.options.liveClass),e(t.el.duration).html('<span class="plyr-live">'+t.options.i18n.live+"</span>"))})),this.player.on("ended",(function(){if(t.player.stop(),t.preview)e(document).trigger("player_preview_end");else if(t.repeat)t._play(t.active);else if(t.items.length>1&&(t.active<t.items.length-1||t.shuffle))t.next();else{var i=e.map(t.items,(function(e){return e.id}));e(document).trigger("complete.play",{ids:i,shuffle:t.shuffle})}})),e(document).on("pjax:success",(function(e){t._activeItem()}))},_initNavigatorPlayer:function(){var e=this;navigator.mediaSession&&(this.log("Init navigator event"),navigator.mediaSession.setActionHandler("play",(function(){e.player.play()})),navigator.mediaSession.setActionHandler("pause",(function(){e.player.pause()})),navigator.mediaSession.setActionHandler("previoustrack",(function(){e.prev()})),navigator.mediaSession.setActionHandler("nexttrack",(function(){e.next()})),e.isIOS()||(navigator.mediaSession.setActionHandler("seekbackward",(function(t){e.player.rewind()})),navigator.mediaSession.setActionHandler("seekforward",(function(t){e.player.forward()}))))},isIOS:function(){return/iPhone|iPod|iPad/.test(navigator.platform)},_initState:function(){this.shuffle?e(this.el.shuffle).addClass("is--shuffle"):e(this.el.shuffle).removeClass("is--shuffle"),this.repeat?e(this.el.repeat).addClass("is--repeat"):e(this.el.repeat).removeClass("is--repeat")},_initEvents:function(){var t=this;e(this.el.prev).off().on("click",(function(){t.prev()})),e(this.el.next).off().on("click",(function(){t.next()})),e(this.el.shuffle).off().on("click",(function(){t.shuffle=!t.shuffle,t._initState()})),e(this.el.repeat).off().on("click",(function(){t.repeat=!t.repeat,t._initState()})),e(this.el.list).off().on("click",(function(){e(t.el.playlist).toggleClass("open")})),e(this.el.video).off().on("click",(function(){e(t.el.plyr).toggleClass("plyr__toggle-video")})),e(this.el.clear).off().on("click",(function(){t.setItems([])})),e(this.el.close).off().on("click",(function(){t.pause(),t.setItems([]),e(t.el.playlist).addClass("close-player")}))},_initHistory:function(){!this.init&&this.items.length>0&&(this.log("Start history"),this.init=!0,this.setSource())},_createControls:function(){if(this.resource){switch(this.log("Create controls"),e(this.el.controls.prev).insertBefore(e(this.el.play)),e(this.el.controls.next).insertAfter(e(this.el.play)),e(this.el.controls.repeat).insertAfter(e(this.el.next)),e(this.el.controls.shuffle).insertAfter(e(this.el.repeat)),e(this.el.controls.poster).insertAfter(e(this.el.shuffle)),e(this.el.controls.info).insertAfter(this.el.poster),e(this.el.controls.like).insertAfter(e(this.el.volume)),e(this.el.controls.purchase).insertAfter(e(this.el.volume)),e(this.el.controls.download).insertAfter(e(this.el.volume)),e(this.el.controls.video).insertAfter(e(this.el.menu)),e(this.el.control).append(e(this.el.controls.list)),this.options.theme){case"1":var t=e('<div class="plyr__row"></div>').append(e(this.el.info)).append(e(this.el.time));e('<div class="plyr__col"></div>').append(t).append(e(this.el.progress)).insertAfter(e(this.el.poster));break;case"2":e(this.el.control).append(e('<div class="plyr-control-left"></div>').append(e(this.el.poster),e(this.el.info))),e(this.el.control).append(e('<div class="plyr-control-center"></div>').append(e(this.el.shuffle),e(this.el.prev),e(this.el.play),e(this.el.next),e(this.el.repeat))),e(this.el.control).append(e('<div class="plyr-control-right"></div>').append(e(this.el.current),e(this.el.duration),e(this.el.progress),e(this.el.volume),e(this.el.like),e(this.el.download),e(this.el.purchase),e(this.el.captions),e(this.el.pip),e(this.el.video),e(this.el.fullscreen),e(this.el.airplay),e(this.el.menu),e(this.el.list)));break;case"3":e(this.el.control).append(e('<div class="plyr-control-left"></div>').append(e(this.el.poster),e(this.el.info),e(this.el.like),e(this.el.download),e(this.el.purchase))),e(this.el.control).append(e('<div class="plyr-control-center"></div>').append(e('<div class="plyr-control-center-top"></div>').append(e(this.el.shuffle),e(this.el.prev),e(this.el.play),e(this.el.next),e(this.el.repeat)),e('<div class="plyr-control-center-bottom"></div>').append(e(this.el.current),e(this.el.progress),e(this.el.duration)))),e(this.el.control).append(e('<div class="plyr-control-right"></div>').append(e(this.el.volume),e(this.el.captions),e(this.el.pip),e(this.el.video),e(this.el.fullscreen),e(this.el.airplay),e(this.el.menu),e(this.el.list)));break;case"video":e('<div class="plyr-duration-wrap"></div>').append(e(this.el.time)).insertAfter(this.el.shuffle),e(this.el.control).append(this.el.controls.close),0==e(this.el.wrap).find(".plyr__info").length&&e(this.el.info).append(this.el.controls.queue).insertBefore(this.el.items);break;default:e(this.el.current).insertBefore(e(this.el.progress)),e(this.el.poster).insertBefore(e(this.el.list)),e(this.el.info).insertAfter(e(this.el.poster))}this.select()}},_createItems:function(){this.log("Create queque");var t=this;e(t.el.playlist).addClass("plyr-theme-"+t.options.theme).append(e(t.el.controls.wrap)),0!=t.oitems.length&&e.each(t.oitems,(function(e,i){t._buildItem(i,e-1)}))},_buildItem:function(t,i){var r=this,n=e(this.el.controls.item),a=e(".plyr-list-content",this.el.items);return n.attr("data-play-id",t.id),n.find(".plyr-item-poster").css("background-image","url("+t.artwork_url+")"),n.find(".btn-play").attr("data-play-id",t.id),n.find(".btn-like").attr("data-id",t.id).addClass(t.like?"active":""),n.find(".plyr-item-title").text(t.title).attr("href",t.uri),n.find(".plyr-item-author").html(this.buildAuthor(t)),t.el=n,e(".plyr-list-empty",this.el.items).remove(),0==a.children().length?t.el.prependTo(a):t.el.insertAfter(a.children().eq(i)),n.on("click",".plyr-item-close",(function(t){t.preventDefault();var i=e(this).closest("[data-play-id]").attr("data-play-id");r._removeItem({id:i})})),e(document).trigger("refresh"),t},_addItem:function(e,t){t<0&&(t=0),e=this._buildItem(e,t),this.items.splice(t+1,0,e)},_removeItem:function(e){var t=this;if(null!=e.id){var i=this.getIndex(e.id);i>-1&&(this.items[i].el.remove(),this.items.splice(i,1),this.active==i&&this.setIndex(t.active,(function(){t._play(t.active)})))}},_activeItem:function(){var t=this.getCurrent();if(t){this.log("Active item"),e("[data-play-id]").removeClass("active");var i='[data-play-id="'+t.id+'"]';e(i).addClass("active"),t.from&&e('[data-play-id="'+t.from.id+'"]').addClass("active"),this.player.paused&&(e(i).removeClass("active"),t.from&&e('[data-play-id="'+t.from.id+'"]').removeClass("active"))}},_history:function(){if(this.options.history){this.log("Store history");var e=this._store("plyr");e.active=this.active,e.items=this.items,this._store("plyr",e)}},_store:function(e,t){try{if(arguments.length>1)return localStorage.setItem(e,JSON.stringify(t));var i=localStorage.getItem(e);return i&&JSON.parse(i)||{}}catch(e){}},_play:function(e){var t=this;t.timer=0,t.items[e]&&(t.autoplay=!0,t.active=e,t._activeItem(),t.select(),t.setSource(),t.updateLive(),t.playAds())},setSource:function(){if(this.player.stop(),this.isPlayable()){var t=this,i=this.getCurrent(),r=i.stream_url,n={type:i.type||"audio",sources:[{src:r,size:"576"}]};i.sources&&(n.sources=n.sources.concat(i.sources));var a=i.provider;if(""!==a&&(n.sources[0].provider=a),r.indexOf("preview")>-1?this.preview=!0:this.preview=!1,t.hideMsg(),this.log("Set source: "+r+" : "+a),t.live=!1,e(t.el.plyr).removeClass(t.options.liveClass),(r.toLowerCase().indexOf("icecast")>-1||r.toLowerCase().indexOf("shoutcast")>-1||r.toLowerCase().indexOf("azuracast")>-1||r.toLowerCase().indexOf("livestream")>-1)&&(t.live=!0),i.tracks&&(n.tracks=i.tracks),"audio"===n.type&&this.player.fullscreen.active&&this.player.fullscreen.exit(),t.async&&n.type==this.type&&a==this.provider&&"vimeo"!==a){if(this.resource=!1,"html5"==a)e(this.el.playlist).find("video, audio")[0].src=r;else{var s=i.provider_id||r;switch(a){case"youtube":this.player.embed.loadVideoById(s);break;case"vimeo":this.player.embed.loadVideo(s);break;default:this.player.embed.load(s,{auto_play:!0})}}setTimeout((function(){t.log("Ansyc load"),t.player.media.dispatchEvent(new CustomEvent("ready"))}),200)}else this.resource=!0,this.player.source=n,t.log("Sync load"),e(this.el.plyr).addClass(this.options.initingClass);if(r.indexOf(".m3u8")>-1&&Hls.isSupported()){var o=new Hls;o.loadSource(r),o.attachMedia(e(this.el.playlist).find("video, audio")[0])}this.type=n.type,this.provider=a}},getItems:function(){return this.items},getItem:function(e){for(var t=0;t<this.items.length;t++)if(parseInt(this.items[t].id)===parseInt(e))return this.items[t];return!1},setItems:function(t){var i=this;this.items=t,e(".plyr-list-content",this.el.items).html('<div class="plyr-list-empty">'+this.options.i18n.empty+"</div>"),e.each(i.items,(function(e,t){i._buildItem(t,e-1)})),this._history()},select:function(t){this.log("Select item");var i=this;if(t>-1&&(this.active=t),clearTimeout(this.timeout),this.timeout=null,0!=this.items.length){var r=this.getCurrent();if(this.updateTitle(r.title,r.artwork_url),e(this.el.title).attr("href",r.uri),e(this.el.author).html(this.buildAuthor(r)),i.preview?e(this.el.playlist).addClass("plyr-is-preview"):e(this.el.playlist).removeClass("plyr-is-preview"),r.downloadable?e(this.el.download).addClass("is-downloadable"):e(this.el.download).removeClass("is-downloadable"),e(this.el.download).attr("href",r.download_url),""!==r.purchase_url?e(this.el.purchase).addClass("is-purchasable"):e(this.el.purchase).removeClass("is-purchasable"),e(this.el.purchase).html(r.purchase_title),e(this.el.purchase).attr("href",r.purchase_url),e(this.el.purchase).next(".plyr_purchase").remove(),""!==r.purchase_link&&e(this.el.purchase).after(e(r.purchase_link).addClass("plyr_purchase")),e(this.el.like).attr("data-id",r.id),r.like?e(this.el.like).addClass("active"):e(this.el.like).removeClass("active"),e(this.el.waveform).remove(),r.waveform){var n=e(this.el.controls.waveform);e(this.el.progress).prepend(n);var a={container:n.find(".waveform-container"),id:r.id,duration:r.duration,height:40};"object"==typeof play&&play.waveform_option&&(a=e.extend(!0,{},a,play.waveform_option));var s=new Waveform(a);s.load(r.waveform),e(s.wrap).on("update",(function(e,t,r){i.player.currentTime=i.player.duration*t}))}if(e("span",this.el.queue).html(this.options.i18n.queue+" • "+(this.active+1)+" / "+this.items.length),r.msg&&this.showMsg(r.msg),RangeTouch.setup('input[type="range"]',{}),e(document).trigger("refresh"),window.location.href!==r.uri&&"video"==this.options.theme&&e(".single-station").length){var o=r.uri;void 0!==typeof Pjax&&-1===o.toLowerCase().indexOf("reload")?e(document).trigger("reload",[o]):location.href=o}this._history()}},updateTitle:function(t,i){this.log("Update title");var r=this.getCurrent(),n={title:r.title,artist:r.artist,artwork:[{src:r.artwork_url}]},a=e(this.el.playlist).find("video, audio");t&&(e(this.el.title).html(t),a.attr("title",t),n.title=t),i&&(e(this.el.poster).css("background-image","url("+i+")"),a.attr("poster",i),n.artwork=[{src:i}]),navigator.mediaSession&&(this.log("Navigator mediaSession"),navigator.mediaSession.metadata=new MediaMetadata(n))},buildAuthor:function(e){var t='<a href="'+e.user_url+'">'+e.user+"</a>";if(e.artist&&e.artist_url){var i=e.artist.split(","),r=e.artist_url.split(",");t=[];for(var n=0;n<i.length;++n)t.push('<a href="'+r[n]+'">'+i[n]+"</a>");t=t.join(", ").replace(/, ((?:.(?!, ))+)$/," & $1")}return t},setIndex:function(e,t){this.active=e>this.items.length-1?0:e<0?this.items.length-1:e,this.shuffle&&(this.active=Math.floor(Math.random()*this.items.length)),t&&t()},getIndex:function(e){for(var t=0;t<this.items.length;t++)if(parseInt(this.items[t].id)===parseInt(e))return t;return-1},getCurrent:function(){return this.items[this.active]},isPlayable:function(){var e=this.getCurrent();return!(!e||""===e.stream_url)},updateLive:function(){if(this.live){this.log("Update live");var t,i,r=this,n=this.getCurrent(),a=!1,s=!1,o="",l="",d={};r.liveServer="",n&&(o=(t=n.stream_url).substring(0,t.lastIndexOf("/")),t.toLowerCase().indexOf("icecast")>-1&&(r.liveServer="icecast",l="/status-json.xsl"),t.toLowerCase().indexOf("shoutcast")>-1&&(r.liveServer="shoutcast",l="/stats?sid=1&json=1",d.dataType="jsonp"),t.toLowerCase().indexOf("azuracast")>-1&&(r.liveServer="azuracast",l="/api/nowplaying"),t.toLowerCase().indexOf("livestream")>-1&&(r.liveServer="livestream",o="",l=t.substring(t.lastIndexOf("livestream=")+1)),clearTimeout(r.timeout),d.url=o+l,e.ajax(d).then((function(e){if("icecast"==r.liveServer){if(i=e.icestats.source,e.icestats.source.length>0){i=e.icestats.source[0];for(var n=0;n<e.icestats.source.length;++n)if(t.indexOf(e.icestats.source[n].listenurl)>-1){i=e.icestats.source[n];break}}i.title&&(a=(i.artist?i.artist+" - ":"")+i.title)}else if("shoutcast"==r.liveServer)a=e.songtitle;else if("azuracast"==r.liveServer){for(i=e[0].now_playing.song,n=0;n<e.length;++n)if(t.indexOf(e[n].station.listen_url)>-1){i=e[n].now_playing.song;break}i.text&&(a=i.text),i.art&&(s=i.art)}else"livestream"==r.liveServer&&("string"==typeof e&&(a=e),"object"==typeof e&&(a=e.title));r.timeout&&r.updateTitle(a,s),r.timeout=setTimeout((function(){r.updateLive()}),5e3)})))}},playAds:function(){var e=this;this.log("Play ads"),e.player.ads&&e.isPlayable()&&(e.player.ads.initialized?e.adsInter%(parseInt(e.options.adsInterval)+1)==0&&e.player.ads.cancel():e.player.ads.play(),e.adsInter++)},showMsg:function(t){this.log("Show msg");var i=this;0==e(i.el.msg).length&&e(i.el.playlist).append(i.el.controls.msg),e(i.el.msg+" .close").off().on("click",(function(){i.hideMsg()})),e(i.el.msg).show().find(".plyr__msg_desc").html(t)},hideMsg:function(){this.log("Hide msg"),e(this.el.msg).hide()},play:function(t,i){var r;if(e(this.el.playlist).removeClass("close-player"),e.isArray(t))t.length&&(this.setItems(t),r=i||0,this._play(r));else if(-1==(r=this.getIndex(t.id)))r=1==i?this.active:this.items.length-1,this.add(t,r),1!=this.items.length&&0!=i||this._play(this.items.length-1);else{if(1==i){var n=this.getItem(t.id);return this.remove(t.id),void this.add(n,this.active)}if(-1==i)return;r!==this.active?this._play(r):this.adsing||this.player.togglePlay()}},pause:function(){this.player.pause()},prev:function(){var e=this;this.setIndex(e.active-1,(function(){e._play(e.active)}))},next:function(){var e=this;this.setIndex(e.active+1,(function(){e._play(e.active)}))},add:function(e,t){this._addItem(e,t)},remove:function(e){var t=this.getCurrent();this._removeItem({id:e}),this.active=this.getIndex(t.id)},log:function(e){this.player.debug.log("> "+e)}}}(jQuery);var spotify={setup(){var e=this;e.elements.wrapper.classList.add(e.config.classNames.embed),e.config.urls.spotify="spotify","object"!=typeof window.SpotifyIFrameAPI?spotify.loadScript.call(e):spotify.ready.call(e)},ready(){var e=this,t=e.media.getAttribute("src");if(-1!=t.indexOf("spotify.com")){var i=e.config.urls.spotify+t.replace("https://open.spotify.com","").replace(/\//gi,":"),r=document.createElement("iframe");r.setAttribute("allow",["autoplay"].join("; ")),e.media=e.media.parentNode.replaceChild(r,e.media),SpotifyIFrameAPI.createController(r,{uri:i},(t=>{e.media.paused=!0,e.media.currentTime=0,e.options.speed=[1],e.embed=t,e.media.play=function(){assurePlaybackState.call(e,!0),e.embed.hasPlayed?e.embed.togglePlay():e.embed.play()},e.media.pause=function(){assurePlaybackState.call(e,!1),e.embed.pause()},e.media.stop=function(){e.pause(),e.media.currentTime=0},e.embed.load=function(t){e.embed.loadUri(e.config.urls.spotify+t.replace(/\//gi,":"))};var i=e.media.currentTime;Object.defineProperty(e.media,"currentTime",{get:()=>i,set(t){e.media.seeking=!0,triggerEvent.call(e,e.media,"seeking"),e.embed.seek(parseInt(t))}}),e.embed.addListener("ready",(function(t){triggerEvent.call(e,e.media,"waiting")})),e.embed.addListener("playback_update",(function(t){t.data.duration>0&&t.data.position==t.data.duration?triggerEvent.call(e,e.media,"ended"):(assurePlaybackState.call(e,!t.data.isPaused),t.data.isBuffering||(e.media.seeking&&t.data.isPaused&&e.media.play(),e.media.seeking=!1,triggerEvent.call(e,e.media,"seeked")),i=parseInt(t.data.position/1e3),triggerEvent.call(e,e.media,"timeupdate"),e.media.duration!=t.data.duration/1e3&&(e.media.duration=t.data.duration/1e3,triggerEvent.call(e,e.media,"durationchange")),triggerEvent.call(e,e.media,t.data.isBuffering?"seeking":"playing"))}))})),setTimeout((function(){window.Plyr.ui.build.call(e)}),0)}},loadScript(){var e=this,t=document.createElement("script");t.onload=function(){window.onSpotifyIframeApiReady=t=>{window.SpotifyIFrameAPI=t,spotify.ready.call(e)}},t.src="//open.spotify.com/embed-podcast/iframe-api/v1",document.head.appendChild(t)}},soundcloud={setup(){var e=this;e.elements.wrapper.classList.add(e.config.classNames.embed),e.config.urls.soundcloud="https://w.soundcloud.com/player/?url=","object"!=typeof window.SC?soundcloud.loadScript.call(e):soundcloud.ready.call(e)},ready(){var e=this,t=e.media.getAttribute("src");if(-1!=t.indexOf("soundcloud.com")){var i=e.config.urls.soundcloud+t+"&auto_play=true",r=document.createElement("iframe");r.setAttribute("src",i),r.setAttribute("allow",["autoplay"].join("; ")),e.media=e.media.parentNode.replaceChild(r,e.media),e.embed=SC.Widget(r),e.embed.bind(SC.Widget.Events.READY,(function(){var t;e.media.paused=!0,e.media.currentTime=0,e.options.speed=[1],e.media.play=function(){assurePlaybackState.call(e,!0),e.embed.play()},e.media.pause=function(){assurePlaybackState.call(e,!1),e.embed.pause()},e.media.stop=function(){e.embed.seekTo(0),e.embed.pause(),e.media.paused=!0},e.embed.getCurrentSound((function(e){t=e.uri})),Object.defineProperty(e.media,"currentSrc",{get:()=>t});var i=e.media.currentTime;Object.defineProperty(e.media,"currentTime",{get:()=>i,set(t){e.media.seeking=!0,triggerEvent.call(e,e.media,"seeking"),e.embed.seekTo(1e3*t)}}),Object.defineProperty(e.media,"volume",{get:()=>e.config.volume,set(t){e.embed.setVolume(100*t),e.config.volume=t,triggerEvent.call(e,e.media,"volumechange")}}),Object.defineProperty(e.media,"muted",{get:()=>e.config.muted,set(t){var i="boolean"==typeof t&&t;e.embed.setVolume(i?0:100*e.config.volume),e.config.muted=i,triggerEvent.call(e,e.media,"volumechange")}}),Object.defineProperty(e.media,"ended",{get:()=>e.currentTime===e.duration}),e.embed.getDuration((function(t){e.media.duration=t/1e3,triggerEvent.call(e,e.media,"durationchange")})),e.embed.bind(window.SC.Widget.Events.PLAY,(function(){assurePlaybackState.call(e,!0),triggerEvent.call(e,e.media,"playing")})),e.embed.bind(window.SC.Widget.Events.PAUSE,(function(){assurePlaybackState.call(e,!1)})),e.embed.bind(window.SC.Widget.Events.FINISH,(function(){e.media.paused=!0,triggerEvent.call(e,e.media,"ended")})),e.embed.bind(window.SC.Widget.Events.LOAD_PROGRESS,(function(t){e.media.buffered=t.loadProgress,triggerEvent.call(e,e.media,"progress"),1===parseInt(t.loadProgress)&&triggerEvent.call(e,e.media,"canplaythrough")})),e.embed.bind(window.SC.Widget.Events.PLAY_PROGRESS,(function(t){e.media.seeking=!1,i=parseInt(t.currentPosition/1e3),triggerEvent.call(e,e.media,"timeupdate")})),setTimeout((function(){window.Plyr.ui.build.call(e)}),0)}))}},loadScript(){var e=this,t=document.createElement("script");t.onload=function(){soundcloud.ready.call(e)},t.src="//w.soundcloud.com/player/api.js",document.head.appendChild(t)}},mixcloud={setup(){var e=this;e.elements.wrapper.classList.add(e.config.classNames.embed),e.config.urls.mixcloud="https://www.mixcloud.com/widget/iframe/?hide_cover=1&mini=1&feed=","object"!=typeof window.Mixcloud?mixcloud.loadScript.call(e):mixcloud.ready.call(e)},ready(){var e=this,t=e.media.getAttribute("src");if(-1!=t.indexOf("soundcloud.com")){var i=e.config.urls.mixcloud+t,r=document.createElement("iframe");r.setAttribute("src",i),r.setAttribute("allow",["autoplay"].join("; ")),e.media=e.media.parentNode.replaceChild(r,e.media),e.embed=Mixcloud.PlayerWidget(r),e.embed.ready.then((function(){e.media.paused=!0,e.media.currentTime=0,e.options.speed=[1],e.media.play=function(){assurePlaybackState.call(e,!0),e.embed.play()},e.media.pause=function(){assurePlaybackState.call(e,!1),e.embed.pause()},e.media.stop=function(){e.embed.seek(0),e.embed.pause(),e.media.paused=!0};var t=e.media.currentTime;Object.defineProperty(e.media,"currentTime",{get:()=>t,set(t){e.media.seeking=!0,triggerEvent.call(e,e.media,"seeking"),e.embed.seek(t).then((function(){e.media.seeking=!1,e.embed.play()}))}}),Object.defineProperty(e.media,"volume",{get:()=>e.config.volume,set(t){e.embed.setVolume(100*t),e.config.volume=t,triggerEvent.call(e,e.media,"volumechange")}}),Object.defineProperty(e.media,"muted",{get:()=>e.config.muted,set(t){var i="boolean"==typeof t&&t;e.embed.setVolume(i?0:100*e.config.volume),e.config.muted=i,triggerEvent.call(e,e.media,"volumechange")}}),Object.defineProperty(e.media,"ended",{get:()=>e.currentTime===e.duration}),e.embed.getDuration().then((function(t){e.media.duration=t,triggerEvent.call(e,e.media,"durationchange")})),e.embed.events.play.on((function(){assurePlaybackState.call(e,!0),triggerEvent.call(e,e.media,"playing")})),e.embed.events.pause.on((function(){assurePlaybackState.call(e,!1)})),e.embed.events.ended.on((function(){e.media.paused=!0,triggerEvent.call(e,e.media,"ended")})),e.embed.events.buffering.on((function(t){e.media.buffered=t,1===parseInt(t)&&triggerEvent.call(e,e.media,"canplaythrough")})),e.embed.events.progress.on((function(i){e.media.seeking=!1,t=i,triggerEvent.call(e,e.media,"timeupdate")})),setTimeout((function(){window.Plyr.ui.build.call(e)}),0)}))}},loadScript(){var e=this,t=document.createElement("script");t.onload=function(){mixcloud.ready.call(e)},t.src="//widget.mixcloud.com/media/js/widgetApi.js",document.head.appendChild(t)}};"object"==typeof navigator&&function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define("Plyr",t):(e="undefined"!=typeof globalThis?globalThis:e||self).Plyr=t()}(this,(function(){"use strict";!function(){if("undefined"!=typeof window)try{var e=new window.CustomEvent("test",{cancelable:!0});if(e.preventDefault(),!0!==e.defaultPrevented)throw new Error("Could not prevent default")}catch(e){var t=function(e,t){var i,r;return(t=t||{}).bubbles=!!t.bubbles,t.cancelable=!!t.cancelable,(i=document.createEvent("CustomEvent")).initCustomEvent(e,t.bubbles,t.cancelable,t.detail),r=i.preventDefault,i.preventDefault=function(){r.call(this);try{Object.defineProperty(this,"defaultPrevented",{get:function(){return!0}})}catch(e){this.defaultPrevented=!0}},i};t.prototype=window.Event.prototype,window.CustomEvent=t}}();var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function t(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t);if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function i(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function r(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function n(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function a(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?n(Object(i),!0).forEach((function(t){r(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):n(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}!function(e){var t=function(){try{return!!Symbol.iterator}catch(e){return!1}}(),i=function(e){var i={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return t&&(i[Symbol.iterator]=function(){return i}),i},r=function(e){return encodeURIComponent(e).replace(/%20/g,"+")},n=function(e){return decodeURIComponent(String(e).replace(/\+/g," "))};(function(){try{var t=e.URLSearchParams;return"a=1"===new t("?a=1").toString()&&"function"==typeof t.prototype.set&&"function"==typeof t.prototype.entries}catch(e){return!1}})()||function(){var n=function(e){Object.defineProperty(this,"_entries",{writable:!0,value:{}});var t=typeof e;if("undefined"===t);else if("string"===t)""!==e&&this._fromString(e);else if(e instanceof n){var i=this;e.forEach((function(e,t){i.append(t,e)}))}else{if(null===e||"object"!==t)throw new TypeError("Unsupported input's type for URLSearchParams");if("[object Array]"===Object.prototype.toString.call(e))for(var r=0;r<e.length;r++){var a=e[r];if("[object Array]"!==Object.prototype.toString.call(a)&&2===a.length)throw new TypeError("Expected [string, any] as entry at index "+r+" of URLSearchParams's input");this.append(a[0],a[1])}else for(var s in e)e.hasOwnProperty(s)&&this.append(s,e[s])}},a=n.prototype;a.append=function(e,t){e in this._entries?this._entries[e].push(String(t)):this._entries[e]=[String(t)]},a.delete=function(e){delete this._entries[e]},a.get=function(e){return e in this._entries?this._entries[e][0]:null},a.getAll=function(e){return e in this._entries?this._entries[e].slice(0):[]},a.has=function(e){return e in this._entries},a.set=function(e,t){this._entries[e]=[String(t)]},a.forEach=function(e,t){var i;for(var r in this._entries)if(this._entries.hasOwnProperty(r)){i=this._entries[r];for(var n=0;n<i.length;n++)e.call(t,i[n],r,this)}},a.keys=function(){var e=[];return this.forEach((function(t,i){e.push(i)})),i(e)},a.values=function(){var e=[];return this.forEach((function(t){e.push(t)})),i(e)},a.entries=function(){var e=[];return this.forEach((function(t,i){e.push([i,t])})),i(e)},t&&(a[Symbol.iterator]=a.entries),a.toString=function(){var e=[];return this.forEach((function(t,i){e.push(r(i)+"="+r(t))})),e.join("&")},e.URLSearchParams=n}();var a=e.URLSearchParams.prototype;"function"!=typeof a.sort&&(a.sort=function(){var e=this,t=[];this.forEach((function(i,r){t.push([r,i]),e._entries||e.delete(r)})),t.sort((function(e,t){return e[0]<t[0]?-1:e[0]>t[0]?1:0})),e._entries&&(e._entries={});for(var i=0;i<t.length;i++)this.append(t[i][0],t[i][1])}),"function"!=typeof a._fromString&&Object.defineProperty(a,"_fromString",{enumerable:!1,configurable:!1,writable:!1,value:function(e){if(this._entries)this._entries={};else{var t=[];this.forEach((function(e,i){t.push(i)}));for(var i=0;i<t.length;i++)this.delete(t[i])}var r,a=(e=e.replace(/^\?/,"")).split("&");for(i=0;i<a.length;i++)r=a[i].split("="),this.append(n(r[0]),r.length>1?n(r[1]):"")}})}(void 0!==e?e:"undefined"!=typeof window?window:"undefined"!=typeof self?self:e),function(e){if(function(){try{var t=new e.URL("b","http://a");return t.pathname="c d","http://a/c%20d"===t.href&&t.searchParams}catch(e){return!1}}()||function(){var t=e.URL,i=function(t,i){"string"!=typeof t&&(t=String(t)),i&&"string"!=typeof i&&(i=String(i));var r,n=document;if(i&&(void 0===e.location||i!==e.location.href)){i=i.toLowerCase(),(r=(n=document.implementation.createHTMLDocument("")).createElement("base")).href=i,n.head.appendChild(r);try{if(0!==r.href.indexOf(i))throw new Error(r.href)}catch(e){throw new Error("URL unable to set base "+i+" due to "+e)}}var a=n.createElement("a");a.href=t,r&&(n.body.appendChild(a),a.href=a.href);var s=n.createElement("input");if(s.type="url",s.value=t,":"===a.protocol||!/:/.test(a.href)||!s.checkValidity()&&!i)throw new TypeError("Invalid URL");Object.defineProperty(this,"_anchorElement",{value:a});var o=new e.URLSearchParams(this.search),l=!0,d=!0,u=this;["append","delete","set"].forEach((function(e){var t=o[e];o[e]=function(){t.apply(o,arguments),l&&(d=!1,u.search=o.toString(),d=!0)}})),Object.defineProperty(this,"searchParams",{value:o,enumerable:!0});var c=void 0;Object.defineProperty(this,"_updateSearchParams",{enumerable:!1,configurable:!1,writable:!1,value:function(){this.search!==c&&(c=this.search,d&&(l=!1,this.searchParams._fromString(this.search),l=!0))}})},r=i.prototype;["hash","host","hostname","port","protocol"].forEach((function(e){!function(e){Object.defineProperty(r,e,{get:function(){return this._anchorElement[e]},set:function(t){this._anchorElement[e]=t},enumerable:!0})}(e)})),Object.defineProperty(r,"search",{get:function(){return this._anchorElement.search},set:function(e){this._anchorElement.search=e,this._updateSearchParams()},enumerable:!0}),Object.defineProperties(r,{toString:{get:function(){var e=this;return function(){return e.href}}},href:{get:function(){return this._anchorElement.href.replace(/\?$/,"")},set:function(e){this._anchorElement.href=e,this._updateSearchParams()},enumerable:!0},pathname:{get:function(){return this._anchorElement.pathname.replace(/(^\/?)/,"/")},set:function(e){this._anchorElement.pathname=e},enumerable:!0},origin:{get:function(){var e={"http:":80,"https:":443,"ftp:":21}[this._anchorElement.protocol],t=this._anchorElement.port!=e&&""!==this._anchorElement.port;return this._anchorElement.protocol+"//"+this._anchorElement.hostname+(t?":"+this._anchorElement.port:"")},enumerable:!0},password:{get:function(){return""},set:function(e){},enumerable:!0},username:{get:function(){return""},set:function(e){},enumerable:!0}}),i.createObjectURL=function(e){return t.createObjectURL.apply(t,arguments)},i.revokeObjectURL=function(e){return t.revokeObjectURL.apply(t,arguments)},e.URL=i}(),void 0!==e.location&&!("origin"in e.location)){var t=function(){return e.location.protocol+"//"+e.location.hostname+(e.location.port?":"+e.location.port:"")};try{Object.defineProperty(e.location,"origin",{get:t,enumerable:!0})}catch(i){setInterval((function(){e.location.origin=t()}),100)}}}(void 0!==e?e:"undefined"!=typeof window?window:"undefined"!=typeof self?self:e);var s={addCSS:!0,thumbWidth:15,watch:!0};function o(e,t){return function(){return Array.from(document.querySelectorAll(t)).includes(this)}.call(e,t)}var l=function(e){return null!=e?e.constructor:null},d=function(e,t){return!!(e&&t&&e instanceof t)},u=function(e){return l(e)===String},c=function(e){return Array.isArray(e)},h=function(e){return d(e,NodeList)},f=u,p=c,m=h,g=function(e){return d(e,Element)},v=function(e){return d(e,Event)},y=function(e){return function(e){return null==e}(e)||(u(e)||c(e)||h(e))&&!e.length||function(e){return l(e)===Object}(e)&&!Object.keys(e).length};var b=function(){function e(t,i){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),g(t)?this.element=t:f(t)&&(this.element=document.querySelector(t)),g(this.element)&&y(this.element.rangeTouch)&&(this.config=a({},s,{},i),this.init())}return function(e,t,r){t&&i(e.prototype,t),r&&i(e,r)}(e,[{key:"init",value:function(){e.enabled&&(this.config.addCSS&&(this.element.style.userSelect="none",this.element.style.webKitUserSelect="none",this.element.style.touchAction="manipulation"),this.listeners(!0),this.element.rangeTouch=this)}},{key:"destroy",value:function(){e.enabled&&(this.config.addCSS&&(this.element.style.userSelect="",this.element.style.webKitUserSelect="",this.element.style.touchAction=""),this.listeners(!1),this.element.rangeTouch=null)}},{key:"listeners",value:function(e){var t=this,i=e?"addEventListener":"removeEventListener";["touchstart","touchmove","touchend"].forEach((function(e){t.element[i](e,(function(e){return t.set(e)}),!1)}))}},{key:"get",value:function(t){if(!e.enabled||!v(t))return null;var i,r=t.target,n=t.changedTouches[0],a=parseFloat(r.getAttribute("min"))||0,s=parseFloat(r.getAttribute("max"))||100,o=parseFloat(r.getAttribute("step"))||1,l=r.getBoundingClientRect(),d=100/l.width*(this.config.thumbWidth/2)/100;return 0>(i=100/l.width*(n.clientX-l.left))?i=0:100<i&&(i=100),50>i?i-=(100-2*i)*d:50<i&&(i+=2*(i-50)*d),a+function(e,t){if(1>t){var i=function(e){var t="".concat(e).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/);return t?Math.max(0,(t[1]?t[1].length:0)-(t[2]?+t[2]:0)):0}(t);return parseFloat(e.toFixed(i))}return Math.round(e/t)*t}(i/100*(s-a),o)}},{key:"set",value:function(t){e.enabled&&v(t)&&!t.target.disabled&&(t.preventDefault(),t.target.value=this.get(t),function(e,t){if(e&&t){var i=new Event(t,{bubbles:!0});e.dispatchEvent(i)}}(t.target,"touchend"===t.type?"change":"input"))}}],[{key:"setup",value:function(t){var i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r=null;if(y(t)||f(t)?r=Array.from(document.querySelectorAll(f(t)?t:'input[type="range"]')):g(t)?r=[t]:m(t)?r=Array.from(t):p(t)&&(r=t.filter(g)),y(r))return null;var n=a({},s,{},i);if(f(t)&&n.watch){var l=new MutationObserver((function(i){Array.from(i).forEach((function(i){Array.from(i.addedNodes).forEach((function(i){g(i)&&o(i,t)&&new e(i,n)}))}))}));l.observe(document.body,{childList:!0,subtree:!0})}return r.map((function(t){return new e(t,i)}))}},{key:"enabled",get:function(){return"ontouchstart"in document.documentElement}}]),e}();window.RangeTouch=b;const w=e=>null!=e?e.constructor:null,_=(e,t)=>Boolean(e&&t&&e instanceof t),T=e=>null==e,E=e=>w(e)===Object,S=e=>w(e)===String,k=e=>"function"==typeof e,A=e=>Array.isArray(e),C=e=>_(e,NodeList),R=e=>T(e)||(S(e)||A(e)||C(e))&&!e.length||E(e)&&!Object.keys(e).length;var L=T,D=E,x=e=>w(e)===Number&&!Number.isNaN(e),O=S,P=e=>w(e)===Boolean,I=k,M=A,N=C,F=e=>null!==e&&"object"==typeof e&&1===e.nodeType&&"object"==typeof e.style&&"object"==typeof e.ownerDocument,U=e=>_(e,Event),B=e=>_(e,KeyboardEvent),j=e=>_(e,TextTrack)||!T(e)&&S(e.kind),$=e=>{if(_(e,window.URL))return!0;if(!S(e))return!1;let t=e;e.startsWith("http://")&&e.startsWith("https://")||(t=`http://${e}`);try{return!R(new URL(t).hostname)}catch(e){return!1}},H=R;const G=(()=>{const e=document.createElement("span"),t={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"},i=Object.keys(t).find((t=>void 0!==e.style[t]));return!!O(i)&&t[i]})();function q(e,t){setTimeout((()=>{try{e.hidden=!0,e.offsetHeight,e.hidden=!1}catch(e){}}),t)}var K={isIE:Boolean(window.document.documentMode),isEdge:/Edge/g.test(navigator.userAgent),isWebKit:"WebkitAppearance"in document.documentElement.style&&!/Edge/g.test(navigator.userAgent),isIPhone:/iPhone|iPod/gi.test(navigator.userAgent)&&navigator.maxTouchPoints>1,isIPadOS:"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1,isIos:/iPad|iPhone|iPod/gi.test(navigator.userAgent)&&navigator.maxTouchPoints>1};function W(e,t){return t.split(".").reduce(((e,t)=>e&&e[t]),e)}function V(e={},...t){if(!t.length)return e;const i=t.shift();return D(i)?(Object.keys(i).forEach((t=>{D(i[t])?(Object.keys(e).includes(t)||Object.assign(e,{[t]:{}}),V(e[t],i[t])):Object.assign(e,{[t]:i[t]})})),V(e,...t)):e}function Y(e,t){const i=e.length?e:[e];Array.from(i).reverse().forEach(((e,i)=>{const r=i>0?t.cloneNode(!0):t,n=e.parentNode,a=e.nextSibling;r.appendChild(e),a?n.insertBefore(r,a):n.appendChild(r)}))}function z(e,t){F(e)&&!H(t)&&Object.entries(t).filter((([,e])=>!L(e))).forEach((([t,i])=>e.setAttribute(t,i)))}function X(e,t,i){const r=document.createElement(e);return D(t)&&z(r,t),O(i)&&(r.innerText=i),r}function Q(e,t,i,r){F(t)&&t.appendChild(X(e,i,r))}function J(e){N(e)||M(e)?Array.from(e).forEach(J):F(e)&&F(e.parentNode)&&e.parentNode.removeChild(e)}function Z(e){if(!F(e))return;let{length:t}=e.childNodes;for(;t>0;)e.removeChild(e.lastChild),t-=1}function ee(e,t){return F(t)&&F(t.parentNode)&&F(e)?(t.parentNode.replaceChild(e,t),e):null}function te(e,t){if(!O(e)||H(e))return{};const i={},r=V({},t);return e.split(",").forEach((e=>{const t=e.trim(),n=t.replace(".",""),a=t.replace(/[[\]]/g,"").split("="),[s]=a,o=a.length>1?a[1].replace(/["']/g,""):"";switch(t.charAt(0)){case".":O(r.class)?i.class=`${r.class} ${n}`:i.class=n;break;case"#":i.id=t.replace("#","");break;case"[":i[s]=o}})),V(r,i)}function ie(e,t){if(!F(e))return;let i=t;P(i)||(i=!e.hidden),e.hidden=i}function re(e,t,i){if(N(e))return Array.from(e).map((e=>re(e,t,i)));if(F(e)){let r="toggle";return void 0!==i&&(r=i?"add":"remove"),e.classList[r](t),e.classList.contains(t)}return!1}function ne(e,t){return F(e)&&e.classList.contains(t)}function ae(e,t){const{prototype:i}=Element;return(i.matches||i.webkitMatchesSelector||i.mozMatchesSelector||i.msMatchesSelector||function(){return Array.from(document.querySelectorAll(t)).includes(this)}).call(e,t)}function se(e){return this.elements.container.querySelectorAll(e)}function oe(e){return this.elements.container.querySelector(e)}function le(e=null,t=!1){F(e)&&e.focus({preventScroll:!0,focusVisible:t})}const de={"audio/ogg":"vorbis","audio/wav":"1","video/webm":"vp8, vorbis","video/mp4":"avc1.42E01E, mp4a.40.2","video/ogg":"theora"},ue={audio:"canPlayType"in document.createElement("audio"),video:"canPlayType"in document.createElement("video"),check(e,t){const i=ue[e]||"html5"!==t;return{api:i,ui:i&&ue.rangeInput}},pip:!(K.isIPhone||!I(X("video").webkitSetPresentationMode)&&(!document.pictureInPictureEnabled||X("video").disablePictureInPicture)),airplay:I(window.WebKitPlaybackTargetAvailabilityEvent),playsinline:"playsInline"in document.createElement("video"),mime(e){if(H(e))return!1;const[t]=e.split("/");let i=e;if(!this.isHTML5||t!==this.type)return!1;Object.keys(de).includes(i)&&(i+=`; codecs="${de[e]}"`);try{return Boolean(i&&this.media.canPlayType(i).replace(/no/,""))}catch(e){return!1}},textTracks:"textTracks"in document.createElement("video"),rangeInput:(()=>{const e=document.createElement("input");return e.type="range","range"===e.type})(),touch:"ontouchstart"in document.documentElement,transitions:!1!==G,reducedMotion:"matchMedia"in window&&window.matchMedia("(prefers-reduced-motion)").matches},ce=(()=>{let e=!1;try{const t=Object.defineProperty({},"passive",{get:()=>(e=!0,null)});window.addEventListener("test",null,t),window.removeEventListener("test",null,t)}catch(e){}return e})();function he(e,t,i,r=!1,n=!0,a=!1){if(!e||!("addEventListener"in e)||H(t)||!I(i))return;const s=t.split(" ");let o=a;ce&&(o={passive:n,capture:a}),s.forEach((t=>{this&&this.eventListeners&&r&&this.eventListeners.push({element:e,type:t,callback:i,options:o}),e[r?"addEventListener":"removeEventListener"](t,i,o)}))}function fe(e,t="",i,r=!0,n=!1){he.call(this,e,t,i,!0,r,n)}function pe(e,t="",i,r=!0,n=!1){he.call(this,e,t,i,!1,r,n)}function me(e,t="",i,r=!0,n=!1){const a=(...s)=>{pe(e,t,a,r,n),i.apply(this,s)};he.call(this,e,t,a,!0,r,n)}function ge(e,t="",i=!1,r={}){if(!F(e)||H(t))return;const n=new CustomEvent(t,{bubbles:i,detail:{...r,plyr:this}});e.dispatchEvent(n)}function ve(){this&&this.eventListeners&&(this.eventListeners.forEach((e=>{const{element:t,type:i,callback:r,options:n}=e;t.removeEventListener(i,r,n)})),this.eventListeners=[])}function ye(){return new Promise((e=>this.ready?setTimeout(e,0):fe.call(this,this.elements.container,"ready",e))).then((()=>{}))}function be(e){(e=>_(e,Promise)&&k(e.then))(e)&&e.then(null,(()=>{}))}function we(e){return M(e)?e.filter(((t,i)=>e.indexOf(t)===i)):e}function _e(e,t){return M(e)&&e.length?e.reduce(((e,i)=>Math.abs(i-t)<Math.abs(e-t)?i:e)):null}function Te(e){return!(!window||!window.CSS)&&window.CSS.supports(e)}const Ee=[[1,1],[4,3],[3,4],[5,4],[4,5],[3,2],[2,3],[16,10],[10,16],[16,9],[9,16],[21,9],[9,21],[32,9],[9,32]].reduce(((e,[t,i])=>({...e,[t/i]:[t,i]})),{});function Se(e){return!!(M(e)||O(e)&&e.includes(":"))&&(M(e)?e:e.split(":")).map(Number).every(x)}function ke(e){if(!M(e)||!e.every(x))return null;const[t,i]=e,r=(e,t)=>0===t?e:r(t,e%t),n=r(t,i);return[t/n,i/n]}function Ae(e){const t=e=>Se(e)?e.split(":").map(Number):null;let i=t(e);if(null===i&&(i=t(this.config.ratio)),null===i&&!H(this.embed)&&M(this.embed.ratio)&&({ratio:i}=this.embed),null===i&&this.isHTML5){const{videoWidth:e,videoHeight:t}=this.media;i=[e,t]}return ke(i)}function Ce(e){if(!this.isVideo)return{};const{wrapper:t}=this.elements,i=Ae.call(this,e);if(!M(i))return{};const[r,n]=ke(i),a=100/r*n;if(Te(`aspect-ratio: ${r}/${n}`)?t.style.aspectRatio=`${r}/${n}`:t.style.paddingBottom=`${a}%`,this.isVimeo&&!this.config.vimeo.premium&&this.supported.ui){const e=100/this.media.offsetWidth*parseInt(window.getComputedStyle(this.media).paddingBottom,10),i=(e-a)/(e/50);this.fullscreen.active?t.style.paddingBottom=null:this.media.style.transform=`translateY(-${i}%)`}else this.isHTML5&&t.classList.add(this.config.classNames.videoFixedRatio);return{padding:a,ratio:i}}function Re(e,t,i=.05){const r=e/t,n=_e(Object.keys(Ee),r);return Math.abs(n-r)<=i?Ee[n]:[e,t]}const Le={getSources(){return this.isHTML5?Array.from(this.media.querySelectorAll("source")).filter((e=>{const t=e.getAttribute("type");return!!H(t)||ue.mime.call(this,t)})):[]},getQualityOptions(){return this.config.quality.forced?this.config.quality.options:Le.getSources.call(this).map((e=>Number(e.getAttribute("size")))).filter(Boolean)},setup(){if(!this.isHTML5)return;const e=this;e.options.speed=e.config.speed.options,H(this.config.ratio)||Ce.call(e),Object.defineProperty(e.media,"quality",{get(){const t=Le.getSources.call(e).find((t=>t.getAttribute("src")===e.source));return t&&Number(t.getAttribute("size"))},set(t){if(e.quality!==t){if(e.config.quality.forced&&I(e.config.quality.onChange))e.config.quality.onChange(t);else{const i=Le.getSources.call(e).find((e=>Number(e.getAttribute("size"))===t));if(!i)return;const{currentTime:r,paused:n,preload:a,readyState:s,playbackRate:o}=e.media;e.media.src=i.getAttribute("src"),("none"!==a||s)&&(e.once("loadedmetadata",(()=>{e.speed=o,e.currentTime=r,n||be(e.play())})),e.media.load())}ge.call(e,e.media,"qualitychange",!1,{quality:t})}}})},cancelRequests(){this.isHTML5&&(J(Le.getSources.call(this)),this.media.setAttribute("src",this.config.blankVideo),this.media.load(),this.debug.log("Cancelled network requests"))}};function De(e,...t){return H(e)?e:e.toString().replace(/{(\d+)}/g,((e,i)=>t[i].toString()))}const xe=(e="",t="",i="")=>e.replace(new RegExp(t.toString().replace(/([.*+?^=!:${}()|[\]/\\])/g,"\\$1"),"g"),i.toString()),Oe=(e="")=>e.toString().replace(/\w\S*/g,(e=>e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()));function Pe(e){const t=document.createElement("div");return t.appendChild(e),t.innerHTML}const Ie={pip:"PIP",airplay:"AirPlay",html5:"HTML5",vimeo:"Vimeo",youtube:"YouTube"},Me={get(e="",t={}){if(H(e)||H(t))return"";let i=W(t.i18n,e);if(H(i))return Object.keys(Ie).includes(e)?Ie[e]:"";const r={"{seektime}":t.seekTime,"{title}":t.title};return Object.entries(r).forEach((([e,t])=>{i=xe(i,e,t)})),i}};class Ne{constructor(e){t(this,"get",(e=>{if(!Ne.supported||!this.enabled)return null;const t=window.localStorage.getItem(this.key);if(H(t))return null;const i=JSON.parse(t);return O(e)&&e.length?i[e]:i})),t(this,"set",(e=>{if(!Ne.supported||!this.enabled)return;if(!D(e))return;let t=this.get();H(t)&&(t={}),V(t,e);try{window.localStorage.setItem(this.key,JSON.stringify(t))}catch(e){}})),this.enabled=e.config.storage.enabled,this.key=e.config.storage.key}static get supported(){try{if(!("localStorage"in window))return!1;const e="___test";return window.localStorage.setItem(e,e),window.localStorage.removeItem(e),!0}catch(e){return!1}}}function Fe(e,t="text"){return new Promise(((i,r)=>{try{const r=new XMLHttpRequest;if(!("withCredentials"in r))return;r.addEventListener("load",(()=>{if("text"===t)try{i(JSON.parse(r.responseText))}catch(e){i(r.responseText)}else i(r.response)})),r.addEventListener("error",(()=>{throw new Error(r.status)})),r.open("GET",e,!0),r.responseType=t,r.send()}catch(e){r(e)}}))}function Ue(e,t){if(!O(e))return;const i=O(t);let r=!1;const n=()=>null!==document.getElementById(t),a=(e,t)=>{e.innerHTML=t,i&&n()||document.body.insertAdjacentElement("afterbegin",e)};if(!i||!n()){const n=Ne.supported,s=document.createElement("div");if(s.setAttribute("hidden",""),i&&s.setAttribute("id",t),n){const e=window.localStorage.getItem(`cache-${t}`);if(r=null!==e,r){const t=JSON.parse(e);a(s,t.content)}}Fe(e).then((e=>{if(!H(e)){if(n)try{window.localStorage.setItem(`cache-${t}`,JSON.stringify({content:e}))}catch(e){}a(s,e)}})).catch((()=>{}))}}const Be=e=>Math.trunc(e/60/60%60,10);function je(e=0,t=!1,i=!1){if(!x(e))return je(void 0,t,i);const r=e=>`0${e}`.slice(-2);let n=Be(e);const a=(s=e,Math.trunc(s/60%60,10));var s;const o=(e=>Math.trunc(e%60,10))(e);return n=t||n>0?`${n}:`:"",`${i&&e>0?"-":""}${n}${r(a)}:${r(o)}`}const $e={getIconUrl(){const e=new URL(this.config.iconUrl,window.location),t=window.location.host?window.location.host:window.top.location.host,i=e.host!==t||K.isIE&&!window.svg4everybody;return{url:this.config.iconUrl,cors:i}},findElements(){try{return this.elements.controls=oe.call(this,this.config.selectors.controls.wrapper),this.elements.buttons={play:se.call(this,this.config.selectors.buttons.play),pause:oe.call(this,this.config.selectors.buttons.pause),restart:oe.call(this,this.config.selectors.buttons.restart),rewind:oe.call(this,this.config.selectors.buttons.rewind),fastForward:oe.call(this,this.config.selectors.buttons.fastForward),mute:oe.call(this,this.config.selectors.buttons.mute),pip:oe.call(this,this.config.selectors.buttons.pip),airplay:oe.call(this,this.config.selectors.buttons.airplay),settings:oe.call(this,this.config.selectors.buttons.settings),captions:oe.call(this,this.config.selectors.buttons.captions),fullscreen:oe.call(this,this.config.selectors.buttons.fullscreen)},this.elements.progress=oe.call(this,this.config.selectors.progress),this.elements.inputs={seek:oe.call(this,this.config.selectors.inputs.seek),volume:oe.call(this,this.config.selectors.inputs.volume)},this.elements.display={buffer:oe.call(this,this.config.selectors.display.buffer),currentTime:oe.call(this,this.config.selectors.display.currentTime),duration:oe.call(this,this.config.selectors.display.duration)},F(this.elements.progress)&&(this.elements.display.seekTooltip=this.elements.progress.querySelector(`.${this.config.classNames.tooltip}`)),!0}catch(e){return this.debug.warn("It looks like there is a problem with your custom controls HTML",e),this.toggleNativeControls(!0),!1}},createIcon(e,t){const i="http://www.w3.org/2000/svg",r=$e.getIconUrl.call(this),n=`${r.cors?"":r.url}#${this.config.iconPrefix}`,a=document.createElementNS(i,"svg");z(a,V(t,{"aria-hidden":"true",focusable:"false"}));const s=document.createElementNS(i,"use"),o=`${n}-${e}`;return"href"in s&&s.setAttributeNS("http://www.w3.org/1999/xlink","href",o),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",o),a.appendChild(s),a},createLabel(e,t={}){const i=Me.get(e,this.config);return X("span",{...t,class:[t.class,this.config.classNames.hidden].filter(Boolean).join(" ")},i)},createBadge(e){if(H(e))return null;const t=X("span",{class:this.config.classNames.menu.value});return t.appendChild(X("span",{class:this.config.classNames.menu.badge},e)),t},createButton(e,t){const i=V({},t);let r=function(e=""){let t=e.toString();return t=function(e=""){let t=e.toString();return t=xe(t,"-"," "),t=xe(t,"_"," "),t=Oe(t),xe(t," ","")}(t),t.charAt(0).toLowerCase()+t.slice(1)}(e);const n={element:"button",toggle:!1,label:null,icon:null,labelPressed:null,iconPressed:null};switch(["element","icon","label"].forEach((e=>{Object.keys(i).includes(e)&&(n[e]=i[e],delete i[e])})),"button"!==n.element||Object.keys(i).includes("type")||(i.type="button"),Object.keys(i).includes("class")?i.class.split(" ").some((e=>e===this.config.classNames.control))||V(i,{class:`${i.class} ${this.config.classNames.control}`}):i.class=this.config.classNames.control,e){case"play":n.toggle=!0,n.label="play",n.labelPressed="pause",n.icon="play",n.iconPressed="pause";break;case"mute":n.toggle=!0,n.label="mute",n.labelPressed="unmute",n.icon="volume",n.iconPressed="muted";break;case"captions":n.toggle=!0,n.label="enableCaptions",n.labelPressed="disableCaptions",n.icon="captions-off",n.iconPressed="captions-on";break;case"fullscreen":n.toggle=!0,n.label="enterFullscreen",n.labelPressed="exitFullscreen",n.icon="enter-fullscreen",n.iconPressed="exit-fullscreen";break;case"play-large":i.class+=` ${this.config.classNames.control}--overlaid`,r="play",n.label="play",n.icon="play";break;default:H(n.label)&&(n.label=r),H(n.icon)&&(n.icon=e)}const a=X(n.element);return n.toggle?(a.appendChild($e.createIcon.call(this,n.iconPressed,{class:"icon--pressed"})),a.appendChild($e.createIcon.call(this,n.icon,{class:"icon--not-pressed"})),a.appendChild($e.createLabel.call(this,n.labelPressed,{class:"label--pressed"})),a.appendChild($e.createLabel.call(this,n.label,{class:"label--not-pressed"}))):(a.appendChild($e.createIcon.call(this,n.icon)),a.appendChild($e.createLabel.call(this,n.label))),V(i,te(this.config.selectors.buttons[r],i)),z(a,i),"play"===r?(M(this.elements.buttons[r])||(this.elements.buttons[r]=[]),this.elements.buttons[r].push(a)):this.elements.buttons[r]=a,a},createRange(e,t){const i=X("input",V(te(this.config.selectors.inputs[e]),{type:"range",min:0,max:100,step:.01,value:0,autocomplete:"off",role:"slider","aria-label":Me.get(e,this.config),"aria-valuemin":0,"aria-valuemax":100,"aria-valuenow":0},t));return this.elements.inputs[e]=i,$e.updateRangeFill.call(this,i),b.setup(i),i},createProgress(e,t){const i=X("progress",V(te(this.config.selectors.display[e]),{min:0,max:100,value:0,role:"progressbar","aria-hidden":!0},t));if("volume"!==e){i.appendChild(X("span",null,"0"));const t={played:"played",buffer:"buffered"}[e],r=t?Me.get(t,this.config):"";i.innerText=`% ${r.toLowerCase()}`}return this.elements.display[e]=i,i},createTime(e,t){const i=te(this.config.selectors.display[e],t),r=X("div",V(i,{class:`${i.class?i.class:""} ${this.config.classNames.display.time} `.trim(),"aria-label":Me.get(e,this.config),role:"timer"}),"00:00");return this.elements.display[e]=r,r},bindMenuItemShortcuts(e,t){fe.call(this,e,"keydown keyup",(i=>{if(![" ","ArrowUp","ArrowDown","ArrowRight"].includes(i.key))return;if(i.preventDefault(),i.stopPropagation(),"keydown"===i.type)return;const r=ae(e,'[role="menuitemradio"]');if(!r&&[" ","ArrowRight"].includes(i.key))$e.showMenuPanel.call(this,t,!0);else{let t;" "!==i.key&&("ArrowDown"===i.key||r&&"ArrowRight"===i.key?(t=e.nextElementSibling,F(t)||(t=e.parentNode.firstElementChild)):(t=e.previousElementSibling,F(t)||(t=e.parentNode.lastElementChild)),le.call(this,t,!0))}}),!1),fe.call(this,e,"keyup",(e=>{"Return"===e.key&&$e.focusFirstMenuItem.call(this,null,!0)}))},createMenuItem({value:e,list:t,type:i,title:r,badge:n=null,checked:a=!1}){const s=te(this.config.selectors.inputs[i]),o=X("button",V(s,{type:"button",role:"menuitemradio",class:`${this.config.classNames.control} ${s.class?s.class:""}`.trim(),"aria-checked":a,value:e})),l=X("span");l.innerHTML=r,F(n)&&l.appendChild(n),o.appendChild(l),Object.defineProperty(o,"checked",{enumerable:!0,get:()=>"true"===o.getAttribute("aria-checked"),set(e){e&&Array.from(o.parentNode.children).filter((e=>ae(e,'[role="menuitemradio"]'))).forEach((e=>e.setAttribute("aria-checked","false"))),o.setAttribute("aria-checked",e?"true":"false")}}),this.listeners.bind(o,"click keyup",(t=>{if(!B(t)||" "===t.key){switch(t.preventDefault(),t.stopPropagation(),o.checked=!0,i){case"language":this.currentTrack=Number(e);break;case"quality":this.quality=e;break;case"speed":this.speed=parseFloat(e)}$e.showMenuPanel.call(this,"home",B(t))}}),i,!1),$e.bindMenuItemShortcuts.call(this,o,i),t.appendChild(o)},formatTime(e=0,t=!1){return x(e)?je(e,Be(this.duration)>0,t):e},updateTimeDisplay(e=null,t=0,i=!1){F(e)&&x(t)&&(e.innerText=$e.formatTime(t,i))},updateVolume(){this.supported.ui&&(F(this.elements.inputs.volume)&&$e.setRange.call(this,this.elements.inputs.volume,this.muted?0:this.volume),F(this.elements.buttons.mute)&&(this.elements.buttons.mute.pressed=this.muted||0===this.volume))},setRange(e,t=0){F(e)&&(e.value=t,$e.updateRangeFill.call(this,e))},updateProgress(e){if(!this.supported.ui||!U(e))return;let t=0;const i=(e,t)=>{const i=x(t)?t:0,r=F(e)?e:this.elements.display.buffer;if(F(r)){r.value=i;const e=r.getElementsByTagName("span")[0];F(e)&&(e.childNodes[0].nodeValue=i)}};if(e)switch(e.type){case"timeupdate":case"seeking":case"seeked":r=this.currentTime,n=this.duration,t=0===r||0===n||Number.isNaN(r)||Number.isNaN(n)?0:(r/n*100).toFixed(2),"timeupdate"===e.type&&$e.setRange.call(this,this.elements.inputs.seek,t);break;case"playing":case"progress":i(this.elements.display.buffer,100*this.buffered)}var r,n},updateRangeFill(e){const t=U(e)?e.target:e;if(F(t)&&"range"===t.getAttribute("type")){if(ae(t,this.config.selectors.inputs.seek)){t.setAttribute("aria-valuenow",this.currentTime);const e=$e.formatTime(this.currentTime),i=$e.formatTime(this.duration),r=Me.get("seekLabel",this.config);t.setAttribute("aria-valuetext",r.replace("{currentTime}",e).replace("{duration}",i))}else if(ae(t,this.config.selectors.inputs.volume)){const e=100*t.value;t.setAttribute("aria-valuenow",e),t.setAttribute("aria-valuetext",`${e.toFixed(1)}%`)}else t.setAttribute("aria-valuenow",t.value);(K.isWebKit||K.isIPadOS)&&t.style.setProperty("--value",t.value/t.max*100+"%")}},updateSeekTooltip(e){var t,i;if(!this.config.tooltips.seek||!F(this.elements.inputs.seek)||!F(this.elements.display.seekTooltip)||0===this.duration)return;const r=this.elements.display.seekTooltip,n=`${this.config.classNames.tooltip}--visible`,a=e=>re(r,n,e);if(this.touch)return void a(!1);let s=0;const o=this.elements.progress.getBoundingClientRect();if(U(e))s=100/o.width*(e.pageX-o.left);else{if(!ne(r,n))return;s=parseFloat(r.style.left,10)}s<0?s=0:s>100&&(s=100);const l=this.duration/100*s;r.innerText=$e.formatTime(l);const d=null===(t=this.config.markers)||void 0===t||null===(i=t.points)||void 0===i?void 0:i.find((({time:e})=>e===Math.round(l)));d&&r.insertAdjacentHTML("afterbegin",`${d.label}<br>`),r.style.left=`${s}%`,U(e)&&["mouseenter","mouseleave"].includes(e.type)&&a("mouseenter"===e.type)},timeUpdate(e){const t=!F(this.elements.display.duration)&&this.config.invertTime;$e.updateTimeDisplay.call(this,this.elements.display.currentTime,t?this.duration-this.currentTime:this.currentTime,t),e&&"timeupdate"===e.type&&this.media.seeking||$e.updateProgress.call(this,e)},durationUpdate(){if(!this.supported.ui||!this.config.invertTime&&this.currentTime)return;if(this.duration>=2**32)return ie(this.elements.display.currentTime,!0),void ie(this.elements.progress,!0);F(this.elements.inputs.seek)&&this.elements.inputs.seek.setAttribute("aria-valuemax",this.duration);const e=F(this.elements.display.duration);!e&&this.config.displayDuration&&this.paused&&$e.updateTimeDisplay.call(this,this.elements.display.currentTime,this.duration),e&&$e.updateTimeDisplay.call(this,this.elements.display.duration,this.duration),this.config.markers.enabled&&$e.setMarkers.call(this),$e.updateSeekTooltip.call(this)},toggleMenuButton(e,t){ie(this.elements.settings.buttons[e],!t)},updateSetting(e,t,i){const r=this.elements.settings.panels[e];let n=null,a=t;if("captions"===e)n=this.currentTrack;else{if(n=H(i)?this[e]:i,H(n)&&(n=this.config[e].default),!H(this.options[e])&&!this.options[e].includes(n))return void this.debug.warn(`Unsupported value of '${n}' for ${e}`);if(!this.config[e].options.includes(n))return void this.debug.warn(`Disabled value of '${n}' for ${e}`)}if(F(a)||(a=r&&r.querySelector('[role="menu"]')),!F(a))return;this.elements.settings.buttons[e].querySelector(`.${this.config.classNames.menu.value}`).innerHTML=$e.getLabel.call(this,e,n);const s=a&&a.querySelector(`[value="${n}"]`);F(s)&&(s.checked=!0)},getLabel(e,t){switch(e){case"speed":return 1===t?Me.get("normal",this.config):`${t}&times;`;case"quality":if(x(t)){const e=Me.get(`qualityLabel.${t}`,this.config);return e.length?e:`${t}p`}return Oe(t);case"captions":return qe.getLabel.call(this);default:return null}},setQualityMenu(e){if(!F(this.elements.settings.panels.quality))return;const t="quality",i=this.elements.settings.panels.quality.querySelector('[role="menu"]');M(e)&&(this.options.quality=we(e).filter((e=>this.config.quality.options.includes(e))));const r=!H(this.options.quality)&&this.options.quality.length>1;if($e.toggleMenuButton.call(this,t,r),Z(i),$e.checkMenu.call(this),!r)return;const n=e=>{const t=Me.get(`qualityBadge.${e}`,this.config);return t.length?$e.createBadge.call(this,t):null};this.options.quality.sort(((e,t)=>{const i=this.config.quality.options;return i.indexOf(e)>i.indexOf(t)?1:-1})).forEach((e=>{$e.createMenuItem.call(this,{value:e,list:i,type:t,title:$e.getLabel.call(this,"quality",e),badge:n(e)})})),$e.updateSetting.call(this,t,i)},setCaptionsMenu(){if(!F(this.elements.settings.panels.captions))return;const e="captions",t=this.elements.settings.panels.captions.querySelector('[role="menu"]'),i=qe.getTracks.call(this),r=Boolean(i.length);if($e.toggleMenuButton.call(this,e,r),Z(t),$e.checkMenu.call(this),!r)return;const n=i.map(((e,i)=>({value:i,checked:this.captions.toggled&&this.currentTrack===i,title:qe.getLabel.call(this,e),badge:e.language&&$e.createBadge.call(this,e.language.toUpperCase()),list:t,type:"language"})));n.unshift({value:-1,checked:!this.captions.toggled,title:Me.get("disabled",this.config),list:t,type:"language"}),n.forEach($e.createMenuItem.bind(this)),$e.updateSetting.call(this,e,t)},setSpeedMenu(){if(!F(this.elements.settings.panels.speed))return;const e="speed",t=this.elements.settings.panels.speed.querySelector('[role="menu"]');this.options.speed=this.options.speed.filter((e=>e>=this.minimumSpeed&&e<=this.maximumSpeed));const i=!H(this.options.speed)&&this.options.speed.length>1;$e.toggleMenuButton.call(this,e,i),Z(t),$e.checkMenu.call(this),i&&(this.options.speed.forEach((i=>{$e.createMenuItem.call(this,{value:i,list:t,type:e,title:$e.getLabel.call(this,"speed",i)})})),$e.updateSetting.call(this,e,t))},checkMenu(){const{buttons:e}=this.elements.settings,t=!H(e)&&Object.values(e).some((e=>!e.hidden));ie(this.elements.settings.menu,!t)},focusFirstMenuItem(e,t=!1){if(this.elements.settings.popup.hidden)return;let i=e;F(i)||(i=Object.values(this.elements.settings.panels).find((e=>!e.hidden)));const r=i.querySelector('[role^="menuitem"]');le.call(this,r,t)},toggleMenu(e){const{popup:t}=this.elements.settings,i=this.elements.buttons.settings;if(!F(t)||!F(i))return;const{hidden:r}=t;let n=r;if(P(e))n=e;else if(B(e)&&"Escape"===e.key)n=!1;else if(U(e)){const r=I(e.composedPath)?e.composedPath()[0]:e.target,a=t.contains(r);if(a||!a&&e.target!==i&&n)return}i.setAttribute("aria-expanded",n),ie(t,!n),re(this.elements.container,this.config.classNames.menu.open,n),n&&B(e)?$e.focusFirstMenuItem.call(this,null,!0):n||r||le.call(this,i,B(e))},getMenuSize(e){const t=e.cloneNode(!0);t.style.position="absolute",t.style.opacity=0,t.removeAttribute("hidden"),e.parentNode.appendChild(t);const i=t.scrollWidth,r=t.scrollHeight;return J(t),{width:i,height:r}},showMenuPanel(e="",t=!1){const i=this.elements.container.querySelector(`#plyr-settings-${this.id}-${e}`);if(!F(i))return;const r=i.parentNode,n=Array.from(r.children).find((e=>!e.hidden));if(ue.transitions&&!ue.reducedMotion){r.style.width=`${n.scrollWidth}px`,r.style.height=`${n.scrollHeight}px`;const e=$e.getMenuSize.call(this,i),t=e=>{e.target===r&&["width","height"].includes(e.propertyName)&&(r.style.width="",r.style.height="",pe.call(this,r,G,t))};fe.call(this,r,G,t),r.style.width=`${e.width}px`,r.style.height=`${e.height}px`}ie(n,!0),ie(i,!1),$e.focusFirstMenuItem.call(this,i,t)},setDownloadUrl(){const e=this.elements.buttons.download;F(e)&&e.setAttribute("href",this.download)},create(e){const{bindMenuItemShortcuts:t,createButton:i,createProgress:r,createRange:n,createTime:a,setQualityMenu:s,setSpeedMenu:o,showMenuPanel:l}=$e;this.elements.controls=null,M(this.config.controls)&&this.config.controls.includes("play-large")&&this.elements.container.appendChild(i.call(this,"play-large"));const d=X("div",te(this.config.selectors.controls.wrapper));this.elements.controls=d;const u={class:"plyr__controls__item"};return we(M(this.config.controls)?this.config.controls:[]).forEach((s=>{if("restart"===s&&d.appendChild(i.call(this,"restart",u)),"rewind"===s&&d.appendChild(i.call(this,"rewind",u)),"play"===s&&d.appendChild(i.call(this,"play",u)),"fast-forward"===s&&d.appendChild(i.call(this,"fast-forward",u)),"progress"===s){const t=X("div",{class:`${u.class} plyr__progress__container`}),i=X("div",te(this.config.selectors.progress));if(i.appendChild(n.call(this,"seek",{id:`plyr-seek-${e.id}`})),i.appendChild(r.call(this,"buffer")),this.config.tooltips.seek){const e=X("span",{class:this.config.classNames.tooltip},"00:00");i.appendChild(e),this.elements.display.seekTooltip=e}this.elements.progress=i,t.appendChild(this.elements.progress),d.appendChild(t)}if("current-time"===s&&d.appendChild(a.call(this,"currentTime",u)),"duration"===s&&d.appendChild(a.call(this,"duration",u)),"mute"===s||"volume"===s){let{volume:t}=this.elements;if(F(t)&&d.contains(t)||(t=X("div",V({},u,{class:`${u.class} plyr__volume`.trim()})),this.elements.volume=t,d.appendChild(t)),"mute"===s&&t.appendChild(i.call(this,"mute")),"volume"===s&&!K.isIos&&!K.isIPadOS){const i={max:1,step:.05,value:this.config.volume};t.appendChild(n.call(this,"volume",V(i,{id:`plyr-volume-${e.id}`})))}}if("captions"===s&&d.appendChild(i.call(this,"captions",u)),"settings"===s&&!H(this.config.settings)){const r=X("div",V({},u,{class:`${u.class} plyr__menu`.trim(),hidden:""}));r.appendChild(i.call(this,"settings",{"aria-haspopup":!0,"aria-controls":`plyr-settings-${e.id}`,"aria-expanded":!1}));const n=X("div",{class:"plyr__menu__container",id:`plyr-settings-${e.id}`,hidden:""}),a=X("div"),s=X("div",{id:`plyr-settings-${e.id}-home`}),o=X("div",{role:"menu"});s.appendChild(o),a.appendChild(s),this.elements.settings.panels.home=s,this.config.settings.forEach((i=>{const r=X("button",V(te(this.config.selectors.buttons.settings),{type:"button",class:`${this.config.classNames.control} ${this.config.classNames.control}--forward`,role:"menuitem","aria-haspopup":!0,hidden:""}));t.call(this,r,i),fe.call(this,r,"click",(()=>{l.call(this,i,!1)}));const n=X("span",null,Me.get(i,this.config)),s=X("span",{class:this.config.classNames.menu.value});s.innerHTML=e[i],n.appendChild(s),r.appendChild(n),o.appendChild(r);const d=X("div",{id:`plyr-settings-${e.id}-${i}`,hidden:""}),u=X("button",{type:"button",class:`${this.config.classNames.control} ${this.config.classNames.control}--back`});u.appendChild(X("span",{"aria-hidden":!0},Me.get(i,this.config))),u.appendChild(X("span",{class:this.config.classNames.hidden},Me.get("menuBack",this.config))),fe.call(this,d,"keydown",(e=>{"ArrowLeft"===e.key&&(e.preventDefault(),e.stopPropagation(),l.call(this,"home",!0))}),!1),fe.call(this,u,"click",(()=>{l.call(this,"home",!1)})),d.appendChild(u),d.appendChild(X("div",{role:"menu"})),a.appendChild(d),this.elements.settings.buttons[i]=r,this.elements.settings.panels[i]=d})),n.appendChild(a),r.appendChild(n),d.appendChild(r),this.elements.settings.popup=n,this.elements.settings.menu=r}if("pip"===s&&ue.pip&&d.appendChild(i.call(this,"pip",u)),"airplay"===s&&ue.airplay&&d.appendChild(i.call(this,"airplay",u)),"download"===s){const e=V({},u,{element:"a",href:this.download,target:"_blank"});this.isHTML5&&(e.download="");const{download:t}=this.config.urls;!$(t)&&this.isEmbed&&V(e,{icon:`logo-${this.provider}`,label:this.provider}),d.appendChild(i.call(this,"download",e))}"fullscreen"===s&&d.appendChild(i.call(this,"fullscreen",u))})),this.isHTML5&&s.call(this,Le.getQualityOptions.call(this)),o.call(this),d},inject(){if(this.config.loadSprite){const e=$e.getIconUrl.call(this);e.cors&&Ue(e.url,"sprite-plyr")}this.id=Math.floor(1e4*Math.random());let e=null;this.elements.controls=null;const t={id:this.id,seektime:this.config.seekTime,title:this.config.title};let i,r=!0;if(I(this.config.controls)&&(this.config.controls=this.config.controls.call(this,t)),this.config.controls||(this.config.controls=[]),F(this.config.controls)||O(this.config.controls)?e=this.config.controls:(e=$e.create.call(this,{id:this.id,seektime:this.config.seekTime,speed:this.speed,quality:this.quality,captions:qe.getLabel.call(this)}),r=!1),r&&O(this.config.controls)&&(e=(e=>{let i=e;return Object.entries(t).forEach((([e,t])=>{i=xe(i,`{${e}}`,t)})),i})(e)),O(this.config.selectors.controls.container)&&(i=document.querySelector(this.config.selectors.controls.container)),F(i)||(i=this.elements.container),i[F(e)?"insertAdjacentElement":"insertAdjacentHTML"]("afterbegin",e),F(this.elements.controls)||$e.findElements.call(this),!H(this.elements.buttons)){const e=e=>{const t=this.config.classNames.controlPressed;e.setAttribute("aria-pressed","false"),Object.defineProperty(e,"pressed",{configurable:!0,enumerable:!0,get:()=>ne(e,t),set(i=!1){re(e,t,i),e.setAttribute("aria-pressed",i?"true":"false")}})};Object.values(this.elements.buttons).filter(Boolean).forEach((t=>{M(t)||N(t)?Array.from(t).filter(Boolean).forEach(e):e(t)}))}if(K.isEdge&&q(i),this.config.tooltips.controls){const{classNames:e,selectors:t}=this.config,i=`${t.controls.wrapper} ${t.labels} .${e.hidden}`,r=se.call(this,i);Array.from(r).forEach((e=>{re(e,this.config.classNames.hidden,!1),re(e,this.config.classNames.tooltip,!0)}))}},setMediaMetadata(){try{"mediaSession"in navigator&&(navigator.mediaSession.metadata=new window.MediaMetadata({title:this.config.mediaMetadata.title,artist:this.config.mediaMetadata.artist,album:this.config.mediaMetadata.album,artwork:this.config.mediaMetadata.artwork}))}catch(e){}},setMarkers(){var e,t;if(!this.duration||this.elements.markers)return;const i=null===(e=this.config.markers)||void 0===e||null===(t=e.points)||void 0===t?void 0:t.filter((({time:e})=>e>0&&e<this.duration));if(null==i||!i.length)return;const r=document.createDocumentFragment(),n=document.createDocumentFragment();let a=null;const s=`${this.config.classNames.tooltip}--visible`,o=e=>re(a,s,e);i.forEach((e=>{const t=X("span",{class:this.config.classNames.marker},""),i=e.time/this.duration*100+"%";a&&(t.addEventListener("mouseenter",(()=>{e.label||(a.style.left=i,a.innerHTML=e.label,o(!0))})),t.addEventListener("mouseleave",(()=>{o(!1)}))),t.addEventListener("click",(()=>{this.currentTime=e.time})),t.style.left=i,n.appendChild(t)})),r.appendChild(n),this.config.tooltips.seek||(a=X("span",{class:this.config.classNames.tooltip},""),r.appendChild(a)),this.elements.markers={points:n,tip:a},this.elements.progress.appendChild(r)}};function He(e,t=!0){let i=e;if(t){const e=document.createElement("a");e.href=i,i=e.href}try{return new URL(i)}catch(e){return null}}function Ge(e){const t=new URLSearchParams;return D(e)&&Object.entries(e).forEach((([e,i])=>{t.set(e,i)})),t}const qe={setup(){if(!this.supported.ui)return;if(this.isYouTube||this.isHTML5&&!ue.textTracks)return void(M(this.config.controls)&&this.config.controls.includes("settings")&&this.config.settings.includes("captions")&&$e.setCaptionsMenu.call(this));var e,t;if(F(this.elements.captions)||(this.elements.captions=X("div",te(this.config.selectors.captions)),this.elements.captions.setAttribute("dir","auto"),e=this.elements.captions,t=this.elements.wrapper?this.elements.wrapper:this.elements.controls,F(e)&&F(t)&&t.parentNode.insertBefore(e,t.nextSibling)),K.isIE&&window.URL){const e=this.media.querySelectorAll("track");Array.from(e).forEach((e=>{const t=e.getAttribute("src"),i=He(t);null!==i&&i.hostname!==window.location.href.hostname&&["http:","https:"].includes(i.protocol)&&Fe(t,"blob").then((t=>{e.setAttribute("src",window.URL.createObjectURL(t))})).catch((()=>{J(e)}))}))}const i=we((navigator.languages||[navigator.language||navigator.userLanguage||"en"]).map((e=>e.split("-")[0])));let r=(this.storage.get("language")||this.config.captions.language||"auto").toLowerCase();"auto"===r&&([r]=i);let n=this.storage.get("captions");if(P(n)||({active:n}=this.config.captions),Object.assign(this.captions,{toggled:!1,active:n,language:r,languages:i}),this.isHTML5){const e=this.config.captions.update?"addtrack removetrack":"removetrack";fe.call(this,this.media.textTracks,e,qe.update.bind(this))}setTimeout(qe.update.bind(this),0)},update(){const e=qe.getTracks.call(this,!0),{active:t,language:i,meta:r,currentTrackNode:n}=this.captions,a=Boolean(e.find((e=>e.language===i)));this.isHTML5&&e.filter((e=>!r.get(e))).forEach((e=>{this.debug.log("Track added",e),r.set(e,{default:"showing"===e.mode}),"showing"===e.mode&&(e.mode="hidden"),fe.call(this,e,"cuechange",(()=>qe.updateCues.call(this)))})),(a&&this.language!==i||!e.includes(n))&&(qe.setLanguage.call(this,i),qe.toggle.call(this,t&&a)),this.elements&&re(this.elements.container,this.config.classNames.captions.enabled,!H(e)),M(this.config.controls)&&this.config.controls.includes("settings")&&this.config.settings.includes("captions")&&$e.setCaptionsMenu.call(this)},toggle(e,t=!0){if(!this.supported.ui)return;const{toggled:i}=this.captions,r=this.config.classNames.captions.active,n=L(e)?!i:e;if(n!==i){if(t||(this.captions.active=n,this.storage.set({captions:n})),!this.language&&n&&!t){const e=qe.getTracks.call(this),t=qe.findTrack.call(this,[this.captions.language,...this.captions.languages],!0);return this.captions.language=t.language,void qe.set.call(this,e.indexOf(t))}this.elements.buttons.captions&&(this.elements.buttons.captions.pressed=n),re(this.elements.container,r,n),this.captions.toggled=n,$e.updateSetting.call(this,"captions"),ge.call(this,this.media,n?"captionsenabled":"captionsdisabled")}setTimeout((()=>{n&&this.captions.toggled&&(this.captions.currentTrackNode.mode="hidden")}))},set(e,t=!0){const i=qe.getTracks.call(this);if(-1!==e)if(x(e))if(e in i){if(this.captions.currentTrack!==e){this.captions.currentTrack=e;const r=i[e],{language:n}=r||{};this.captions.currentTrackNode=r,$e.updateSetting.call(this,"captions"),t||(this.captions.language=n,this.storage.set({language:n})),this.isVimeo&&this.embed.enableTextTrack(n),ge.call(this,this.media,"languagechange")}qe.toggle.call(this,!0,t),this.isHTML5&&qe.updateCues.call(this)}else this.debug.warn("Track not found",e);else this.debug.warn("Invalid caption argument",e);else qe.toggle.call(this,!1,t)},setLanguage(e,t=!0){if(!O(e))return void this.debug.warn("Invalid language argument",e);const i=e.toLowerCase();this.captions.language=i;const r=qe.getTracks.call(this),n=qe.findTrack.call(this,[i]);qe.set.call(this,r.indexOf(n),t)},getTracks(e=!1){return Array.from((this.media||{}).textTracks||[]).filter((t=>!this.isHTML5||e||this.captions.meta.has(t))).filter((e=>["captions","subtitles"].includes(e.kind)))},findTrack(e,t=!1){const i=qe.getTracks.call(this),r=e=>Number((this.captions.meta.get(e)||{}).default),n=Array.from(i).sort(((e,t)=>r(t)-r(e)));let a;return e.every((e=>(a=n.find((t=>t.language===e)),!a))),a||(t?n[0]:void 0)},getCurrentTrack(){return qe.getTracks.call(this)[this.currentTrack]},getLabel(e){let t=e;return!j(t)&&ue.textTracks&&this.captions.toggled&&(t=qe.getCurrentTrack.call(this)),j(t)?H(t.label)?H(t.language)?Me.get("enabled",this.config):e.language.toUpperCase():t.label:Me.get("disabled",this.config)},updateCues(e){if(!this.supported.ui)return;if(!F(this.elements.captions))return void this.debug.warn("No captions element to render to");if(!L(e)&&!Array.isArray(e))return void this.debug.warn("updateCues: Invalid input",e);let t=e;if(!t){const e=qe.getCurrentTrack.call(this);t=Array.from((e||{}).activeCues||[]).map((e=>e.getCueAsHTML())).map(Pe)}const i=t.map((e=>e.trim())).join("\n");if(i!==this.elements.captions.innerHTML){Z(this.elements.captions);const e=X("span",te(this.config.selectors.caption));e.innerHTML=i,this.elements.captions.appendChild(e),ge.call(this,this.media,"cuechange")}}},Ke={enabled:!0,title:"",debug:!1,autoplay:!1,autopause:!0,playsinline:!0,seekTime:10,volume:1,muted:!1,duration:null,displayDuration:!0,invertTime:!0,toggleInvert:!0,ratio:null,clickToPlay:!0,hideControls:!0,resetOnEnd:!1,disableContextMenu:!0,loadSprite:!0,iconPrefix:"plyr",iconUrl:"https://cdn.plyr.io/3.7.8/plyr.svg",blankVideo:"https://cdn.plyr.io/static/blank.mp4",quality:{default:576,options:[4320,2880,2160,1440,1080,720,576,480,360,240],forced:!1,onChange:null},loop:{active:!1},speed:{selected:1,options:[.5,.75,1,1.25,1.5,1.75,2,4]},keyboard:{focused:!0,global:!1},tooltips:{controls:!1,seek:!0},captions:{active:!1,language:"auto",update:!1},fullscreen:{enabled:!0,fallback:!0,iosNative:!1},storage:{enabled:!0,key:"plyr"},controls:["play-large","play","progress","current-time","mute","volume","captions","settings","pip","airplay","fullscreen"],settings:["captions","quality","speed"],i18n:{restart:"Restart",rewind:"Rewind {seektime}s",play:"Play",pause:"Pause",fastForward:"Forward {seektime}s",seek:"Seek",seekLabel:"{currentTime} of {duration}",played:"Played",buffered:"Buffered",currentTime:"Current time",duration:"Duration",volume:"Volume",mute:"Mute",unmute:"Unmute",enableCaptions:"Enable captions",disableCaptions:"Disable captions",download:"Download",enterFullscreen:"Enter fullscreen",exitFullscreen:"Exit fullscreen",frameTitle:"Player for {title}",captions:"Captions",settings:"Settings",pip:"PIP",menuBack:"Go back to previous menu",speed:"Speed",normal:"Normal",quality:"Quality",loop:"Loop",start:"Start",end:"End",all:"All",reset:"Reset",disabled:"Disabled",enabled:"Enabled",advertisement:"Ad",qualityBadge:{2160:"4K",1440:"HD",1080:"HD",720:"HD",576:"SD",480:"SD"}},urls:{download:null,vimeo:{sdk:"https://player.vimeo.com/api/player.js",iframe:"https://player.vimeo.com/video/{0}?{1}",api:"https://vimeo.com/api/oembed.json?url={0}"},youtube:{sdk:"https://www.youtube.com/iframe_api",api:"https://noembed.com/embed?url=https://www.youtube.com/watch?v={0}"},googleIMA:{sdk:"https://imasdk.googleapis.com/js/sdkloader/ima3.js"}},listeners:{seek:null,play:null,pause:null,restart:null,rewind:null,fastForward:null,mute:null,volume:null,captions:null,download:null,fullscreen:null,pip:null,airplay:null,speed:null,quality:null,loop:null,language:null},events:["ended","progress","stalled","playing","waiting","canplay","canplaythrough","loadstart","loadeddata","loadedmetadata","timeupdate","volumechange","play","pause","error","seeking","seeked","emptied","ratechange","cuechange","download","enterfullscreen","exitfullscreen","captionsenabled","captionsdisabled","languagechange","controlshidden","controlsshown","ready","statechange","qualitychange","adsloaded","adscontentpause","adscontentresume","adstarted","adsmidpoint","adscomplete","adsallcomplete","adsimpression","adsclick"],selectors:{editable:"input, textarea, select, [contenteditable]",container:".plyr",controls:{container:null,wrapper:".plyr__controls"},labels:"[data-plyr]",buttons:{play:'[data-plyr="play"]',pause:'[data-plyr="pause"]',restart:'[data-plyr="restart"]',rewind:'[data-plyr="rewind"]',fastForward:'[data-plyr="fast-forward"]',mute:'[data-plyr="mute"]',captions:'[data-plyr="captions"]',download:'[data-plyr="download"]',fullscreen:'[data-plyr="fullscreen"]',pip:'[data-plyr="pip"]',airplay:'[data-plyr="airplay"]',settings:'[data-plyr="settings"]',loop:'[data-plyr="loop"]'},inputs:{seek:'[data-plyr="seek"]',volume:'[data-plyr="volume"]',speed:'[data-plyr="speed"]',language:'[data-plyr="language"]',quality:'[data-plyr="quality"]'},display:{currentTime:".plyr__time--current",duration:".plyr__time--duration",buffer:".plyr__progress__buffer",loop:".plyr__progress__loop",volume:".plyr__volume--display"},progress:".plyr__progress",captions:".plyr__captions",caption:".plyr__caption"},classNames:{type:"plyr--{0}",provider:"plyr--{0}",video:"plyr__video-wrapper",embed:"plyr__video-embed",videoFixedRatio:"plyr__video-wrapper--fixed-ratio",embedContainer:"plyr__video-embed__container",poster:"plyr__poster",posterEnabled:"plyr__poster-enabled",ads:"plyr__ads",control:"plyr__control",controlPressed:"plyr__control--pressed",playing:"plyr--playing",paused:"plyr--paused",stopped:"plyr--stopped",loading:"plyr--loading",hover:"plyr--hover",tooltip:"plyr__tooltip",cues:"plyr__cues",marker:"plyr__progress__marker",hidden:"plyr__sr-only",hideControls:"plyr--hide-controls",isTouch:"plyr--is-touch",uiSupported:"plyr--full-ui",noTransition:"plyr--no-transition",display:{time:"plyr__time"},menu:{value:"plyr__menu__value",badge:"plyr__badge",open:"plyr--menu-open"},captions:{enabled:"plyr--captions-enabled",active:"plyr--captions-active"},fullscreen:{enabled:"plyr--fullscreen-enabled",fallback:"plyr--fullscreen-fallback"},pip:{supported:"plyr--pip-supported",active:"plyr--pip-active"},airplay:{supported:"plyr--airplay-supported",active:"plyr--airplay-active"},previewThumbnails:{thumbContainer:"plyr__preview-thumb",thumbContainerShown:"plyr__preview-thumb--is-shown",imageContainer:"plyr__preview-thumb__image-container",timeContainer:"plyr__preview-thumb__time-container",scrubbingContainer:"plyr__preview-scrubbing",scrubbingContainerShown:"plyr__preview-scrubbing--is-shown"}},attributes:{embed:{provider:"data-plyr-provider",id:"data-plyr-embed-id",hash:"data-plyr-embed-hash"}},ads:{enabled:!1,publisherId:"",tagUrl:""},previewThumbnails:{enabled:!1,src:""},vimeo:{byline:!1,portrait:!1,title:!1,speed:!0,transparent:!1,customControls:!0,referrerPolicy:null,premium:!1},youtube:{rel:0,showinfo:0,iv_load_policy:3,modestbranding:1,customControls:!0,noCookie:!1},mediaMetadata:{title:"",artist:"",album:"",artwork:[]},markers:{enabled:!1,points:[]}},We="picture-in-picture",Ve={html5:"html5",youtube:"youtube",vimeo:"vimeo"},Ye="video",ze=()=>{};class Xe{constructor(e=!1){this.enabled=window.console&&e,this.enabled&&this.log("Debugging enabled")}get log(){return this.enabled?Function.prototype.bind.call(console.log,console):ze}get warn(){return this.enabled?Function.prototype.bind.call(console.warn,console):ze}get error(){return this.enabled?Function.prototype.bind.call(console.error,console):ze}}class Qe{constructor(e){t(this,"onChange",(()=>{if(!this.supported)return;const e=this.player.elements.buttons.fullscreen;F(e)&&(e.pressed=this.active);const t=this.target===this.player.media?this.target:this.player.elements.container;ge.call(this.player,t,this.active?"enterfullscreen":"exitfullscreen",!0)})),t(this,"toggleFallback",((e=!1)=>{if(e?this.scrollPosition={x:window.scrollX??0,y:window.scrollY??0}:window.scrollTo(this.scrollPosition.x,this.scrollPosition.y),document.body.style.overflow=e?"hidden":"",re(this.target,this.player.config.classNames.fullscreen.fallback,e),K.isIos){let t=document.head.querySelector('meta[name="viewport"]');const i="viewport-fit=cover";t||(t=document.createElement("meta"),t.setAttribute("name","viewport"));const r=O(t.content)&&t.content.includes(i);e?(this.cleanupViewport=!r,r||(t.content+=`,${i}`)):this.cleanupViewport&&(t.content=t.content.split(",").filter((e=>e.trim()!==i)).join(","))}this.onChange()})),t(this,"trapFocus",(e=>{if(K.isIos||K.isIPadOS||!this.active||"Tab"!==e.key)return;const t=document.activeElement,i=se.call(this.player,"a[href], button:not(:disabled), input:not(:disabled), [tabindex]"),[r]=i,n=i[i.length-1];t!==n||e.shiftKey?t===r&&e.shiftKey&&(n.focus(),e.preventDefault()):(r.focus(),e.preventDefault())})),t(this,"update",(()=>{if(this.supported){let e;e=this.forceFallback?"Fallback (forced)":Qe.nativeSupported?"Native":"Fallback",this.player.debug.log(`${e} fullscreen enabled`)}else this.player.debug.log("Fullscreen not supported and fallback disabled");re(this.player.elements.container,this.player.config.classNames.fullscreen.enabled,this.supported)})),t(this,"enter",(()=>{this.supported&&(K.isIos&&this.player.config.fullscreen.iosNative?this.player.isVimeo?this.player.embed.requestFullscreen():this.target.webkitEnterFullscreen():!Qe.nativeSupported||this.forceFallback?this.toggleFallback(!0):this.prefix?H(this.prefix)||this.target[`${this.prefix}Request${this.property}`]():this.target.requestFullscreen({navigationUI:"hide"}))})),t(this,"exit",(()=>{if(this.supported)if(K.isIos&&this.player.config.fullscreen.iosNative)this.player.isVimeo?this.player.embed.exitFullscreen():this.target.webkitEnterFullscreen(),be(this.player.play());else if(!Qe.nativeSupported||this.forceFallback)this.toggleFallback(!1);else if(this.prefix){if(!H(this.prefix)){const e="moz"===this.prefix?"Cancel":"Exit";document[`${this.prefix}${e}${this.property}`]()}}else(document.cancelFullScreen||document.exitFullscreen).call(document)})),t(this,"toggle",(()=>{this.active?this.exit():this.enter()})),this.player=e,this.prefix=Qe.prefix,this.property=Qe.property,this.scrollPosition={x:0,y:0},this.forceFallback="force"===e.config.fullscreen.fallback,this.player.elements.fullscreen=e.config.fullscreen.container&&function(e,t){const{prototype:i}=Element;return(i.closest||function(){let e=this;do{if(ae.matches(e,t))return e;e=e.parentElement||e.parentNode}while(null!==e&&1===e.nodeType);return null}).call(e,t)}(this.player.elements.container,e.config.fullscreen.container),fe.call(this.player,document,"ms"===this.prefix?"MSFullscreenChange":`${this.prefix}fullscreenchange`,(()=>{this.onChange()})),fe.call(this.player,this.player.elements.container,"dblclick",(e=>{F(this.player.elements.controls)&&this.player.elements.controls.contains(e.target)||this.player.listeners.proxy(e,this.toggle,"fullscreen")})),fe.call(this,this.player.elements.container,"keydown",(e=>this.trapFocus(e))),this.update()}static get nativeSupported(){return!!(document.fullscreenEnabled||document.webkitFullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled)}get useNative(){return Qe.nativeSupported&&!this.forceFallback}static get prefix(){if(I(document.exitFullscreen))return"";let e="";return["webkit","moz","ms"].some((t=>!(!I(document[`${t}ExitFullscreen`])&&!I(document[`${t}CancelFullScreen`])||(e=t,0)))),e}static get property(){return"moz"===this.prefix?"FullScreen":"Fullscreen"}get supported(){return[this.player.config.fullscreen.enabled,this.player.isVideo,Qe.nativeSupported||this.player.config.fullscreen.fallback,!this.player.isYouTube||Qe.nativeSupported||!K.isIos||this.player.config.playsinline&&!this.player.config.fullscreen.iosNative].every(Boolean)}get active(){if(!this.supported)return!1;if(!Qe.nativeSupported||this.forceFallback)return ne(this.target,this.player.config.classNames.fullscreen.fallback);const e=this.prefix?this.target.getRootNode()[`${this.prefix}${this.property}Element`]:this.target.getRootNode().fullscreenElement;return e&&e.shadowRoot?e===this.target.getRootNode().host:e===this.target}get target(){return K.isIos&&this.player.config.fullscreen.iosNative?this.player.media:this.player.elements.fullscreen??this.player.elements.container}}function Je(e,t=1){return new Promise(((i,r)=>{const n=new Image,a=()=>{delete n.onload,delete n.onerror,(n.naturalWidth>=t?i:r)(n)};Object.assign(n,{onload:a,onerror:a,src:e})}))}const Ze={addStyleHook(){re(this.elements.container,this.config.selectors.container.replace(".",""),!0),re(this.elements.container,this.config.classNames.uiSupported,this.supported.ui)},toggleNativeControls(e=!1){e&&this.isHTML5?this.media.setAttribute("controls",""):this.media.removeAttribute("controls")},build(){if(this.listeners.media(),!this.supported.ui)return this.debug.warn(`Basic support only for ${this.provider} ${this.type}`),void Ze.toggleNativeControls.call(this,!0);F(this.elements.controls)||($e.inject.call(this),this.listeners.controls()),Ze.toggleNativeControls.call(this),this.isHTML5&&qe.setup.call(this),this.volume=null,this.muted=null,this.loop=null,this.quality=null,this.speed=null,$e.updateVolume.call(this),$e.timeUpdate.call(this),$e.durationUpdate.call(this),Ze.checkPlaying.call(this),re(this.elements.container,this.config.classNames.pip.supported,ue.pip&&this.isHTML5&&this.isVideo),re(this.elements.container,this.config.classNames.airplay.supported,ue.airplay&&this.isHTML5),re(this.elements.container,this.config.classNames.isTouch,this.touch),this.ready=!0,setTimeout((()=>{ge.call(this,this.media,"ready")}),0),Ze.setTitle.call(this),this.poster&&Ze.setPoster.call(this,this.poster,!1).catch((()=>{})),this.config.duration&&$e.durationUpdate.call(this),this.config.mediaMetadata&&$e.setMediaMetadata.call(this)},setTitle(){let e=Me.get("play",this.config);if(O(this.config.title)&&!H(this.config.title)&&(e+=`, ${this.config.title}`),Array.from(this.elements.buttons.play||[]).forEach((t=>{t.setAttribute("aria-label",e)})),this.isEmbed){const e=oe.call(this,"iframe");if(!F(e))return;const t=H(this.config.title)?"video":this.config.title,i=Me.get("frameTitle",this.config);e.setAttribute("title",i.replace("{title}",t))}},togglePoster(e){re(this.elements.container,this.config.classNames.posterEnabled,e)},setPoster(e,t=!0){return t&&this.poster?Promise.reject(new Error("Poster already set")):(this.media.setAttribute("data-poster",e),this.elements.poster.removeAttribute("hidden"),ye.call(this).then((()=>Je(e))).catch((t=>{throw e===this.poster&&Ze.togglePoster.call(this,!1),t})).then((()=>{if(e!==this.poster)throw new Error("setPoster cancelled by later call to setPoster")})).then((()=>(Object.assign(this.elements.poster.style,{backgroundImage:`url('${e}')`,backgroundSize:""}),Ze.togglePoster.call(this,!0),e))))},checkPlaying(e){re(this.elements.container,this.config.classNames.playing,this.playing),re(this.elements.container,this.config.classNames.paused,this.paused),re(this.elements.container,this.config.classNames.stopped,this.stopped),Array.from(this.elements.buttons.play||[]).forEach((e=>{Object.assign(e,{pressed:this.playing}),e.setAttribute("aria-label",Me.get(this.playing?"pause":"play",this.config))})),U(e)&&"timeupdate"===e.type||Ze.toggleControls.call(this)},checkLoading(e){this.loading=["stalled","waiting"].includes(e.type),clearTimeout(this.timers.loading),this.timers.loading=setTimeout((()=>{re(this.elements.container,this.config.classNames.loading,this.loading),Ze.toggleControls.call(this)}),this.loading?250:0)},toggleControls(e){const{controls:t}=this.elements;if(t&&this.config.hideControls){const i=this.touch&&this.lastSeekTime+2e3>Date.now();this.toggleControls(Boolean(e||this.loading||this.paused||t.pressed||t.hover||i))}},migrateStyles(){Object.values({...this.media.style}).filter((e=>!H(e)&&O(e)&&e.startsWith("--plyr"))).forEach((e=>{this.elements.container.style.setProperty(e,this.media.style.getPropertyValue(e)),this.media.style.removeProperty(e)})),H(this.media.style)&&this.media.removeAttribute("style")}};class et{constructor(e){t(this,"firstTouch",(()=>{const{player:e}=this,{elements:t}=e;e.touch=!0,re(t.container,e.config.classNames.isTouch,!0)})),t(this,"global",((e=!0)=>{const{player:t}=this;t.config.keyboard.global&&he.call(t,window,"keydown keyup",this.handleKey,e,!1),he.call(t,document.body,"click",this.toggleMenu,e),me.call(t,document.body,"touchstart",this.firstTouch)})),t(this,"container",(()=>{const{player:e}=this,{config:t,elements:i,timers:r}=e;!t.keyboard.global&&t.keyboard.focused&&fe.call(e,i.container,"keydown keyup",this.handleKey,!1),fe.call(e,i.container,"mousemove mouseleave touchstart touchmove enterfullscreen exitfullscreen",(t=>{const{controls:n}=i;n&&"enterfullscreen"===t.type&&(n.pressed=!1,n.hover=!1);let a=0;["touchstart","touchmove","mousemove"].includes(t.type)&&(Ze.toggleControls.call(e,!0),a=e.touch?3e3:2e3),clearTimeout(r.controls),r.controls=setTimeout((()=>Ze.toggleControls.call(e,!1)),a)}));const n=()=>{if(!e.isVimeo||e.config.vimeo.premium)return;const t=i.wrapper,{active:r}=e.fullscreen,[n,a]=Ae.call(e),s=Te(`aspect-ratio: ${n} / ${a}`);if(!r)return void(s?(t.style.width=null,t.style.height=null):(t.style.maxWidth=null,t.style.margin=null));const[o,l]=[Math.max(document.documentElement.clientWidth||0,window.innerWidth||0),Math.max(document.documentElement.clientHeight||0,window.innerHeight||0)],d=o/l>n/a;s?(t.style.width=d?"auto":"100%",t.style.height=d?"100%":"auto"):(t.style.maxWidth=d?l/a*n+"px":null,t.style.margin=d?"0 auto":null)},a=()=>{clearTimeout(r.resized),r.resized=setTimeout(n,50)};fe.call(e,i.container,"enterfullscreen exitfullscreen",(t=>{const{target:r}=e.fullscreen;r===i.container&&(!e.isEmbed&&H(e.config.ratio)||(n(),("enterfullscreen"===t.type?fe:pe).call(e,window,"resize",a)))}))})),t(this,"media",(()=>{const{player:e}=this,{elements:t}=e;if(fe.call(e,e.media,"timeupdate seeking seeked",(t=>$e.timeUpdate.call(e,t))),fe.call(e,e.media,"durationchange loadeddata loadedmetadata",(t=>$e.durationUpdate.call(e,t))),fe.call(e,e.media,"ended",(()=>{e.isHTML5&&e.isVideo&&e.config.resetOnEnd&&(e.restart(),e.pause())})),fe.call(e,e.media,"progress playing seeking seeked",(t=>$e.updateProgress.call(e,t))),fe.call(e,e.media,"volumechange",(t=>$e.updateVolume.call(e,t))),fe.call(e,e.media,"playing play pause ended emptied timeupdate",(t=>Ze.checkPlaying.call(e,t))),fe.call(e,e.media,"waiting canplay seeked playing",(t=>Ze.checkLoading.call(e,t))),e.supported.ui&&e.config.clickToPlay&&!e.isAudio){const i=oe.call(e,`.${e.config.classNames.video}`);if(!F(i))return;fe.call(e,t.container,"click",(r=>{([t.container,i].includes(r.target)||i.contains(r.target))&&(e.touch&&e.config.hideControls||(e.ended?(this.proxy(r,e.restart,"restart"),this.proxy(r,(()=>{be(e.play())}),"play")):this.proxy(r,(()=>{be(e.togglePlay())}),"play")))}))}e.supported.ui&&e.config.disableContextMenu&&fe.call(e,t.wrapper,"contextmenu",(e=>{e.preventDefault()}),!1),fe.call(e,e.media,"volumechange",(()=>{e.storage.set({volume:e.volume,muted:e.muted})})),fe.call(e,e.media,"ratechange",(()=>{$e.updateSetting.call(e,"speed"),e.storage.set({speed:e.speed})})),fe.call(e,e.media,"qualitychange",(t=>{$e.updateSetting.call(e,"quality",null,t.detail.quality)})),fe.call(e,e.media,"ready qualitychange",(()=>{$e.setDownloadUrl.call(e)}));const i=e.config.events.concat(["keyup","keydown"]).join(" ");fe.call(e,e.media,i,(i=>{let{detail:r={}}=i;"error"===i.type&&(r=e.media.error),ge.call(e,t.container,i.type,!0,r)}))})),t(this,"proxy",((e,t,i)=>{const{player:r}=this,n=r.config.listeners[i];let a=!0;I(n)&&(a=n.call(r,e)),!1!==a&&I(t)&&t.call(r,e)})),t(this,"bind",((e,t,i,r,n=!0)=>{const{player:a}=this,s=a.config.listeners[r],o=I(s);fe.call(a,e,t,(e=>this.proxy(e,i,r)),n&&!o)})),t(this,"controls",(()=>{const{player:e}=this,{elements:t}=e,i=K.isIE?"change":"input";if(t.buttons.play&&Array.from(t.buttons.play).forEach((t=>{this.bind(t,"click",(()=>{be(e.togglePlay())}),"play")})),this.bind(t.buttons.restart,"click",e.restart,"restart"),this.bind(t.buttons.rewind,"click",(()=>{e.lastSeekTime=Date.now(),e.rewind()}),"rewind"),this.bind(t.buttons.fastForward,"click",(()=>{e.lastSeekTime=Date.now(),e.forward()}),"fastForward"),this.bind(t.buttons.mute,"click",(()=>{e.muted=!e.muted}),"mute"),this.bind(t.buttons.captions,"click",(()=>e.toggleCaptions())),this.bind(t.buttons.download,"click",(()=>{ge.call(e,e.media,"download")}),"download"),this.bind(t.buttons.fullscreen,"click",(()=>{e.fullscreen.toggle()}),"fullscreen"),this.bind(t.buttons.pip,"click",(()=>{e.pip="toggle"}),"pip"),this.bind(t.buttons.airplay,"click",e.airplay,"airplay"),this.bind(t.buttons.settings,"click",(t=>{t.stopPropagation(),t.preventDefault(),$e.toggleMenu.call(e,t)}),null,!1),this.bind(t.buttons.settings,"keyup",(t=>{[" ","Enter"].includes(t.key)&&("Enter"!==t.key?(t.preventDefault(),t.stopPropagation(),$e.toggleMenu.call(e,t)):$e.focusFirstMenuItem.call(e,null,!0))}),null,!1),this.bind(t.settings.menu,"keydown",(t=>{"Escape"===t.key&&$e.toggleMenu.call(e,t)})),this.bind(t.inputs.seek,"mousedown mousemove",(e=>{const i=t.progress.getBoundingClientRect(),r=100/i.width*(e.pageX-i.left);e.currentTarget.setAttribute("seek-value",r)})),this.bind(t.inputs.seek,"mousedown mouseup keydown keyup touchstart touchend",(t=>{const i=t.currentTarget,r="play-on-seeked";if(B(t)&&!["ArrowLeft","ArrowRight"].includes(t.key))return;e.lastSeekTime=Date.now();const n=i.hasAttribute(r),a=["mouseup","touchend","keyup"].includes(t.type);n&&a?(i.removeAttribute(r),be(e.play())):!a&&e.playing&&(i.setAttribute(r,""),e.pause())})),K.isIos){const t=se.call(e,'input[type="range"]');Array.from(t).forEach((e=>this.bind(e,i,(e=>q(e.target)))))}this.bind(t.inputs.seek,i,(t=>{const i=t.currentTarget;let r=i.getAttribute("seek-value");H(r)&&(r=i.value),i.removeAttribute("seek-value"),e.currentTime=r/i.max*e.duration}),"seek"),this.bind(t.progress,"mouseenter mouseleave mousemove",(t=>$e.updateSeekTooltip.call(e,t))),this.bind(t.progress,"mousemove touchmove",(t=>{const{previewThumbnails:i}=e;i&&i.loaded&&i.startMove(t)})),this.bind(t.progress,"mouseleave touchend click",(()=>{const{previewThumbnails:t}=e;t&&t.loaded&&t.endMove(!1,!0)})),this.bind(t.progress,"mousedown touchstart",(t=>{const{previewThumbnails:i}=e;i&&i.loaded&&i.startScrubbing(t)})),this.bind(t.progress,"mouseup touchend",(t=>{const{previewThumbnails:i}=e;i&&i.loaded&&i.endScrubbing(t)})),K.isWebKit&&Array.from(se.call(e,'input[type="range"]')).forEach((t=>{this.bind(t,"input",(t=>$e.updateRangeFill.call(e,t.target)))})),e.config.toggleInvert&&!F(t.display.duration)&&this.bind(t.display.currentTime,"click",(()=>{0!==e.currentTime&&(e.config.invertTime=!e.config.invertTime,$e.timeUpdate.call(e))})),this.bind(t.inputs.volume,i,(t=>{e.volume=t.target.value}),"volume"),this.bind(t.controls,"mouseenter mouseleave",(i=>{t.controls.hover=!e.touch&&"mouseenter"===i.type})),t.fullscreen&&Array.from(t.fullscreen.children).filter((e=>!e.contains(t.container))).forEach((i=>{this.bind(i,"mouseenter mouseleave",(i=>{t.controls&&(t.controls.hover=!e.touch&&"mouseenter"===i.type)}))})),this.bind(t.controls,"mousedown mouseup touchstart touchend touchcancel",(e=>{t.controls.pressed=["mousedown","touchstart"].includes(e.type)})),this.bind(t.controls,"focusin",(()=>{const{config:i,timers:r}=e;re(t.controls,i.classNames.noTransition,!0),Ze.toggleControls.call(e,!0),setTimeout((()=>{re(t.controls,i.classNames.noTransition,!1)}),0);const n=this.touch?3e3:4e3;clearTimeout(r.controls),r.controls=setTimeout((()=>Ze.toggleControls.call(e,!1)),n)})),this.bind(t.inputs.volume,"wheel",(t=>{const i=t.webkitDirectionInvertedFromDevice,[r,n]=[t.deltaX,-t.deltaY].map((e=>i?-e:e)),a=Math.sign(Math.abs(r)>Math.abs(n)?r:n);e.increaseVolume(a/50);const{volume:s}=e.media;(1===a&&s<1||-1===a&&s>0)&&t.preventDefault()}),"volume",!1)})),this.player=e,this.lastKey=null,this.focusTimer=null,this.lastKeyDown=null,this.handleKey=this.handleKey.bind(this),this.toggleMenu=this.toggleMenu.bind(this),this.firstTouch=this.firstTouch.bind(this)}handleKey(e){const{player:t}=this,{elements:i}=t,{key:r,type:n,altKey:a,ctrlKey:s,metaKey:o,shiftKey:l}=e,d="keydown"===n,u=d&&r===this.lastKey;var c;if(!(a||s||o||l)&&r)if(d){const n=document.activeElement;if(F(n)){const{editable:r}=t.config.selectors,{seek:a}=i.inputs;if(n!==a&&ae(n,r))return;if(" "===e.key&&ae(n,'button, [role^="menuitem"]'))return}switch([" ","ArrowLeft","ArrowUp","ArrowRight","ArrowDown","0","1","2","3","4","5","6","7","8","9","c","f","k","l","m"].includes(r)&&(e.preventDefault(),e.stopPropagation()),r){case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":u||(c=parseInt(r,10),t.currentTime=t.duration/10*c);break;case" ":case"k":u||be(t.togglePlay());break;case"ArrowUp":t.increaseVolume(.1);break;case"ArrowDown":t.decreaseVolume(.1);break;case"m":u||(t.muted=!t.muted);break;case"ArrowRight":t.forward();break;case"ArrowLeft":t.rewind();break;case"f":t.fullscreen.toggle();break;case"c":u||t.toggleCaptions();break;case"l":t.loop=!t.loop}"Escape"===r&&!t.fullscreen.usingNative&&t.fullscreen.active&&t.fullscreen.toggle(),this.lastKey=r}else this.lastKey=null}toggleMenu(e){$e.toggleMenu.call(this.player,e)}}var tt=function(e,t){return function(e,t){e.exports=function(){var e=function(){},t={},i={},r={};function n(e,t){e=e.push?e:[e];var n,a,s,o=[],l=e.length,d=l;for(n=function(e,i){i.length&&o.push(e),--d||t(o)};l--;)a=e[l],(s=i[a])?n(a,s):(r[a]=r[a]||[]).push(n)}function a(e,t){if(e){var n=r[e];if(i[e]=t,n)for(;n.length;)n[0](e,t),n.splice(0,1)}}function s(t,i){t.call&&(t={success:t}),i.length?(t.error||e)(i):(t.success||e)(t)}function o(t,i,r,n){var a,s,l=document,d=r.async,u=(r.numRetries||0)+1,c=r.before||e,h=t.replace(/[\?|#].*$/,""),f=t.replace(/^(css|img)!/,"");n=n||0,/(^css!|\.css$)/.test(h)?((s=l.createElement("link")).rel="stylesheet",s.href=f,(a="hideFocus"in s)&&s.relList&&(a=0,s.rel="preload",s.as="style")):/(^img!|\.(png|gif|jpg|svg|webp)$)/.test(h)?(s=l.createElement("img")).src=f:((s=l.createElement("script")).src=t,s.async=void 0===d||d),s.onload=s.onerror=s.onbeforeload=function(e){var l=e.type[0];if(a)try{s.sheet.cssText.length||(l="e")}catch(e){18!=e.code&&(l="e")}if("e"==l){if((n+=1)<u)return o(t,i,r,n)}else if("preload"==s.rel&&"style"==s.as)return s.rel="stylesheet";i(t,l,e.defaultPrevented)},!1!==c(t,s)&&l.head.appendChild(s)}function l(e,t,i){var r,n,a=(e=e.push?e:[e]).length,s=a,l=[];for(r=function(e,i,r){if("e"==i&&l.push(e),"b"==i){if(!r)return;l.push(e)}--a||t(l)},n=0;n<s;n++)o(e[n],r,i)}function d(e,i,r){var n,o;if(i&&i.trim&&(n=i),o=(n?r:i)||{},n){if(n in t)throw"LoadJS";t[n]=!0}function d(t,i){l(e,(function(e){s(o,e),t&&s({success:t,error:i},e),a(n,e)}),o)}if(o.returnPromise)return new Promise(d);d()}return d.ready=function(e,t){return n(e,(function(e){s(t,e)})),d},d.done=function(e){a(e,[])},d.reset=function(){t={},i={},r={}},d.isDefined=function(e){return e in t},d}()}(t={exports:{}}),t.exports}();function it(e){return new Promise(((t,i)=>{tt(e,{success:t,error:i})}))}function rt(e){e&&!this.embed.hasPlayed&&(this.embed.hasPlayed=!0),this.media.paused===e&&(this.media.paused=!e,ge.call(this,this.media,e?"play":"pause"))}const nt={setup(){const e=this;"vimeo"===e.provider&&(re(e.elements.wrapper,e.config.classNames.embed,!0),e.options.speed=e.config.speed.options,Ce.call(e),D(window.Vimeo)?nt.ready.call(e):it(e.config.urls.vimeo.sdk).then((()=>{nt.ready.call(e)})).catch((t=>{e.debug.warn("Vimeo SDK (player.js) failed to load",t)})))},ready(){const e=this,t=e.config.vimeo,{premium:i,referrerPolicy:r,...n}=t;let a=e.media.getAttribute("src"),s="";H(a)?(a=e.media.getAttribute(e.config.attributes.embed.id),s=e.media.getAttribute(e.config.attributes.embed.hash)):s=function(e){const t=e.match(/^.*(vimeo.com\/|video\/)(\d+)(\?.*&*h=|\/)+([\d,a-f]+)/);return t&&5===t.length?t[4]:null}(a);const o=s?{h:s}:{};i&&Object.assign(n,{controls:!1,sidedock:!1});const l=Ge({loop:e.config.loop.active,autoplay:e.autoplay,muted:e.muted,gesture:"media",playsinline:e.config.playsinline,...o,...n}),d=H(u=a)?null:x(Number(u))?u:u.match(/^.*(vimeo.com\/|video\/)(\d+).*/)?RegExp.$2:u;var u;const c=X("iframe"),h=De(e.config.urls.vimeo.iframe,d,l);if(c.setAttribute("src",h),c.setAttribute("allowfullscreen",""),c.setAttribute("allow",["autoplay","fullscreen","picture-in-picture","encrypted-media","accelerometer","gyroscope"].join("; ")),H(r)||c.setAttribute("referrerPolicy",r),i||!t.customControls)c.setAttribute("data-poster",e.poster),e.media=ee(c,e.media);else{const t=X("div",{class:e.config.classNames.embedContainer,"data-poster":e.poster});t.appendChild(c),e.media=ee(t,e.media)}t.customControls||Fe(De(e.config.urls.vimeo.api,h)).then((t=>{!H(t)&&t.thumbnail_url&&Ze.setPoster.call(e,t.thumbnail_url).catch((()=>{}))})),e.embed=new window.Vimeo.Player(c,{autopause:e.config.autopause,muted:e.muted}),e.media.paused=!0,e.media.currentTime=0,e.supported.ui&&e.embed.disableTextTrack(),e.media.play=()=>(rt.call(e,!0),e.embed.play()),e.media.pause=()=>(rt.call(e,!1),e.embed.pause()),e.media.stop=()=>{e.pause(),e.currentTime=0};let{currentTime:f}=e.media;Object.defineProperty(e.media,"currentTime",{get:()=>f,set(t){const{embed:i,media:r,paused:n,volume:a}=e,s=n&&!i.hasPlayed;r.seeking=!0,ge.call(e,r,"seeking"),Promise.resolve(s&&i.setVolume(0)).then((()=>i.setCurrentTime(t))).then((()=>s&&i.pause())).then((()=>s&&i.setVolume(a))).catch((()=>{}))}});let p=e.config.speed.selected;Object.defineProperty(e.media,"playbackRate",{get:()=>p,set(t){e.embed.setPlaybackRate(t).then((()=>{p=t,ge.call(e,e.media,"ratechange")})).catch((()=>{e.options.speed=[1]}))}});let{volume:m}=e.config;Object.defineProperty(e.media,"volume",{get:()=>m,set(t){e.embed.setVolume(t).then((()=>{m=t,ge.call(e,e.media,"volumechange")}))}});let{muted:g}=e.config;Object.defineProperty(e.media,"muted",{get:()=>g,set(t){const i=!!P(t)&&t;e.embed.setMuted(!!i||e.config.muted).then((()=>{g=i,ge.call(e,e.media,"volumechange")}))}});let v,{loop:y}=e.config;Object.defineProperty(e.media,"loop",{get:()=>y,set(t){const i=P(t)?t:e.config.loop.active;e.embed.setLoop(i).then((()=>{y=i}))}}),e.embed.getVideoUrl().then((t=>{v=t,$e.setDownloadUrl.call(e)})).catch((e=>{this.debug.warn(e)})),Object.defineProperty(e.media,"currentSrc",{get:()=>v}),Object.defineProperty(e.media,"ended",{get:()=>e.currentTime===e.duration}),Promise.all([e.embed.getVideoWidth(),e.embed.getVideoHeight()]).then((t=>{const[i,r]=t;e.embed.ratio=Re(i,r),Ce.call(this)})),e.embed.setAutopause(e.config.autopause).then((t=>{e.config.autopause=t})),e.embed.getVideoTitle().then((t=>{e.config.title=t,Ze.setTitle.call(this)})),e.embed.getCurrentTime().then((t=>{f=t,ge.call(e,e.media,"timeupdate")})),e.embed.getDuration().then((t=>{e.media.duration=t,ge.call(e,e.media,"durationchange")})),e.embed.getTextTracks().then((t=>{e.media.textTracks=t,qe.setup.call(e)})),e.embed.on("cuechange",(({cues:t=[]})=>{const i=t.map((e=>function(e){const t=document.createDocumentFragment(),i=document.createElement("div");return t.appendChild(i),i.innerHTML=e,t.firstChild.innerText}(e.text)));qe.updateCues.call(e,i)})),e.embed.on("loaded",(()=>{e.embed.getPaused().then((t=>{rt.call(e,!t),t||ge.call(e,e.media,"playing")})),F(e.embed.element)&&e.supported.ui&&e.embed.element.setAttribute("tabindex",-1)})),e.embed.on("bufferstart",(()=>{ge.call(e,e.media,"waiting")})),e.embed.on("bufferend",(()=>{ge.call(e,e.media,"playing")})),e.embed.on("play",(()=>{rt.call(e,!0),ge.call(e,e.media,"playing")})),e.embed.on("pause",(()=>{rt.call(e,!1)})),e.embed.on("timeupdate",(t=>{e.media.seeking=!1,f=t.seconds,ge.call(e,e.media,"timeupdate")})),e.embed.on("progress",(t=>{e.media.buffered=t.percent,ge.call(e,e.media,"progress"),1===parseInt(t.percent,10)&&ge.call(e,e.media,"canplaythrough"),e.embed.getDuration().then((t=>{t!==e.media.duration&&(e.media.duration=t,ge.call(e,e.media,"durationchange"))}))})),e.embed.on("seeked",(()=>{e.media.seeking=!1,ge.call(e,e.media,"seeked")})),e.embed.on("ended",(()=>{e.media.paused=!0,ge.call(e,e.media,"ended")})),e.embed.on("error",(t=>{e.media.error=t,ge.call(e,e.media,"error")})),t.customControls&&setTimeout((()=>Ze.build.call(e)),0)}};function at(e){e&&!this.embed.hasPlayed&&(this.embed.hasPlayed=!0),this.media.paused===e&&(this.media.paused=!e,ge.call(this,this.media,e?"play":"pause"))}function st(e){return e.noCookie?"https://www.youtube-nocookie.com":"http:"===window.location.protocol?"http://www.youtube.com":void 0}const ot={setup(){if(re(this.elements.wrapper,this.config.classNames.embed,!0),D(window.YT)&&I(window.YT.Player))ot.ready.call(this);else{const e=window.onYouTubeIframeAPIReady;window.onYouTubeIframeAPIReady=()=>{I(e)&&e(),ot.ready.call(this)},it(this.config.urls.youtube.sdk).catch((e=>{this.debug.warn("YouTube API failed to load",e)}))}},getTitle(e){Fe(De(this.config.urls.youtube.api,e)).then((e=>{if(D(e)){const{title:t,height:i,width:r}=e;this.config.title=t,Ze.setTitle.call(this),this.embed.ratio=Re(r,i)}Ce.call(this)})).catch((()=>{Ce.call(this)}))},ready(){const e=this;if("youtube"!==e.provider)return;const t=e.config.youtube,i=e.media&&e.media.getAttribute("id");if(!H(i)&&i.startsWith("youtube-"))return;let r=e.media.getAttribute("src");H(r)&&(r=e.media.getAttribute(this.config.attributes.embed.id));const n=H(a=r)?null:a.match(/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|&v=)([^#&?]*).*/)?RegExp.$2:a;var a;const s=X("div",{id:`${e.provider}-${Math.floor(1e4*Math.random())}`,"data-poster":t.customControls?e.poster:void 0});if(e.media=ee(s,e.media),t.customControls){const t=e=>`https://i.ytimg.com/vi/${n}/${e}default.jpg`;Je(t("maxres"),121).catch((()=>Je(t("sd"),121))).catch((()=>Je(t("hq")))).then((t=>Ze.setPoster.call(e,t.src))).then((t=>{t.includes("maxres")||(e.elements.poster.style.backgroundSize="cover")})).catch((()=>{}))}e.embed=new window.YT.Player(e.media,{videoId:n,host:st(t),playerVars:V({},{autoplay:e.config.autoplay?1:0,hl:e.config.hl,controls:e.supported.ui&&t.customControls?0:1,disablekb:1,playsinline:e.config.playsinline&&!e.config.fullscreen.iosNative?1:0,cc_load_policy:e.captions.active?1:0,cc_lang_pref:e.config.captions.language,widget_referrer:window?window.location.href:null},t),events:{onError(t){if(!e.media.error){const i=t.data,r={2:"The request contains an invalid parameter value. For example, this error occurs if you specify a video ID that does not have 11 characters, or if the video ID contains invalid characters, such as exclamation points or asterisks.",5:"The requested content cannot be played in an HTML5 player or another error related to the HTML5 player has occurred.",100:"The video requested was not found. This error occurs when a video has been removed (for any reason) or has been marked as private.",101:"The owner of the requested video does not allow it to be played in embedded players.",150:"The owner of the requested video does not allow it to be played in embedded players."}[i]||"An unknown error occurred";e.media.error={code:i,message:r},ge.call(e,e.media,"error")}},onPlaybackRateChange(t){const i=t.target;e.media.playbackRate=i.getPlaybackRate(),ge.call(e,e.media,"ratechange")},onReady(i){if(I(e.media.play))return;const r=i.target;ot.getTitle.call(e,n),e.media.play=()=>{at.call(e,!0),r.playVideo()},e.media.pause=()=>{at.call(e,!1),r.pauseVideo()},e.media.stop=()=>{r.stopVideo()},e.media.duration=r.getDuration(),e.media.paused=!0,e.media.currentTime=0,Object.defineProperty(e.media,"currentTime",{get:()=>Number(r.getCurrentTime()),set(t){e.paused&&!e.embed.hasPlayed&&e.embed.mute(),e.media.seeking=!0,ge.call(e,e.media,"seeking"),r.seekTo(t)}}),Object.defineProperty(e.media,"playbackRate",{get:()=>r.getPlaybackRate(),set(e){r.setPlaybackRate(e)}});let{volume:a}=e.config;Object.defineProperty(e.media,"volume",{get:()=>a,set(t){a=t,r.setVolume(100*a),ge.call(e,e.media,"volumechange")}});let{muted:s}=e.config;Object.defineProperty(e.media,"muted",{get:()=>s,set(t){const i=P(t)?t:s;s=i,r[i?"mute":"unMute"](),r.setVolume(100*a),ge.call(e,e.media,"volumechange")}}),Object.defineProperty(e.media,"currentSrc",{get:()=>r.getVideoUrl()}),Object.defineProperty(e.media,"ended",{get:()=>e.currentTime===e.duration});const o=r.getAvailablePlaybackRates();e.options.speed=o.filter((t=>e.config.speed.options.includes(t))),e.supported.ui&&t.customControls&&e.media.setAttribute("tabindex",-1),ge.call(e,e.media,"timeupdate"),ge.call(e,e.media,"durationchange"),clearInterval(e.timers.buffering),e.timers.buffering=setInterval((()=>{e.media.buffered=r.getVideoLoadedFraction(),(null===e.media.lastBuffered||e.media.lastBuffered<e.media.buffered)&&ge.call(e,e.media,"progress"),e.media.lastBuffered=e.media.buffered,1===e.media.buffered&&(clearInterval(e.timers.buffering),ge.call(e,e.media,"canplaythrough"))}),200),t.customControls&&setTimeout((()=>Ze.build.call(e)),50)},onStateChange(i){const r=i.target;switch(clearInterval(e.timers.playing),e.media.seeking&&[1,2].includes(i.data)&&(e.media.seeking=!1,ge.call(e,e.media,"seeked")),i.data){case-1:ge.call(e,e.media,"timeupdate"),e.media.buffered=r.getVideoLoadedFraction(),ge.call(e,e.media,"progress");break;case 0:at.call(e,!1),e.media.loop?(r.stopVideo(),r.playVideo()):ge.call(e,e.media,"ended");break;case 1:t.customControls&&!e.config.autoplay&&e.media.paused&&!e.embed.hasPlayed?e.media.pause():(at.call(e,!0),ge.call(e,e.media,"playing"),e.timers.playing=setInterval((()=>{ge.call(e,e.media,"timeupdate")}),50),e.media.duration!==r.getDuration()&&(e.media.duration=r.getDuration(),ge.call(e,e.media,"durationchange")));break;case 2:e.muted||e.embed.unMute(),at.call(e,!1);break;case 3:ge.call(e,e.media,"waiting")}ge.call(e,e.elements.container,"statechange",!1,{code:i.data})}}})}},lt={setup(){this.media?(re(this.elements.container,this.config.classNames.type.replace("{0}",this.type),!0),re(this.elements.container,this.config.classNames.provider.replace("{0}",this.provider),!0),this.isEmbed&&re(this.elements.container,this.config.classNames.type.replace("{0}","video"),!0),this.isVideo&&(this.elements.wrapper=X("div",{class:this.config.classNames.video}),Y(this.media,this.elements.wrapper),this.elements.poster=X("div",{class:this.config.classNames.poster}),this.elements.wrapper.appendChild(this.elements.poster)),this.isHTML5?Le.setup.call(this):this.isYouTube?ot.setup.call(this):this.isVimeo?nt.setup.call(this):""!==this.provider&&(window.Plyr.ui=Ze,window[this.provider].setup.call(this))):this.debug.warn("No media element found!")}};class dt{constructor(e){t(this,"load",(()=>{this.enabled&&(D(window.google)&&D(window.google.ima)?this.ready():it(this.player.config.urls.googleIMA.sdk).then((()=>{this.ready()})).catch((()=>{this.trigger("error",new Error("Google IMA SDK failed to load"))})))})),t(this,"ready",(()=>{var e;this.enabled||((e=this).manager&&e.manager.destroy(),e.elements.displayContainer&&e.elements.displayContainer.destroy(),e.elements.container.remove()),this.startSafetyTimer(12e3,"ready()"),this.managerPromise.then((()=>{this.clearSafetyTimer("onAdsManagerLoaded()")})),this.listeners(),this.setupIMA()})),t(this,"setupIMA",(()=>{this.elements.container=X("div",{class:this.player.config.classNames.ads}),this.player.elements.container.appendChild(this.elements.container),google.ima.settings.setVpaidMode(google.ima.ImaSdkSettings.VpaidMode.ENABLED),google.ima.settings.setLocale(this.player.config.ads.language),google.ima.settings.setDisableCustomPlaybackForIOS10Plus(this.player.config.playsinline),this.elements.displayContainer=new google.ima.AdDisplayContainer(this.elements.container,this.player.media),this.loader=new google.ima.AdsLoader(this.elements.displayContainer),this.loader.addEventListener(google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,(e=>this.onAdsManagerLoaded(e)),!1),this.loader.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,(e=>this.onAdError(e)),!1),this.requestAds()})),t(this,"requestAds",(()=>{const{container:e}=this.player.elements;try{const t=new google.ima.AdsRequest;t.adTagUrl=this.tagUrl,t.linearAdSlotWidth=e.offsetWidth,t.linearAdSlotHeight=e.offsetHeight,t.nonLinearAdSlotWidth=e.offsetWidth,t.nonLinearAdSlotHeight=e.offsetHeight,t.forceNonLinearFullSlot=!1,t.setAdWillPlayMuted(!this.player.muted),this.loader.requestAds(t)}catch(e){this.onAdError(e)}})),t(this,"pollCountdown",((e=!1)=>{if(!e)return clearInterval(this.countdownTimer),void this.elements.container.removeAttribute("data-badge-text");this.countdownTimer=setInterval((()=>{const e=je(Math.max(this.manager.getRemainingTime(),0)),t=`${Me.get("advertisement",this.player.config)} - ${e}`;this.elements.container.setAttribute("data-badge-text",t)}),100)})),t(this,"onAdsManagerLoaded",(e=>{if(!this.enabled)return;const t=new google.ima.AdsRenderingSettings;t.restoreCustomPlaybackStateOnAdBreakComplete=!0,t.enablePreloading=!0,this.manager=e.getAdsManager(this.player,t),this.cuePoints=this.manager.getCuePoints(),this.manager.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,(e=>this.onAdError(e))),Object.keys(google.ima.AdEvent.Type).forEach((e=>{this.manager.addEventListener(google.ima.AdEvent.Type[e],(e=>this.onAdEvent(e)))})),this.trigger("loaded")})),t(this,"addCuePoints",(()=>{H(this.cuePoints)||this.cuePoints.forEach((e=>{if(0!==e&&-1!==e&&e<this.player.duration){const t=this.player.elements.progress;if(F(t)){const i=100/this.player.duration*e,r=X("span",{class:this.player.config.classNames.cues});r.style.left=`${i.toString()}%`,t.appendChild(r)}}}))})),t(this,"onAdEvent",(e=>{const{container:t}=this.player.elements,i=e.getAd(),r=e.getAdData();switch((e=>{ge.call(this.player,this.player.media,`ads${e.replace(/_/g,"").toLowerCase()}`)})(e.type),e.type){case google.ima.AdEvent.Type.LOADED:this.trigger("loaded"),this.pollCountdown(!0),i.isLinear()||(i.width=t.offsetWidth,i.height=t.offsetHeight);break;case google.ima.AdEvent.Type.STARTED:this.manager.setVolume(this.player.volume);break;case google.ima.AdEvent.Type.ALL_ADS_COMPLETED:this.player.ended?this.loadAds():this.loader.contentComplete();break;case google.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED:this.pauseContent();break;case google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED:this.pollCountdown(),this.resumeContent();break;case google.ima.AdEvent.Type.LOG:r.adError&&this.player.debug.warn(`Non-fatal ad error: ${r.adError.getMessage()}`)}})),t(this,"onAdError",(e=>{this.cancel(),this.player.debug.warn("Ads error",e)})),t(this,"listeners",(()=>{const{container:e}=this.player.elements;let t;this.player.on("canplay",(()=>{this.addCuePoints()})),this.player.on("ended",(()=>{this.loader.contentComplete()})),this.player.on("timeupdate",(()=>{t=this.player.currentTime})),this.player.on("seeked",(()=>{const e=this.player.currentTime;H(this.cuePoints)||this.cuePoints.forEach(((i,r)=>{t<i&&i<e&&(this.manager.discardAdBreak(),this.cuePoints.splice(r,1))}))})),window.addEventListener("resize",(()=>{this.manager&&this.manager.resize(e.offsetWidth,e.offsetHeight,google.ima.ViewMode.NORMAL)}))})),t(this,"play",(()=>{const{container:e}=this.player.elements;this.managerPromise||this.resumeContent(),this.managerPromise.then((()=>{this.manager.setVolume(this.player.volume),this.elements.displayContainer.initialize();try{this.initialized||(this.manager.init(e.offsetWidth,e.offsetHeight,google.ima.ViewMode.NORMAL),this.manager.start()),this.initialized=!0}catch(e){this.onAdError(e)}})).catch((()=>{}))})),t(this,"resumeContent",(()=>{this.elements.container.style.zIndex="",this.playing=!1,be(this.player.media.play())})),t(this,"pauseContent",(()=>{this.elements.container.style.zIndex=3,this.playing=!0,this.player.media.pause()})),t(this,"cancel",(()=>{this.initialized&&this.resumeContent(),this.trigger("error"),this.loadAds()})),t(this,"loadAds",(()=>{this.managerPromise.then((()=>{this.manager&&this.manager.destroy(),this.managerPromise=new Promise((e=>{this.on("loaded",e),this.player.debug.log(this.manager)})),this.initialized=!1,this.requestAds()})).catch((()=>{}))})),t(this,"trigger",((e,...t)=>{const i=this.events[e];M(i)&&i.forEach((e=>{I(e)&&e.apply(this,t)}))})),t(this,"on",((e,t)=>(M(this.events[e])||(this.events[e]=[]),this.events[e].push(t),this))),t(this,"startSafetyTimer",((e,t)=>{this.player.debug.log(`Safety timer invoked from: ${t}`),this.safetyTimer=setTimeout((()=>{this.cancel(),this.clearSafetyTimer("startSafetyTimer()")}),e)})),t(this,"clearSafetyTimer",(e=>{L(this.safetyTimer)||(this.player.debug.log(`Safety timer cleared from: ${e}`),clearTimeout(this.safetyTimer),this.safetyTimer=null)})),this.player=e,this.config=e.config.ads,this.playing=!1,this.initialized=!1,this.elements={container:null,displayContainer:null},this.manager=null,this.loader=null,this.cuePoints=null,this.events={},this.safetyTimer=null,this.countdownTimer=null,this.managerPromise=new Promise(((e,t)=>{this.on("loaded",e),this.on("error",t)})),this.load()}get enabled(){const{config:e}=this;return this.player.isHTML5&&e.enabled&&(!H(e.publisherId)||$(e.tagUrl))}get tagUrl(){const{config:e}=this;return $(e.tagUrl)?e.tagUrl:`https://go.aniview.com/api/adserver6/vast/?${Ge({AV_PUBLISHERID:"58c25bb0073ef448b1087ad6",AV_CHANNELID:"5a0458dc28a06145e4519d21",AV_URL:window.location.hostname,cb:Date.now(),AV_WIDTH:640,AV_HEIGHT:480,AV_CDIM2:e.publisherId})}`}}function ut(e=0,t=0,i=255){return Math.min(Math.max(e,t),i)}const ct=e=>{const t=[];return e.split(/\r\n\r\n|\n\n|\r\r/).forEach((e=>{const i={};e.split(/\r\n|\n|\r/).forEach((e=>{if(x(i.startTime)){if(!H(e.trim())&&H(i.text)){const t=e.trim().split("#xywh=");[i.text]=t,t[1]&&([i.x,i.y,i.w,i.h]=t[1].split(","))}}else{const t=e.match(/([0-9]{2})?:?([0-9]{2}):([0-9]{2}).([0-9]{2,3})( ?--> ?)([0-9]{2})?:?([0-9]{2}):([0-9]{2}).([0-9]{2,3})/);t&&(i.startTime=60*Number(t[1]||0)*60+60*Number(t[2])+Number(t[3])+Number(`0.${t[4]}`),i.endTime=60*Number(t[6]||0)*60+60*Number(t[7])+Number(t[8])+Number(`0.${t[9]}`))}})),i.text&&t.push(i)})),t},ht=(e,t)=>{const i={};return e>t.width/t.height?(i.width=t.width,i.height=1/e*t.width):(i.height=t.height,i.width=e*t.height),i};class ft{constructor(e){t(this,"load",(()=>{this.player.elements.display.seekTooltip&&(this.player.elements.display.seekTooltip.hidden=this.enabled),this.enabled&&this.getThumbnails().then((()=>{this.enabled&&(this.render(),this.determineContainerAutoSizing(),this.listeners(),this.loaded=!0)}))})),t(this,"getThumbnails",(()=>new Promise((e=>{const{src:t}=this.player.config.previewThumbnails;if(H(t))throw new Error("Missing previewThumbnails.src config attribute");const i=()=>{this.thumbnails.sort(((e,t)=>e.height-t.height)),this.player.debug.log("Preview thumbnails",this.thumbnails),e()};if(I(t))t((e=>{this.thumbnails=e,i()}));else{const e=(O(t)?[t]:t).map((e=>this.getThumbnail(e)));Promise.all(e).then(i)}})))),t(this,"getThumbnail",(e=>new Promise((t=>{Fe(e).then((i=>{const r={frames:ct(i),height:null,urlPrefix:""};r.frames[0].text.startsWith("/")||r.frames[0].text.startsWith("http://")||r.frames[0].text.startsWith("https://")||(r.urlPrefix=e.substring(0,e.lastIndexOf("/")+1));const n=new Image;n.onload=()=>{r.height=n.naturalHeight,r.width=n.naturalWidth,this.thumbnails.push(r),t()},n.src=r.urlPrefix+r.frames[0].text}))})))),t(this,"startMove",(e=>{if(this.loaded&&U(e)&&["touchmove","mousemove"].includes(e.type)&&this.player.media.duration){if("touchmove"===e.type)this.seekTime=this.player.media.duration*(this.player.elements.inputs.seek.value/100);else{var t,i;const r=this.player.elements.progress.getBoundingClientRect(),n=100/r.width*(e.pageX-r.left);this.seekTime=this.player.media.duration*(n/100),this.seekTime<0&&(this.seekTime=0),this.seekTime>this.player.media.duration-1&&(this.seekTime=this.player.media.duration-1),this.mousePosX=e.pageX,this.elements.thumb.time.innerText=je(this.seekTime);const a=null===(t=this.player.config.markers)||void 0===t||null===(i=t.points)||void 0===i?void 0:i.find((({time:e})=>e===Math.round(this.seekTime)));a&&this.elements.thumb.time.insertAdjacentHTML("afterbegin",`${a.label}<br>`)}this.showImageAtCurrentTime()}})),t(this,"endMove",(()=>{this.toggleThumbContainer(!1,!0)})),t(this,"startScrubbing",(e=>{(L(e.button)||!1===e.button||0===e.button)&&(this.mouseDown=!0,this.player.media.duration&&(this.toggleScrubbingContainer(!0),this.toggleThumbContainer(!1,!0),this.showImageAtCurrentTime()))})),t(this,"endScrubbing",(()=>{this.mouseDown=!1,Math.ceil(this.lastTime)===Math.ceil(this.player.media.currentTime)?this.toggleScrubbingContainer(!1):me.call(this.player,this.player.media,"timeupdate",(()=>{this.mouseDown||this.toggleScrubbingContainer(!1)}))})),t(this,"listeners",(()=>{this.player.on("play",(()=>{this.toggleThumbContainer(!1,!0)})),this.player.on("seeked",(()=>{this.toggleThumbContainer(!1)})),this.player.on("timeupdate",(()=>{this.lastTime=this.player.media.currentTime}))})),t(this,"render",(()=>{this.elements.thumb.container=X("div",{class:this.player.config.classNames.previewThumbnails.thumbContainer}),this.elements.thumb.imageContainer=X("div",{class:this.player.config.classNames.previewThumbnails.imageContainer}),this.elements.thumb.container.appendChild(this.elements.thumb.imageContainer);const e=X("div",{class:this.player.config.classNames.previewThumbnails.timeContainer});this.elements.thumb.time=X("span",{},"00:00"),e.appendChild(this.elements.thumb.time),this.elements.thumb.imageContainer.appendChild(e),F(this.player.elements.progress)&&this.player.elements.progress.appendChild(this.elements.thumb.container),this.elements.scrubbing.container=X("div",{class:this.player.config.classNames.previewThumbnails.scrubbingContainer}),this.player.elements.wrapper.appendChild(this.elements.scrubbing.container)})),t(this,"destroy",(()=>{this.elements.thumb.container&&this.elements.thumb.container.remove(),this.elements.scrubbing.container&&this.elements.scrubbing.container.remove()})),t(this,"showImageAtCurrentTime",(()=>{this.mouseDown?this.setScrubbingContainerSize():this.setThumbContainerSizeAndPos();const e=this.thumbnails[0].frames.findIndex((e=>this.seekTime>=e.startTime&&this.seekTime<=e.endTime)),t=e>=0;let i=0;this.mouseDown||this.toggleThumbContainer(t),t&&(this.thumbnails.forEach(((t,r)=>{this.loadedImages.includes(t.frames[e].text)&&(i=r)})),e!==this.showingThumb&&(this.showingThumb=e,this.loadImage(i)))})),t(this,"loadImage",((e=0)=>{const t=this.showingThumb,i=this.thumbnails[e],{urlPrefix:r}=i,n=i.frames[t],a=i.frames[t].text,s=r+a;if(this.currentImageElement&&this.currentImageElement.dataset.filename===a)this.showImage(this.currentImageElement,n,e,t,a,!1),this.currentImageElement.dataset.index=t,this.removeOldImages(this.currentImageElement);else{this.loadingImage&&this.usingSprites&&(this.loadingImage.onload=null);const i=new Image;i.src=s,i.dataset.index=t,i.dataset.filename=a,this.showingThumbFilename=a,this.player.debug.log(`Loading image: ${s}`),i.onload=()=>this.showImage(i,n,e,t,a,!0),this.loadingImage=i,this.removeOldImages(i)}})),t(this,"showImage",((e,t,i,r,n,a=!0)=>{this.player.debug.log(`Showing thumb: ${n}. num: ${r}. qual: ${i}. newimg: ${a}`),this.setImageSizeAndOffset(e,t),a&&(this.currentImageContainer.appendChild(e),this.currentImageElement=e,this.loadedImages.includes(n)||this.loadedImages.push(n)),this.preloadNearby(r,!0).then(this.preloadNearby(r,!1)).then(this.getHigherQuality(i,e,t,n))})),t(this,"removeOldImages",(e=>{Array.from(this.currentImageContainer.children).forEach((t=>{if("img"!==t.tagName.toLowerCase())return;const i=this.usingSprites?500:1e3;if(t.dataset.index!==e.dataset.index&&!t.dataset.deleting){t.dataset.deleting=!0;const{currentImageContainer:e}=this;setTimeout((()=>{e.removeChild(t),this.player.debug.log(`Removing thumb: ${t.dataset.filename}`)}),i)}}))})),t(this,"preloadNearby",((e,t=!0)=>new Promise((i=>{setTimeout((()=>{const r=this.thumbnails[0].frames[e].text;if(this.showingThumbFilename===r){let n;n=t?this.thumbnails[0].frames.slice(e):this.thumbnails[0].frames.slice(0,e).reverse();let a=!1;n.forEach((e=>{const t=e.text;if(t!==r&&!this.loadedImages.includes(t)){a=!0,this.player.debug.log(`Preloading thumb filename: ${t}`);const{urlPrefix:e}=this.thumbnails[0],r=e+t,n=new Image;n.src=r,n.onload=()=>{this.player.debug.log(`Preloaded thumb filename: ${t}`),this.loadedImages.includes(t)||this.loadedImages.push(t),i()}}})),a||i()}}),300)})))),t(this,"getHigherQuality",((e,t,i,r)=>{if(e<this.thumbnails.length-1){let n=t.naturalHeight;this.usingSprites&&(n=i.h),n<this.thumbContainerHeight&&setTimeout((()=>{this.showingThumbFilename===r&&(this.player.debug.log(`Showing higher quality thumb for: ${r}`),this.loadImage(e+1))}),300)}})),t(this,"toggleThumbContainer",((e=!1,t=!1)=>{const i=this.player.config.classNames.previewThumbnails.thumbContainerShown;this.elements.thumb.container.classList.toggle(i,e),!e&&t&&(this.showingThumb=null,this.showingThumbFilename=null)})),t(this,"toggleScrubbingContainer",((e=!1)=>{const t=this.player.config.classNames.previewThumbnails.scrubbingContainerShown;this.elements.scrubbing.container.classList.toggle(t,e),e||(this.showingThumb=null,this.showingThumbFilename=null)})),t(this,"determineContainerAutoSizing",(()=>{(this.elements.thumb.imageContainer.clientHeight>20||this.elements.thumb.imageContainer.clientWidth>20)&&(this.sizeSpecifiedInCSS=!0)})),t(this,"setThumbContainerSizeAndPos",(()=>{const{imageContainer:e}=this.elements.thumb;if(this.sizeSpecifiedInCSS){if(e.clientHeight>20&&e.clientWidth<20){const t=Math.floor(e.clientHeight*this.thumbAspectRatio);e.style.width=`${t}px`}else if(e.clientHeight<20&&e.clientWidth>20){const t=Math.floor(e.clientWidth/this.thumbAspectRatio);e.style.height=`${t}px`}}else{const t=Math.floor(this.thumbContainerHeight*this.thumbAspectRatio);e.style.height=`${this.thumbContainerHeight}px`,e.style.width=`${t}px`}this.setThumbContainerPos()})),t(this,"setThumbContainerPos",(()=>{const e=this.player.elements.progress.getBoundingClientRect(),t=this.player.elements.container.getBoundingClientRect(),{container:i}=this.elements.thumb,r=t.left-e.left+10,n=t.right-e.left-i.clientWidth-10,a=this.mousePosX-e.left-i.clientWidth/2,s=ut(a,r,n);i.style.left=`${s}px`,i.style.setProperty("--preview-arrow-offset",a-s+"px")})),t(this,"setScrubbingContainerSize",(()=>{const{width:e,height:t}=ht(this.thumbAspectRatio,{width:this.player.media.clientWidth,height:this.player.media.clientHeight});this.elements.scrubbing.container.style.width=`${e}px`,this.elements.scrubbing.container.style.height=`${t}px`})),t(this,"setImageSizeAndOffset",((e,t)=>{if(!this.usingSprites)return;const i=this.thumbContainerHeight/t.h;e.style.height=e.naturalHeight*i+"px",e.style.width=e.naturalWidth*i+"px",e.style.left=`-${t.x*i}px`,e.style.top=`-${t.y*i}px`})),this.player=e,this.thumbnails=[],this.loaded=!1,this.lastMouseMoveTime=Date.now(),this.mouseDown=!1,this.loadedImages=[],this.elements={thumb:{},scrubbing:{}},this.load()}get enabled(){return this.player.isHTML5&&this.player.isVideo&&this.player.config.previewThumbnails.enabled}get currentImageContainer(){return this.mouseDown?this.elements.scrubbing.container:this.elements.thumb.imageContainer}get usingSprites(){return Object.keys(this.thumbnails[0].frames[0]).includes("w")}get thumbAspectRatio(){return this.usingSprites?this.thumbnails[0].frames[0].w/this.thumbnails[0].frames[0].h:this.thumbnails[0].width/this.thumbnails[0].height}get thumbContainerHeight(){if(this.mouseDown){const{height:e}=ht(this.thumbAspectRatio,{width:this.player.media.clientWidth,height:this.player.media.clientHeight});return e}return this.sizeSpecifiedInCSS?this.elements.thumb.imageContainer.clientHeight:Math.floor(this.player.media.clientWidth/this.thumbAspectRatio/4)}get currentImageElement(){return this.mouseDown?this.currentScrubbingImageElement:this.currentThumbnailImageElement}set currentImageElement(e){this.mouseDown?this.currentScrubbingImageElement=e:this.currentThumbnailImageElement=e}}const pt={insertElements(e,t){O(t)?Q(e,this.media,{src:t}):M(t)&&t.forEach((t=>{Q(e,this.media,t)}))},change(e){W(e,"sources.length")?(Le.cancelRequests.call(this),this.destroy.call(this,(()=>{this.options.quality=[],J(this.media),this.media=null,F(this.elements.container)&&this.elements.container.removeAttribute("class");const{sources:t,type:i}=e,[{provider:r=Ve.html5,src:n}]=t,a="html5"===r?i:"div",s="html5"===r?{}:{src:n};Object.assign(this,{provider:r,type:i,supported:ue.check(i,r,this.config.playsinline),media:X(a,s)}),this.elements.container.appendChild(this.media),P(e.autoplay)&&(this.config.autoplay=e.autoplay),this.isHTML5&&(this.config.crossorigin&&this.media.setAttribute("crossorigin",""),this.config.autoplay&&this.media.setAttribute("autoplay",""),H(e.poster)||(this.poster=e.poster),this.config.loop.active&&this.media.setAttribute("loop",""),this.config.muted&&this.media.setAttribute("muted",""),this.config.playsinline&&this.media.setAttribute("playsinline","")),Ze.addStyleHook.call(this),this.isHTML5&&pt.insertElements.call(this,"source",t),this.config.title=e.title,lt.setup.call(this),this.isHTML5&&Object.keys(e).includes("tracks")&&pt.insertElements.call(this,"track",e.tracks),(this.isHTML5||this.isEmbed&&!this.supported.ui)&&Ze.build.call(this),this.isHTML5&&this.media.load(),H(e.previewThumbnails)||(Object.assign(this.config.previewThumbnails,e.previewThumbnails),this.previewThumbnails&&this.previewThumbnails.loaded&&(this.previewThumbnails.destroy(),this.previewThumbnails=null),this.config.previewThumbnails.enabled&&(this.previewThumbnails=new ft(this))),this.fullscreen.update()}),!0)):this.debug.warn("Invalid source format")}};class mt{constructor(e,i){if(t(this,"play",(()=>I(this.media.play)?(this.ads&&this.ads.enabled&&this.ads.managerPromise.then((()=>this.ads.play())).catch((()=>be(this.media.play()))),this.media.play()):null)),t(this,"pause",(()=>this.playing&&I(this.media.pause)?this.media.pause():null)),t(this,"togglePlay",(e=>(P(e)?e:!this.playing)?this.play():this.pause())),t(this,"stop",(()=>{this.isHTML5?(this.pause(),this.restart()):I(this.media.stop)&&this.media.stop()})),t(this,"restart",(()=>{this.currentTime=0})),t(this,"rewind",(e=>{this.currentTime-=x(e)?e:this.config.seekTime})),t(this,"forward",(e=>{this.currentTime+=x(e)?e:this.config.seekTime})),t(this,"increaseVolume",(e=>{const t=this.media.muted?0:this.volume;this.volume=t+(x(e)?e:0)})),t(this,"decreaseVolume",(e=>{this.increaseVolume(-e)})),t(this,"airplay",(()=>{ue.airplay&&this.media.webkitShowPlaybackTargetPicker()})),t(this,"toggleControls",(e=>{if(this.supported.ui&&!this.isAudio){const t=ne(this.elements.container,this.config.classNames.hideControls),i=void 0===e?void 0:!e,r=re(this.elements.container,this.config.classNames.hideControls,i);if(r&&M(this.config.controls)&&this.config.controls.includes("settings")&&!H(this.config.settings)&&$e.toggleMenu.call(this,!1),r!==t){const e=r?"controlshidden":"controlsshown";ge.call(this,this.media,e)}return!r}return!1})),t(this,"on",((e,t)=>{fe.call(this,this.elements.container,e,t)})),t(this,"once",((e,t)=>{me.call(this,this.elements.container,e,t)})),t(this,"off",((e,t)=>{pe(this.elements.container,e,t)})),t(this,"destroy",((e,t=!1)=>{if(!this.ready)return;const i=()=>{document.body.style.overflow="",this.embed=null,t?(Object.keys(this.elements).length&&(J(this.elements.buttons.play),J(this.elements.captions),J(this.elements.controls),J(this.elements.wrapper),this.elements.buttons.play=null,this.elements.captions=null,this.elements.controls=null,this.elements.wrapper=null),I(e)&&e()):(ve.call(this),Le.cancelRequests.call(this),ee(this.elements.original,this.elements.container),ge.call(this,this.elements.original,"destroyed",!0),I(e)&&e.call(this.elements.original),this.ready=!1,setTimeout((()=>{this.elements=null,this.media=null}),200))};this.stop(),clearTimeout(this.timers.loading),clearTimeout(this.timers.controls),clearTimeout(this.timers.resized),this.isHTML5?(Ze.toggleNativeControls.call(this,!0),i()):this.isYouTube?(clearInterval(this.timers.buffering),clearInterval(this.timers.playing),null!==this.embed&&I(this.embed.destroy)&&this.embed.destroy(),i()):this.isVimeo?(null!==this.embed&&this.embed.unload().then(i),setTimeout(i,200)):i()})),t(this,"supports",(e=>ue.mime.call(this,e))),this.timers={},this.ready=!1,this.loading=!1,this.failed=!1,this.touch=ue.touch,this.media=e,O(this.media)&&(this.media=document.querySelectorAll(this.media)),(window.jQuery&&this.media instanceof jQuery||N(this.media)||M(this.media))&&(this.media=this.media[0]),this.config=V({},Ke,mt.defaults,i||{},(()=>{try{return JSON.parse(this.media.getAttribute("data-plyr-config"))}catch(e){return{}}})()),this.elements={container:null,fullscreen:null,captions:null,buttons:{},display:{},progress:{},inputs:{},settings:{popup:null,menu:null,panels:{},buttons:{}}},this.captions={active:null,currentTrack:-1,meta:new WeakMap},this.fullscreen={active:!1},this.options={speed:[],quality:[]},this.debug=new Xe(this.config.debug),this.debug.log("Config",this.config),this.debug.log("Support",ue),L(this.media)||!F(this.media))return void this.debug.error("Setup failed: no suitable element passed");if(this.media.plyr)return void this.debug.warn("Target already setup");if(!this.config.enabled)return void this.debug.error("Setup failed: disabled by config");if(!ue.check().api)return void this.debug.error("Setup failed: no support");const r=this.media.cloneNode(!0);r.autoplay=!1,this.elements.original=r;const n=this.media.tagName.toLowerCase();let a=null,s=null;switch(n){case"div":if(a=this.media.querySelector("iframe"),F(a)){if(s=He(a.getAttribute("src")),this.provider=function(e){return/^(https?:\/\/)?(www\.)?(youtube\.com|youtube-nocookie\.com|youtu\.?be)\/.+$/.test(e)?Ve.youtube:/^https?:\/\/player.vimeo.com\/video\/\d{0,9}(?=\b|\/)/.test(e)?Ve.vimeo:null}(s.toString()),this.elements.container=this.media,this.media=a,this.elements.container.className="",s.search.length){const e=["1","true"];e.includes(s.searchParams.get("autoplay"))&&(this.config.autoplay=!0),e.includes(s.searchParams.get("loop"))&&(this.config.loop.active=!0),this.isYouTube?(this.config.playsinline=e.includes(s.searchParams.get("playsinline")),this.config.youtube.hl=s.searchParams.get("hl")):this.config.playsinline=!0}}else this.provider=this.media.getAttribute(this.config.attributes.embed.provider),this.media.removeAttribute(this.config.attributes.embed.provider);if(H(this.provider)||!Object.values(Ve).includes(this.provider))return void this.debug.error("Setup failed: Invalid provider");this.type=Ye;break;case"video":case"audio":this.type=n,this.provider=Ve.html5,this.media.hasAttribute("crossorigin")&&(this.config.crossorigin=!0),this.media.hasAttribute("autoplay")&&(this.config.autoplay=!0),(this.media.hasAttribute("playsinline")||this.media.hasAttribute("webkit-playsinline"))&&(this.config.playsinline=!0),this.media.hasAttribute("muted")&&(this.config.muted=!0),this.media.hasAttribute("loop")&&(this.config.loop.active=!0);break;default:return void this.debug.error("Setup failed: unsupported type")}this.supported=ue.check(this.type,this.provider),this.supported.api?(this.eventListeners=[],this.listeners=new et(this),this.storage=new Ne(this),this.media.plyr=this,F(this.elements.container)||(this.elements.container=X("div"),Y(this.media,this.elements.container)),Ze.migrateStyles.call(this),Ze.addStyleHook.call(this),lt.setup.call(this),this.config.debug&&fe.call(this,this.elements.container,this.config.events.join(" "),(e=>{this.debug.log(`event: ${e.type}`)})),this.fullscreen=new Qe(this),(this.isHTML5||this.isEmbed&&!this.supported.ui)&&Ze.build.call(this),this.listeners.container(),this.listeners.global(),this.config.ads.enabled&&(this.ads=new dt(this)),this.isHTML5&&this.config.autoplay&&this.once("canplay",(()=>be(this.play()))),this.lastSeekTime=0,this.config.previewThumbnails.enabled&&(this.previewThumbnails=new ft(this))):this.debug.error("Setup failed: no support")}get isHTML5(){return this.provider===Ve.html5}get isEmbed(){return this.isYouTube||this.isVimeo||this.provider!==Ve.html5}get isYouTube(){return this.provider===Ve.youtube}get isVimeo(){return this.provider===Ve.vimeo}get isVideo(){return this.type===Ye}get isAudio(){return"audio"===this.type}get playing(){return Boolean(this.ready&&!this.paused&&!this.ended)}get paused(){return Boolean(this.media.paused)}get stopped(){return Boolean(this.paused&&0===this.currentTime)}get ended(){return Boolean(this.media.ended)}set currentTime(e){if(!this.duration)return;const t=x(e)&&e>0;this.media.currentTime=t?Math.min(e,this.duration):0,this.debug.log(`Seeking to ${this.currentTime} seconds`)}get currentTime(){return Number(this.media.currentTime)}get buffered(){const{buffered:e}=this.media;return x(e)?e:e&&e.length&&this.duration>0?e.end(0)/this.duration:0}get seeking(){return Boolean(this.media.seeking)}get duration(){const e=parseFloat(this.config.duration),t=(this.media||{}).duration,i=x(t)&&t!==1/0?t:0;return e||i}set volume(e){let t=e;O(t)&&(t=Number(t)),x(t)||(t=this.storage.get("volume")),x(t)||({volume:t}=this.config),t>1&&(t=1),t<0&&(t=0),this.config.volume=t,this.media.volume=t,!H(e)&&this.muted&&t>0&&(this.muted=!1)}get volume(){return Number(this.media.volume)}set muted(e){let t=e;P(t)||(t=this.storage.get("muted")),P(t)||(t=this.config.muted),this.config.muted=t,this.media.muted=t}get muted(){return Boolean(this.media.muted)}get hasAudio(){return!this.isHTML5||!!this.isAudio||Boolean(this.media.mozHasAudio)||Boolean(this.media.webkitAudioDecodedByteCount)||Boolean(this.media.audioTracks&&this.media.audioTracks.length)}set speed(e){let t=null;x(e)&&(t=e),x(t)||(t=this.storage.get("speed")),x(t)||(t=this.config.speed.selected);const{minimumSpeed:i,maximumSpeed:r}=this;t=ut(t,i,r),this.config.speed.selected=t,setTimeout((()=>{this.media&&(this.media.playbackRate=t)}),0)}get speed(){return Number(this.media.playbackRate)}get minimumSpeed(){return this.isYouTube?Math.min(...this.options.speed):this.isVimeo?.5:.0625}get maximumSpeed(){return this.isYouTube?Math.max(...this.options.speed):this.isVimeo?2:16}set quality(e){const t=this.config.quality,i=this.options.quality;if(!i.length)return;let r=[!H(e)&&Number(e),this.storage.get("quality"),t.selected,t.default].find(x),n=!0;if(!i.includes(r)){const e=_e(i,r);this.debug.warn(`Unsupported quality option: ${r}, using ${e} instead`),r=e,n=!1}t.selected=r,this.media.quality=r,n&&this.storage.set({quality:r})}get quality(){return this.media.quality}set loop(e){const t=P(e)?e:this.config.loop.active;this.config.loop.active=t,this.media.loop=t}get loop(){return Boolean(this.media.loop)}set source(e){pt.change.call(this,e)}get source(){return this.media.currentSrc}get download(){const{download:e}=this.config.urls;return $(e)?e:this.source}set download(e){$(e)&&(this.config.urls.download=e,$e.setDownloadUrl.call(this))}set poster(e){this.isVideo?Ze.setPoster.call(this,e,!1).catch((()=>{})):this.debug.warn("Poster can only be set for video")}get poster(){return this.isVideo?this.media.getAttribute("poster")||this.media.getAttribute("data-poster"):null}get ratio(){if(!this.isVideo)return null;const e=ke(Ae.call(this));return M(e)?e.join(":"):e}set ratio(e){this.isVideo?O(e)&&Se(e)?(this.config.ratio=ke(e),Ce.call(this)):this.debug.error(`Invalid aspect ratio specified (${e})`):this.debug.warn("Aspect ratio can only be set for video")}set autoplay(e){this.config.autoplay=P(e)?e:this.config.autoplay}get autoplay(){return Boolean(this.config.autoplay)}toggleCaptions(e){qe.toggle.call(this,e,!1)}set currentTrack(e){qe.set.call(this,e,!1),qe.setup.call(this)}get currentTrack(){const{toggled:e,currentTrack:t}=this.captions;return e?t:-1}set language(e){qe.setLanguage.call(this,e,!1)}get language(){return(qe.getCurrentTrack.call(this)||{}).language}set pip(e){if(!ue.pip)return;const t=P(e)?e:!this.pip;I(this.media.webkitSetPresentationMode)&&this.media.webkitSetPresentationMode(t?We:"inline"),I(this.media.requestPictureInPicture)&&(!this.pip&&t?this.media.requestPictureInPicture():this.pip&&!t&&document.exitPictureInPicture())}get pip(){return ue.pip?H(this.media.webkitPresentationMode)?this.media===document.pictureInPictureElement:this.media.webkitPresentationMode===We:null}setPreviewThumbnails(e){this.previewThumbnails&&this.previewThumbnails.loaded&&(this.previewThumbnails.destroy(),this.previewThumbnails=null),Object.assign(this.config.previewThumbnails,e),this.config.previewThumbnails.enabled&&(this.previewThumbnails=new ft(this))}static supported(e,t){return ue.check(e,t)}static loadSprite(e,t){return Ue(e,t)}static setup(e,t={}){let i=null;return O(e)?i=Array.from(document.querySelectorAll(e)):N(e)?i=Array.from(e):M(e)&&(i=e.filter(F)),H(i)?null:i.map((e=>new mt(e,t)))}}var gt;return mt.defaults=(gt=Ke,JSON.parse(JSON.stringify(gt))),mt})),function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).DetectBPM=e()}}((function(){return function e(t,i,r){function n(s,o){if(!i[s]){if(!t[s]){var l="function"==typeof require&&require;if(!o&&l)return l(s,!0);if(a)return a(s,!0);var d=new Error("Cannot find module '"+s+"'");throw d.code="MODULE_NOT_FOUND",d}var u=i[s]={exports:{}};t[s][0].call(u.exports,(function(e){return n(t[s][1][e]||e)}),u,u.exports,e,t,i,r)}return i[s].exports}for(var a="function"==typeof require&&require,s=0;s<r.length;s++)n(r[s]);return n}({1:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=function(e){var t=function(e){var t=e.length,i=e.numberOfChannels,n=e.sampleRate,a=new r(i,t,n),s=a.createBufferSource();s.buffer=e;var o=a.createBiquadFilter();return o.type="lowpass",s.connect(o),o.connect(a.destination),s}(e);return t.start(0),[a,o,l(e.sampleRate),n].reduce((function(e,t){return t(e)}),t.buffer.getChannelData(0))};var r=window.OfflineAudioContext||window.webkitOfflineAudioContext;function n(e){return e.sort((function(e,t){return t.count-e.count})).splice(0,5)[0].tempo}function a(e){for(var t=[],i=.9;t.length<15&&i>=.3;)t=s(e,i),i-=.05;if(t.length<15)throw new Error("Could not find enough samples for a reliable detection.");return t}function s(e,t){for(var i=[],r=0,n=e.length;r<n;r+=1)e[r]>t&&(i.push(r),r+=1e4);return i}function o(e){var t=[];return e.forEach((function(i,r){for(var n=function(n){var a=e[r+n]-i;t.some((function(e){if(e.interval===a)return e.count+=1}))||t.push({interval:a,count:1})},a=0;a<10;a+=1)n(a)})),t}function l(e){return function(t){var i=[];return t.forEach((function(t){if(0!==t.interval){for(var r=60/(t.interval/e);r<90;)r*=2;for(;r>180;)r/=2;r=Math.round(r),i.some((function(e){if(e.tempo===r)return e.count+=t.count}))||i.push({tempo:r,count:t.count})}})),i}}},{}],2:[function(e,t,i){t.exports=e("./detect").default},{"./detect":1}]},{},[2])(2)})),window.Waveform={},function(e){"use strict";Waveform=function(e){this.data=[],this.peaks=[],this.wrap=null,this.progress=null,this.wave=null,this.waveme=null,this.percent=0,this.options=this._extends({},this._options,e),"string"==typeof this.options.duration&&this.options.duration.indexOf(":")>-1&&(this.options.duration=this.timeToMS(this.options.duration)),this.init()},Waveform.prototype={_options:{id:Math.random().toString(32).substring(2),rtl:"rtl"==getComputedStyle(document.body).direction,barSpacing:1,barWidth:2,barHeight:50,padding:20,barRadius:0,waveLength:180,sampleLength:1800,color:"rgba(160,160,160,0.4)",progressColor:!1,cursorColor:"currentColor",width:300,height:40,duration:0,align:"bottom"},_extends:function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e},init:function(){var t=this;t.container="string"==typeof t.options.container?document.querySelector(t.options.container):t.options.container,t.container&&(t.wrap=e('<div class="waveform_wrap" data-id="'+t.options.id+'" style="position:relative;"></div>'),t.wrap.css("height",t.options.height+"px"),t.progress=e('<div class="waveform_progress" style="position:absolute;width:0;height:100%;overflow:hidden;border-right:0.5px solid transparent">'),t.wave=t.createWave(),t.wrap.append(t.wave).appendTo(t.container),t.waveme=t.createWave(),t.progress.append(t.waveme).appendTo(t.wrap),t.wrap.append('<span class="waveform-time" style="position:absolute;height:100%;width:100%;display:flex;align-items:'+t.getAlign()+'"><span class="waveform-elapsed"></span><span class="waveform-duration"></span></span>'),t.wrap.find(".waveform-duration").html(t.msToTime(t.options.duration)),t.initEvents())},createWave:function(){var e=document.createElement("canvas");return e.style.position="absolute",e.style.height="100%",e.width=2*this.options.width,e.height=2*this.options.height,e},clearWave:function(){var e=this.wave.getContext("2d");e.clearRect(0,0,e.canvas.width,e.canvas.height);var t=this.waveme.getContext("2d");t.clearRect(0,0,t.canvas.width,t.canvas.height)},drawWave:function(){if(0!=this.data.length&&this.container){this.options.width=parseInt(this.wrap.width()),this.wave.width=this.waveme.width=2*this.options.width,this.wave.style.width=this.waveme.style.width=this.options.width+"px",this.clearWave(),this.prepareData();var t=this.options.progressColor?this.options.progressColor:e(this.container).css("borderTopColor");this.draw(this.wave.getContext("2d")),this.draw(this.waveme.getContext("2d"),t)}},draw:function(e,t,i){var r=this.peaks,n=r.length,a=this.wave.height,s=Math.round(n*(i||1)),o=0,l=0,d=0,u=2*this.options.barWidth;e.fillStyle=t||this.options.color;for(var c=0;c<s;c++){switch(o=c*(2*this.options.barSpacing+u),this.options.rtl&&(o=2*this.options.width-o),d=r[c],this.options.align){case"top":l=0;break;case"middle":l=Math.ceil((a-r[c])/2);break;case"center":e.setTransform(1,0,0,1,this.wave.width/2,this.wave.height/2),e.rotate(2*c*Math.PI/n-Math.PI/2),e.translate(0,(this.wave.height-2*this.options.barHeight)/2),o=-this.options.barWidth/2,l=0;break;default:l=a-r[c]}e.save(),this.options.barRadius>0?this.drawRoundRect(e,o,l,u,d,this.options.barRadius):e.fillRect(o,l,u,d),e.restore()}},drawRoundRect:function(e,t,i,r,n,a){0!==n&&(e.beginPath(),e.moveTo(t+a,i),e.lineTo(t+r-a,i),e.quadraticCurveTo(t+r,i,t+r,i+a),e.lineTo(t+r,i+n-a),e.quadraticCurveTo(t+r,i+n,t+r-a,i+n),e.lineTo(t+a.bl,i+n),e.quadraticCurveTo(t,i+n,t,i+n-a),e.lineTo(t,i+a),e.quadraticCurveTo(t,i,t+a,i),e.closePath(),e.fill())},prepareData:function(){var e=this.options.width,t=2*this.options.height-this.options.padding;"center"==this.options.align&&(e=(this.options.height-2*this.options.barHeight)*Math.PI,t=this.options.barHeight);var i=Math.max.apply(null,this.data)/t;this.peaks=this.data.map((function(e){return Math.round(e/i)}));var r=Math.round(e/(this.options.barWidth+this.options.barSpacing));this.peaks=this.resizeData(this.peaks,r)},resizeData:function(e,t){var i=e.length-t,r=(e.length-1)/t,n=[],a=0,s=0;if(0==i)return e;for(var o=0;o<t;o++)if(a=Math.round(o*r),i<0)s=s==a?0:a,n[o]=s>0?n[o-1]+Math.round((e[a]-e[a-1])*r):e[a];else{for(var l=0,d=0;d<Math.round(r);d++){var u=e[a+d];u>l&&(l=u)}n[o]=l}return n},initEvents:function(){var t,i=this;window.addEventListener("resize",(function(){clearTimeout(t),t=setTimeout((function(){i.options.width=i.wrap.width(),i.drawWave()}),500)})),this.wrap.on("click",(function(e){var t=i.getPercent(e);i.wrap.trigger("update",[t,i.options.id])})),this.wrap.on("timeupdate",(function(e,t,r){i.update(t,r)})),e(document).trigger("waveform:ready",[this])},update:function(e,t){var i=this,r=.5;i.updateTime(e),i.progress.css("width",100*e+"%"),i.progress.css("border-right-color",0==e?"transparent":i.options.cursorColor),(Math.abs(e-i.percent)>.02||0==e||t)&&(r=.1),e>.99&&(r=.2),1==e&&setTimeout((function(){i.update(0)}),200),i.progress.css("transition","width "+r+"s linear"),i.percent=e},drawTime:function(){this.wrap.find(".waveform-duration").html(this.msToTime(this.options.duration)),this.updateTime(0)},updateTime:function(e){var t=this.options.duration*e,i=this.msToTime(t);this.wrap.find(".waveform-elapsed").html(i)},load:function(e){var t=this;"string"!=typeof e?(t.data=e,setTimeout((function(){t.drawWave()}),100),t.drawTime()):this.loadAudioData(e)},loadAudioData:function(e,t){var i=this,r=new XMLHttpRequest;r.open("GET",e,!0),r.responseType="arraybuffer",r.onload=function(){(new(window.AudioContext||window.webkitAudioContext)).decodeAudioData(r.response,(function(e){i.options.duration=1e3*e.duration,i.data=e.data=i.parsePeaks(e);try{e.bpm=DetectBPM(e)}catch(e){}i.container&&i.load(i.data),t&&t(e)}))},r.send()},parsePeaks:function(e){for(var t=this.options.sampleLength,i=e.length/t,r=~~(i/10)||1,n=e.numberOfChannels,a=[],s=!0,o=0;o<n;o++)for(var l=e.getChannelData(o),d=0;d<t;d++){for(var u=~~(d*i),c=~~(u+i),h=0,f=u;f<c;f+=r){var p=Math.abs(l[f]);p>h&&(h=p)}(0==o||h>a[d])&&(a[d]=Math.round(100*h),h>0&&(s=!1))}return s?[]:this.resizeData(a,this.options.waveLength)},msToTime:function(e,t){if(""==e&&0!=e)return"";var i=parseInt(e%1e3),r=parseInt(e/1e3%60),n=parseInt(e/6e4%60),a=parseInt(e/36e5%24);r=r<10?"0"+r:r,n=n<10?"0"+n:n;var s="";return t&&(s=":"+(i<10?"00"+i:i<100?"0"+i:i)),""!=a?(a=a<10?"0"+a:a)+":"+n+":"+r+s:n+":"+r+s},timeToMS:function(e){var t=e.match(/[0-9]+[HMS]/g);if(t){var i=0;return t.forEach((function(e){var t=e.charAt(e.length-1),r=parseInt(e.slice(0,-1));switch(t){case"H":i+=60*r*60;break;case"M":i+=60*r;break;case"S":i+=r}})),1e3*i}var r=e.split(":");return 1==r.length?1e3*Number(r[0]):2==r.length?60*Number(r[0])*1e3+1e3*Number(r[1]):60*Number(r[0])*60*1e3+60*Number(r[1])*1e3+1e3*Number(r[2])},getAlign:function(){var e="flex-end";switch(this.options.align){case"top":e="flex-start";break;case"middle":e="center"}return e},getPercent:function(e){var t=this,i=0,r=t.wrap[0].getBoundingClientRect(),n=e.targetTouches?e.targetTouches[0].clientX:e.clientX,a=n-r.left;if(t.options.rtl&&(a=t.options.width-a),i=(a/t.options.width).toFixed(6),"center"==t.options.align){var s=(e.targetTouches?e.targetTouches[0].clientY:e.clientY)-r.top,o=n-r.left,l=s-t.options.height/4,d=o-t.options.width/2,u=Math.atan2(l,d);(u*=180/Math.PI)<0&&(u=360+u),i=(u/360).toFixed(6)}return i<0&&(i=0),i>1&&(i=1),i}}}(jQuery),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.Popper=t()}(this,(function(){"use strict";function e(e){return e&&"[object Function]"==={}.toString.call(e)}function t(e,t){if(1!==e.nodeType)return[];var i=e.ownerDocument.defaultView.getComputedStyle(e,null);return t?i[t]:i}function i(e){return"HTML"===e.nodeName?e:e.parentNode||e.host}function r(e){if(!e)return document.body;switch(e.nodeName){case"HTML":case"BODY":return e.ownerDocument.body;case"#document":return e.body}var n=t(e),a=n.overflow,s=n.overflowX,o=n.overflowY;return/(auto|scroll|overlay)/.test(a+o+s)?e:r(i(e))}function n(e){return e&&e.referenceNode?e.referenceNode:e}function a(e){return 11===e?X:10===e?Q:X||Q}function s(e){if(!e)return document.documentElement;for(var i=a(10)?document.body:null,r=e.offsetParent||null;r===i&&e.nextElementSibling;)r=(e=e.nextElementSibling).offsetParent;var n=r&&r.nodeName;return n&&"BODY"!==n&&"HTML"!==n?-1!==["TH","TD","TABLE"].indexOf(r.nodeName)&&"static"===t(r,"position")?s(r):r:e?e.ownerDocument.documentElement:document.documentElement}function o(e){return null===e.parentNode?e:o(e.parentNode)}function l(e,t){if(!(e&&e.nodeType&&t&&t.nodeType))return document.documentElement;var i=e.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_FOLLOWING,r=i?e:t,n=i?t:e,a=document.createRange();a.setStart(r,0),a.setEnd(n,0);var d=a.commonAncestorContainer;if(e!==d&&t!==d||r.contains(n))return function(e){var t=e.nodeName;return"BODY"!==t&&("HTML"===t||s(e.firstElementChild)===e)}(d)?d:s(d);var u=o(e);return u.host?l(u.host,t):l(e,o(t).host)}function d(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"top",i="top"===t?"scrollTop":"scrollLeft",r=e.nodeName;if("BODY"===r||"HTML"===r){var n=e.ownerDocument.documentElement,a=e.ownerDocument.scrollingElement||n;return a[i]}return e[i]}function u(e,t){var i=2<arguments.length&&void 0!==arguments[2]&&arguments[2],r=d(t,"top"),n=d(t,"left"),a=i?-1:1;return e.top+=r*a,e.bottom+=r*a,e.left+=n*a,e.right+=n*a,e}function c(e,t){var i="x"===t?"Left":"Top",r="Left"==i?"Right":"Bottom";return parseFloat(e["border"+i+"Width"])+parseFloat(e["border"+r+"Width"])}function h(e,t,i,r){return W(t["offset"+e],t["scroll"+e],i["client"+e],i["offset"+e],i["scroll"+e],a(10)?parseInt(i["offset"+e])+parseInt(r["margin"+("Height"===e?"Top":"Left")])+parseInt(r["margin"+("Height"===e?"Bottom":"Right")]):0)}function f(e){var t=e.body,i=e.documentElement,r=a(10)&&getComputedStyle(i);return{height:h("Height",t,i,r),width:h("Width",t,i,r)}}function p(e){return te({},e,{right:e.left+e.width,bottom:e.top+e.height})}function m(e){var i={};try{if(a(10)){i=e.getBoundingClientRect();var r=d(e,"top"),n=d(e,"left");i.top+=r,i.left+=n,i.bottom+=r,i.right+=n}else i=e.getBoundingClientRect()}catch(e){}var s={left:i.left,top:i.top,width:i.right-i.left,height:i.bottom-i.top},o="HTML"===e.nodeName?f(e.ownerDocument):{},l=o.width||e.clientWidth||s.width,u=o.height||e.clientHeight||s.height,h=e.offsetWidth-l,m=e.offsetHeight-u;if(h||m){var g=t(e);h-=c(g,"x"),m-=c(g,"y"),s.width-=h,s.height-=m}return p(s)}function g(e,i){var n=2<arguments.length&&void 0!==arguments[2]&&arguments[2],s=a(10),o="HTML"===i.nodeName,l=m(e),d=m(i),c=r(e),h=t(i),f=parseFloat(h.borderTopWidth),g=parseFloat(h.borderLeftWidth);n&&o&&(d.top=W(d.top,0),d.left=W(d.left,0));var v=p({top:l.top-d.top-f,left:l.left-d.left-g,width:l.width,height:l.height});if(v.marginTop=0,v.marginLeft=0,!s&&o){var y=parseFloat(h.marginTop),b=parseFloat(h.marginLeft);v.top-=f-y,v.bottom-=f-y,v.left-=g-b,v.right-=g-b,v.marginTop=y,v.marginLeft=b}return(s&&!n?i.contains(c):i===c&&"BODY"!==c.nodeName)&&(v=u(v,i)),v}function v(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1],i=e.ownerDocument.documentElement,r=g(e,i),n=W(i.clientWidth,window.innerWidth||0),a=W(i.clientHeight,window.innerHeight||0),s=t?0:d(i),o=t?0:d(i,"left"),l={top:s-r.top+r.marginTop,left:o-r.left+r.marginLeft,width:n,height:a};return p(l)}function y(e){var r=e.nodeName;if("BODY"===r||"HTML"===r)return!1;if("fixed"===t(e,"position"))return!0;var n=i(e);return!!n&&y(n)}function b(e){if(!e||!e.parentElement||a())return document.documentElement;for(var i=e.parentElement;i&&"none"===t(i,"transform");)i=i.parentElement;return i||document.documentElement}function w(e,t,a,s){var o=4<arguments.length&&void 0!==arguments[4]&&arguments[4],d={top:0,left:0},u=o?b(e):l(e,n(t));if("viewport"===s)d=v(u,o);else{var c;"scrollParent"===s?"BODY"===(c=r(i(t))).nodeName&&(c=e.ownerDocument.documentElement):c="window"===s?e.ownerDocument.documentElement:s;var h=g(c,u,o);if("HTML"!==c.nodeName||y(u))d=h;else{var p=f(e.ownerDocument),m=p.height,w=p.width;d.top+=h.top-h.marginTop,d.bottom=m+h.top,d.left+=h.left-h.marginLeft,d.right=w+h.left}}var _="number"==typeof(a=a||0);return d.left+=_?a:a.left||0,d.top+=_?a:a.top||0,d.right-=_?a:a.right||0,d.bottom-=_?a:a.bottom||0,d}function _(e){return e.width*e.height}function T(e,t,i,r,n){var a=5<arguments.length&&void 0!==arguments[5]?arguments[5]:0;if(-1===e.indexOf("auto"))return e;var s=w(i,r,a,n),o={top:{width:s.width,height:t.top-s.top},right:{width:s.right-t.right,height:s.height},bottom:{width:s.width,height:s.bottom-t.bottom},left:{width:t.left-s.left,height:s.height}},l=Object.keys(o).map((function(e){return te({key:e},o[e],{area:_(o[e])})})).sort((function(e,t){return t.area-e.area})),d=l.filter((function(e){var t=e.width,r=e.height;return t>=i.clientWidth&&r>=i.clientHeight})),u=0<d.length?d[0].key:l[0].key,c=e.split("-")[1];return u+(c?"-"+c:"")}function E(e,t,i){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null,a=r?b(t):l(t,n(i));return g(i,a,r)}function S(e){var t=e.ownerDocument.defaultView.getComputedStyle(e),i=parseFloat(t.marginTop||0)+parseFloat(t.marginBottom||0),r=parseFloat(t.marginLeft||0)+parseFloat(t.marginRight||0);return{width:e.offsetWidth+r,height:e.offsetHeight+i}}function k(e){var t={left:"right",right:"left",bottom:"top",top:"bottom"};return e.replace(/left|right|bottom|top/g,(function(e){return t[e]}))}function A(e,t,i){i=i.split("-")[0];var r=S(e),n={width:r.width,height:r.height},a=-1!==["right","left"].indexOf(i),s=a?"top":"left",o=a?"left":"top",l=a?"height":"width",d=a?"width":"height";return n[s]=t[s]+t[l]/2-r[l]/2,n[o]=i===o?t[o]-r[d]:t[k(o)],n}function C(e,t){return Array.prototype.find?e.find(t):e.filter(t)[0]}function R(t,i,r){return(void 0===r?t:t.slice(0,function(e,t,i){if(Array.prototype.findIndex)return e.findIndex((function(e){return e[t]===i}));var r=C(e,(function(e){return e[t]===i}));return e.indexOf(r)}(t,"name",r))).forEach((function(t){t.function&&console.warn("`modifier.function` is deprecated, use `modifier.fn`!");var r=t.function||t.fn;t.enabled&&e(r)&&(i.offsets.popper=p(i.offsets.popper),i.offsets.reference=p(i.offsets.reference),i=r(i,t))})),i}function L(){if(!this.state.isDestroyed){var e={instance:this,styles:{},arrowStyles:{},attributes:{},flipped:!1,offsets:{}};e.offsets.reference=E(this.state,this.popper,this.reference,this.options.positionFixed),e.placement=T(this.options.placement,e.offsets.reference,this.popper,this.reference,this.options.modifiers.flip.boundariesElement,this.options.modifiers.flip.padding),e.originalPlacement=e.placement,e.positionFixed=this.options.positionFixed,e.offsets.popper=A(this.popper,e.offsets.reference,e.placement),e.offsets.popper.position=this.options.positionFixed?"fixed":"absolute",e=R(this.modifiers,e),this.state.isCreated?this.options.onUpdate(e):(this.state.isCreated=!0,this.options.onCreate(e))}}function D(e,t){return e.some((function(e){var i=e.name;return e.enabled&&i===t}))}function x(e){for(var t=[!1,"ms","Webkit","Moz","O"],i=e.charAt(0).toUpperCase()+e.slice(1),r=0;r<t.length;r++){var n=t[r],a=n?""+n+i:e;if(void 0!==document.body.style[a])return a}return null}function O(){return this.state.isDestroyed=!0,D(this.modifiers,"applyStyle")&&(this.popper.removeAttribute("x-placement"),this.popper.style.position="",this.popper.style.top="",this.popper.style.left="",this.popper.style.right="",this.popper.style.bottom="",this.popper.style.willChange="",this.popper.style[x("transform")]=""),this.disableEventListeners(),this.options.removeOnDestroy&&this.popper.parentNode.removeChild(this.popper),this}function P(e){var t=e.ownerDocument;return t?t.defaultView:window}function I(e,t,i,n){var a="BODY"===e.nodeName,s=a?e.ownerDocument.defaultView:e;s.addEventListener(t,i,{passive:!0}),a||I(r(s.parentNode),t,i,n),n.push(s)}function M(e,t,i,n){i.updateBound=n,P(e).addEventListener("resize",i.updateBound,{passive:!0});var a=r(e);return I(a,"scroll",i.updateBound,i.scrollParents),i.scrollElement=a,i.eventsEnabled=!0,i}function N(){this.state.eventsEnabled||(this.state=M(this.reference,this.options,this.state,this.scheduleUpdate))}function F(){this.state.eventsEnabled&&(cancelAnimationFrame(this.scheduleUpdate),this.state=function(e,t){return P(e).removeEventListener("resize",t.updateBound),t.scrollParents.forEach((function(e){e.removeEventListener("scroll",t.updateBound)})),t.updateBound=null,t.scrollParents=[],t.scrollElement=null,t.eventsEnabled=!1,t}(this.reference,this.state))}function U(e){return""!==e&&!isNaN(parseFloat(e))&&isFinite(e)}function B(e,t){Object.keys(t).forEach((function(i){var r="";-1!==["width","height","top","right","bottom","left"].indexOf(i)&&U(t[i])&&(r="px"),e.style[i]=t[i]+r}))}function j(e,t,i){var r=C(e,(function(e){return e.name===t})),n=!!r&&e.some((function(e){return e.name===i&&e.enabled&&e.order<r.order}));if(!n){var a="`"+t+"`";console.warn("`"+i+"` modifier is required by "+a+" modifier in order to work, be sure to include it before "+a+"!")}return n}function $(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1],i=ne.indexOf(e),r=ne.slice(i+1).concat(ne.slice(0,i));return t?r.reverse():r}function H(e,t,i,r){var n=[0,0],a=-1!==["right","left"].indexOf(r),s=e.split(/(\+|\-)/).map((function(e){return e.trim()})),o=s.indexOf(C(s,(function(e){return-1!==e.search(/,|\s/)})));s[o]&&-1===s[o].indexOf(",")&&console.warn("Offsets separated by white space(s) are deprecated, use a comma (,) instead.");var l=/\s*,\s*|\s+/,d=-1===o?[s]:[s.slice(0,o).concat([s[o].split(l)[0]]),[s[o].split(l)[1]].concat(s.slice(o+1))];return(d=d.map((function(e,r){var n=(1===r?!a:a)?"height":"width",s=!1;return e.reduce((function(e,t){return""===e[e.length-1]&&-1!==["+","-"].indexOf(t)?(e[e.length-1]=t,s=!0,e):s?(e[e.length-1]+=t,s=!1,e):e.concat(t)}),[]).map((function(e){return function(e,t,i,r){var n=e.match(/((?:\-|\+)?\d*\.?\d*)(.*)/),a=+n[1],s=n[2];if(!a)return e;if(0===s.indexOf("%")){var o;switch(s){case"%p":o=i;break;case"%":case"%r":default:o=r}return p(o)[t]/100*a}return"vh"===s||"vw"===s?("vh"===s?W(document.documentElement.clientHeight,window.innerHeight||0):W(document.documentElement.clientWidth,window.innerWidth||0))/100*a:a}(e,n,t,i)}))}))).forEach((function(e,t){e.forEach((function(i,r){U(i)&&(n[t]+=i*("-"===e[r-1]?-1:1))}))})),n}var G=Math.min,q=Math.floor,K=Math.round,W=Math.max,V="undefined"!=typeof window&&"undefined"!=typeof document&&"undefined"!=typeof navigator,Y=function(){for(var e=["Edge","Trident","Firefox"],t=0;t<e.length;t+=1)if(V&&0<=navigator.userAgent.indexOf(e[t]))return 1;return 0}(),z=V&&window.Promise?function(e){var t=!1;return function(){t||(t=!0,window.Promise.resolve().then((function(){t=!1,e()})))}}:function(e){var t=!1;return function(){t||(t=!0,setTimeout((function(){t=!1,e()}),Y))}},X=V&&!(!window.MSInputMethodContext||!document.documentMode),Q=V&&/MSIE 10/.test(navigator.userAgent),J=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},Z=function(){function e(e,t){for(var i,r=0;r<t.length;r++)(i=t[r]).enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}return function(t,i,r){return i&&e(t.prototype,i),r&&e(t,r),t}}(),ee=function(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e},te=Object.assign||function(e){for(var t,i=1;i<arguments.length;i++)for(var r in t=arguments[i])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},ie=V&&/Firefox/i.test(navigator.userAgent),re=["auto-start","auto","auto-end","top-start","top","top-end","right-start","right","right-end","bottom-end","bottom","bottom-start","left-end","left","left-start"],ne=re.slice(3),ae="flip",se="clockwise",oe="counterclockwise",le=function(){function t(i,r){var n=this,a=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};J(this,t),this.scheduleUpdate=function(){return requestAnimationFrame(n.update)},this.update=z(this.update.bind(this)),this.options=te({},t.Defaults,a),this.state={isDestroyed:!1,isCreated:!1,scrollParents:[]},this.reference=i&&i.jquery?i[0]:i,this.popper=r&&r.jquery?r[0]:r,this.options.modifiers={},Object.keys(te({},t.Defaults.modifiers,a.modifiers)).forEach((function(e){n.options.modifiers[e]=te({},t.Defaults.modifiers[e]||{},a.modifiers?a.modifiers[e]:{})})),this.modifiers=Object.keys(this.options.modifiers).map((function(e){return te({name:e},n.options.modifiers[e])})).sort((function(e,t){return e.order-t.order})),this.modifiers.forEach((function(t){t.enabled&&e(t.onLoad)&&t.onLoad(n.reference,n.popper,n.options,t,n.state)})),this.update();var s=this.options.eventsEnabled;s&&this.enableEventListeners(),this.state.eventsEnabled=s}return Z(t,[{key:"update",value:function(){return L.call(this)}},{key:"destroy",value:function(){return O.call(this)}},{key:"enableEventListeners",value:function(){return N.call(this)}},{key:"disableEventListeners",value:function(){return F.call(this)}}]),t}();return le.Utils=("undefined"==typeof window?global:window).PopperUtils,le.placements=re,le.Defaults={placement:"bottom",positionFixed:!1,eventsEnabled:!0,removeOnDestroy:!1,onCreate:function(){},onUpdate:function(){},modifiers:{shift:{order:100,enabled:!0,fn:function(e){var t=e.placement,i=t.split("-")[0],r=t.split("-")[1];if(r){var n=e.offsets,a=n.reference,s=n.popper,o=-1!==["bottom","top"].indexOf(i),l=o?"left":"top",d=o?"width":"height",u={start:ee({},l,a[l]),end:ee({},l,a[l]+a[d]-s[d])};e.offsets.popper=te({},s,u[r])}return e}},offset:{order:200,enabled:!0,fn:function(e,t){var i,r=t.offset,n=e.placement,a=e.offsets,s=a.popper,o=a.reference,l=n.split("-")[0];return i=U(+r)?[+r,0]:H(r,s,o,l),"left"===l?(s.top+=i[0],s.left-=i[1]):"right"===l?(s.top+=i[0],s.left+=i[1]):"top"===l?(s.left+=i[0],s.top-=i[1]):"bottom"===l&&(s.left+=i[0],s.top+=i[1]),e.popper=s,e},offset:0},preventOverflow:{order:300,enabled:!0,fn:function(e,t){var i=t.boundariesElement||s(e.instance.popper);e.instance.reference===i&&(i=s(i));var r=x("transform"),n=e.instance.popper.style,a=n.top,o=n.left,l=n[r];n.top="",n.left="",n[r]="";var d=w(e.instance.popper,e.instance.reference,t.padding,i,e.positionFixed);n.top=a,n.left=o,n[r]=l,t.boundaries=d;var u=t.priority,c=e.offsets.popper,h={primary:function(e){var i=c[e];return c[e]<d[e]&&!t.escapeWithReference&&(i=W(c[e],d[e])),ee({},e,i)},secondary:function(e){var i="right"===e?"left":"top",r=c[i];return c[e]>d[e]&&!t.escapeWithReference&&(r=G(c[i],d[e]-("right"===e?c.width:c.height))),ee({},i,r)}};return u.forEach((function(e){var t=-1===["left","top"].indexOf(e)?"secondary":"primary";c=te({},c,h[t](e))})),e.offsets.popper=c,e},priority:["left","right","top","bottom"],padding:5,boundariesElement:"scrollParent"},keepTogether:{order:400,enabled:!0,fn:function(e){var t=e.offsets,i=t.popper,r=t.reference,n=e.placement.split("-")[0],a=q,s=-1!==["top","bottom"].indexOf(n),o=s?"right":"bottom",l=s?"left":"top",d=s?"width":"height";return i[o]<a(r[l])&&(e.offsets.popper[l]=a(r[l])-i[d]),i[l]>a(r[o])&&(e.offsets.popper[l]=a(r[o])),e}},arrow:{order:500,enabled:!0,fn:function(e,i){var r;if(!j(e.instance.modifiers,"arrow","keepTogether"))return e;var n=i.element;if("string"==typeof n){if(!(n=e.instance.popper.querySelector(n)))return e}else if(!e.instance.popper.contains(n))return console.warn("WARNING: `arrow.element` must be child of its popper element!"),e;var a=e.placement.split("-")[0],s=e.offsets,o=s.popper,l=s.reference,d=-1!==["left","right"].indexOf(a),u=d?"height":"width",c=d?"Top":"Left",h=c.toLowerCase(),f=d?"left":"top",m=d?"bottom":"right",g=S(n)[u];l[m]-g<o[h]&&(e.offsets.popper[h]-=o[h]-(l[m]-g)),l[h]+g>o[m]&&(e.offsets.popper[h]+=l[h]+g-o[m]),e.offsets.popper=p(e.offsets.popper);var v=l[h]+l[u]/2-g/2,y=t(e.instance.popper),b=parseFloat(y["margin"+c]),w=parseFloat(y["border"+c+"Width"]),_=v-e.offsets.popper[h]-b-w;return _=W(G(o[u]-g,_),0),e.arrowElement=n,e.offsets.arrow=(ee(r={},h,K(_)),ee(r,f,""),r),e},element:"[x-arrow]"},flip:{order:600,enabled:!0,fn:function(e,t){if(D(e.instance.modifiers,"inner"))return e;if(e.flipped&&e.placement===e.originalPlacement)return e;var i=w(e.instance.popper,e.instance.reference,t.padding,t.boundariesElement,e.positionFixed),r=e.placement.split("-")[0],n=k(r),a=e.placement.split("-")[1]||"",s=[];switch(t.behavior){case ae:s=[r,n];break;case se:s=$(r);break;case oe:s=$(r,!0);break;default:s=t.behavior}return s.forEach((function(o,l){if(r!==o||s.length===l+1)return e;r=e.placement.split("-")[0],n=k(r);var d=e.offsets.popper,u=e.offsets.reference,c=q,h="left"===r&&c(d.right)>c(u.left)||"right"===r&&c(d.left)<c(u.right)||"top"===r&&c(d.bottom)>c(u.top)||"bottom"===r&&c(d.top)<c(u.bottom),f=c(d.left)<c(i.left),p=c(d.right)>c(i.right),m=c(d.top)<c(i.top),g=c(d.bottom)>c(i.bottom),v="left"===r&&f||"right"===r&&p||"top"===r&&m||"bottom"===r&&g,y=-1!==["top","bottom"].indexOf(r),b=!!t.flipVariations&&(y&&"start"===a&&f||y&&"end"===a&&p||!y&&"start"===a&&m||!y&&"end"===a&&g),w=!!t.flipVariationsByContent&&(y&&"start"===a&&p||y&&"end"===a&&f||!y&&"start"===a&&g||!y&&"end"===a&&m),_=b||w;(h||v||_)&&(e.flipped=!0,(h||v)&&(r=s[l+1]),_&&(a=function(e){return"end"===e?"start":"start"===e?"end":e}(a)),e.placement=r+(a?"-"+a:""),e.offsets.popper=te({},e.offsets.popper,A(e.instance.popper,e.offsets.reference,e.placement)),e=R(e.instance.modifiers,e,"flip"))})),e},behavior:"flip",padding:5,boundariesElement:"viewport",flipVariations:!1,flipVariationsByContent:!1},inner:{order:700,enabled:!1,fn:function(e){var t=e.placement,i=t.split("-")[0],r=e.offsets,n=r.popper,a=r.reference,s=-1!==["left","right"].indexOf(i),o=-1===["top","left"].indexOf(i);return n[s?"left":"top"]=a[i]-(o?n[s?"width":"height"]:0),e.placement=k(t),e.offsets.popper=p(n),e}},hide:{order:800,enabled:!0,fn:function(e){if(!j(e.instance.modifiers,"hide","preventOverflow"))return e;var t=e.offsets.reference,i=C(e.instance.modifiers,(function(e){return"preventOverflow"===e.name})).boundaries;if(t.bottom<i.top||t.left>i.right||t.top>i.bottom||t.right<i.left){if(!0===e.hide)return e;e.hide=!0,e.attributes["x-out-of-boundaries"]=""}else{if(!1===e.hide)return e;e.hide=!1,e.attributes["x-out-of-boundaries"]=!1}return e}},computeStyle:{order:850,enabled:!0,fn:function(e,t){var i=t.x,r=t.y,n=e.offsets.popper,a=C(e.instance.modifiers,(function(e){return"applyStyle"===e.name})).gpuAcceleration;void 0!==a&&console.warn("WARNING: `gpuAcceleration` option moved to `computeStyle` modifier and will not be supported in future versions of Popper.js!");var o,l,d=void 0===a?t.gpuAcceleration:a,u=s(e.instance.popper),c=m(u),h={position:n.position},f=function(e,t){var i=e.offsets,r=i.popper,n=i.reference,a=K,s=function(e){return e},o=a(n.width),l=a(r.width),d=-1!==["left","right"].indexOf(e.placement),u=-1!==e.placement.indexOf("-"),c=t?d||u||o%2==l%2?a:q:s,h=t?a:s;return{left:c(1==o%2&&1==l%2&&!u&&t?r.left-1:r.left),top:h(r.top),bottom:h(r.bottom),right:c(r.right)}}(e,2>window.devicePixelRatio||!ie),p="bottom"===i?"top":"bottom",g="right"===r?"left":"right",v=x("transform");if(l="bottom"==p?"HTML"===u.nodeName?-u.clientHeight+f.bottom:-c.height+f.bottom:f.top,o="right"==g?"HTML"===u.nodeName?-u.clientWidth+f.right:-c.width+f.right:f.left,d&&v)h[v]="translate3d("+o+"px, "+l+"px, 0)",h[p]=0,h[g]=0,h.willChange="transform";else{var y="bottom"==p?-1:1,b="right"==g?-1:1;h[p]=l*y,h[g]=o*b,h.willChange=p+", "+g}var w={"x-placement":e.placement};return e.attributes=te({},w,e.attributes),e.styles=te({},h,e.styles),e.arrowStyles=te({},e.offsets.arrow,e.arrowStyles),e},gpuAcceleration:!0,x:"bottom",y:"right"},applyStyle:{order:900,enabled:!0,fn:function(e){return B(e.instance.popper,e.styles),function(e,t){Object.keys(t).forEach((function(i){!1===t[i]?e.removeAttribute(i):e.setAttribute(i,t[i])}))}(e.instance.popper,e.attributes),e.arrowElement&&Object.keys(e.arrowStyles).length&&B(e.arrowElement,e.arrowStyles),e},onLoad:function(e,t,i,r,n){var a=E(n,t,e,i.positionFixed),s=T(i.placement,a,t,e,i.modifiers.flip.boundariesElement,i.modifiers.flip.padding);return t.setAttribute("x-placement",s),B(t,{position:i.positionFixed?"fixed":"absolute"}),i},gpuAcceleration:void 0}}},le})),
/*!
  * Bootstrap util.js v4.6.2 (https://getbootstrap.com/)
  * Copyright 2011-2022 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */
function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("jquery")):"function"==typeof define&&define.amd?define(["jquery"],t):(e="undefined"!=typeof globalThis?globalThis:e||self).Util=t(e.jQuery)}(this,(function(e){"use strict";function t(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var i=t(e),r="transitionend";function n(e){var t=this,r=!1;return i.default(this).one(a.TRANSITION_END,(function(){r=!0})),setTimeout((function(){r||a.triggerTransitionEnd(t)}),e),this}var a={TRANSITION_END:"bsTransitionEnd",getUID:function(e){do{e+=~~(1e6*Math.random())}while(document.getElementById(e));return e},getSelectorFromElement:function(e){var t=e.getAttribute("data-target");if(!t||"#"===t){var i=e.getAttribute("href");t=i&&"#"!==i?i.trim():""}try{return document.querySelector(t)?t:null}catch(e){return null}},getTransitionDurationFromElement:function(e){if(!e)return 0;var t=i.default(e).css("transition-duration"),r=i.default(e).css("transition-delay"),n=parseFloat(t),a=parseFloat(r);return n||a?(t=t.split(",")[0],r=r.split(",")[0],1e3*(parseFloat(t)+parseFloat(r))):0},reflow:function(e){return e.offsetHeight},triggerTransitionEnd:function(e){i.default(e).trigger(r)},supportsTransitionEnd:function(){return Boolean(r)},isElement:function(e){return(e[0]||e).nodeType},typeCheckConfig:function(e,t,i){for(var r in i)if(Object.prototype.hasOwnProperty.call(i,r)){var n=i[r],s=t[r],o=s&&a.isElement(s)?"element":null==(l=s)?""+l:{}.toString.call(l).match(/\s([a-z]+)/i)[1].toLowerCase();if(!new RegExp(n).test(o))throw new Error(e.toUpperCase()+': Option "'+r+'" provided type "'+o+'" but expected type "'+n+'".')}var l},findShadowRoot:function(e){if(!document.documentElement.attachShadow)return null;if("function"==typeof e.getRootNode){var t=e.getRootNode();return t instanceof ShadowRoot?t:null}return e instanceof ShadowRoot?e:e.parentNode?a.findShadowRoot(e.parentNode):null},jQueryDetection:function(){if(void 0===i.default)throw new TypeError("Bootstrap's JavaScript requires jQuery. jQuery must be included before Bootstrap's JavaScript.");var e=i.default.fn.jquery.split(" ")[0].split(".");if(e[0]<2&&e[1]<9||1===e[0]&&9===e[1]&&e[2]<1||e[0]>=4)throw new Error("Bootstrap's JavaScript requires at least jQuery v1.9.1 but less than v4.0.0")}};return a.jQueryDetection(),i.default.fn.emulateTransitionEnd=n,i.default.event.special[a.TRANSITION_END]={bindType:r,delegateType:r,handle:function(e){if(i.default(e.target).is(this))return e.handleObj.handler.apply(this,arguments)}},a})),
/*!
  * Bootstrap modal.js v4.6.2 (https://getbootstrap.com/)
  * Copyright 2011-2022 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */
function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("jquery"),require("./util.js")):"function"==typeof define&&define.amd?define(["jquery","./util"],t):(e="undefined"!=typeof globalThis?globalThis:e||self).Modal=t(e.jQuery,e.Util)}(this,(function(e,t){"use strict";function i(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var r=i(e),n=i(t);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(){return(s=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e}).apply(this,arguments)}var o="modal",l="bs.modal",d=".bs.modal",u=r.default.fn.modal,c="modal-open",h="fade",f="show",p="modal-static",m="hidden.bs.modal",g="show.bs.modal",v="focusin.bs.modal",y="resize.bs.modal",b="click.dismiss.bs.modal",w="keydown.dismiss.bs.modal",_="mousedown.dismiss.bs.modal",T=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",E=".sticky-top",S={backdrop:!0,keyboard:!0,focus:!0,show:!0},k={backdrop:"(boolean|string)",keyboard:"boolean",focus:"boolean",show:"boolean"},A=function(){function e(e,t){this._config=this._getConfig(t),this._element=e,this._dialog=e.querySelector(".modal-dialog"),this._backdrop=null,this._isShown=!1,this._isBodyOverflowing=!1,this._ignoreBackdropClick=!1,this._isTransitioning=!1,this._scrollbarWidth=0}var t,i,u,A=e.prototype;return A.toggle=function(e){return this._isShown?this.hide():this.show(e)},A.show=function(e){var t=this;if(!this._isShown&&!this._isTransitioning){var i=r.default.Event(g,{relatedTarget:e});r.default(this._element).trigger(i),i.isDefaultPrevented()||(this._isShown=!0,r.default(this._element).hasClass(h)&&(this._isTransitioning=!0),this._checkScrollbar(),this._setScrollbar(),this._adjustDialog(),this._setEscapeEvent(),this._setResizeEvent(),r.default(this._element).on(b,'[data-dismiss="modal"]',(function(e){return t.hide(e)})),r.default(this._dialog).on(_,(function(){r.default(t._element).one("mouseup.dismiss.bs.modal",(function(e){r.default(e.target).is(t._element)&&(t._ignoreBackdropClick=!0)}))})),this._showBackdrop((function(){return t._showElement(e)})))}},A.hide=function(e){var t=this;if(e&&e.preventDefault(),this._isShown&&!this._isTransitioning){var i=r.default.Event("hide.bs.modal");if(r.default(this._element).trigger(i),this._isShown&&!i.isDefaultPrevented()){this._isShown=!1;var a=r.default(this._element).hasClass(h);if(a&&(this._isTransitioning=!0),this._setEscapeEvent(),this._setResizeEvent(),r.default(document).off(v),r.default(this._element).removeClass(f),r.default(this._element).off(b),r.default(this._dialog).off(_),a){var s=n.default.getTransitionDurationFromElement(this._element);r.default(this._element).one(n.default.TRANSITION_END,(function(e){return t._hideModal(e)})).emulateTransitionEnd(s)}else this._hideModal()}}},A.dispose=function(){[window,this._element,this._dialog].forEach((function(e){return r.default(e).off(d)})),r.default(document).off(v),r.default.removeData(this._element,l),this._config=null,this._element=null,this._dialog=null,this._backdrop=null,this._isShown=null,this._isBodyOverflowing=null,this._ignoreBackdropClick=null,this._isTransitioning=null,this._scrollbarWidth=null},A.handleUpdate=function(){this._adjustDialog()},A._getConfig=function(e){return e=s({},S,e),n.default.typeCheckConfig(o,e,k),e},A._triggerBackdropTransition=function(){var e=this,t=r.default.Event("hidePrevented.bs.modal");if(r.default(this._element).trigger(t),!t.isDefaultPrevented()){var i=this._element.scrollHeight>document.documentElement.clientHeight;i||(this._element.style.overflowY="hidden"),this._element.classList.add(p);var a=n.default.getTransitionDurationFromElement(this._dialog);r.default(this._element).off(n.default.TRANSITION_END),r.default(this._element).one(n.default.TRANSITION_END,(function(){e._element.classList.remove(p),i||r.default(e._element).one(n.default.TRANSITION_END,(function(){e._element.style.overflowY=""})).emulateTransitionEnd(e._element,a)})).emulateTransitionEnd(a),this._element.focus()}},A._showElement=function(e){var t=this,i=r.default(this._element).hasClass(h),a=this._dialog?this._dialog.querySelector(".modal-body"):null;this._element.parentNode&&this._element.parentNode.nodeType===Node.ELEMENT_NODE||document.body.appendChild(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),r.default(this._dialog).hasClass("modal-dialog-scrollable")&&a?a.scrollTop=0:this._element.scrollTop=0,i&&n.default.reflow(this._element),r.default(this._element).addClass(f),this._config.focus&&this._enforceFocus();var s=r.default.Event("shown.bs.modal",{relatedTarget:e}),o=function(){t._config.focus&&t._element.focus(),t._isTransitioning=!1,r.default(t._element).trigger(s)};if(i){var l=n.default.getTransitionDurationFromElement(this._dialog);r.default(this._dialog).one(n.default.TRANSITION_END,o).emulateTransitionEnd(l)}else o()},A._enforceFocus=function(){var e=this;r.default(document).off(v).on(v,(function(t){document!==t.target&&e._element!==t.target&&0===r.default(e._element).has(t.target).length&&e._element.focus()}))},A._setEscapeEvent=function(){var e=this;this._isShown?r.default(this._element).on(w,(function(t){e._config.keyboard&&27===t.which?(t.preventDefault(),e.hide()):e._config.keyboard||27!==t.which||e._triggerBackdropTransition()})):this._isShown||r.default(this._element).off(w)},A._setResizeEvent=function(){var e=this;this._isShown?r.default(window).on(y,(function(t){return e.handleUpdate(t)})):r.default(window).off(y)},A._hideModal=function(){var e=this;this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._showBackdrop((function(){r.default(document.body).removeClass(c),e._resetAdjustments(),e._resetScrollbar(),r.default(e._element).trigger(m)}))},A._removeBackdrop=function(){this._backdrop&&(r.default(this._backdrop).remove(),this._backdrop=null)},A._showBackdrop=function(e){var t=this,i=r.default(this._element).hasClass(h)?h:"";if(this._isShown&&this._config.backdrop){if(this._backdrop=document.createElement("div"),this._backdrop.className="modal-backdrop",i&&this._backdrop.classList.add(i),r.default(this._backdrop).appendTo(this._element),r.default(this._element).on(b,(function(e){t._ignoreBackdropClick?t._ignoreBackdropClick=!1:e.target!==e.currentTarget&&e.target!==t._backdrop||("static"===t._config.backdrop?t._triggerBackdropTransition():t.hide())})),i&&n.default.reflow(this._backdrop),r.default(this._backdrop).addClass(f),!e)return;if(!i)return void e();var a=n.default.getTransitionDurationFromElement(this._backdrop);r.default(this._backdrop).one(n.default.TRANSITION_END,e).emulateTransitionEnd(a)}else if(!this._isShown&&this._backdrop){r.default(this._backdrop).removeClass(f);var s=function(){t._removeBackdrop(),e&&e()};if(r.default(this._element).hasClass(h)){var o=n.default.getTransitionDurationFromElement(this._backdrop);r.default(this._backdrop).one(n.default.TRANSITION_END,s).emulateTransitionEnd(o)}else s()}else e&&e()},A._adjustDialog=function(){var e=this._element.scrollHeight>document.documentElement.clientHeight;!this._isBodyOverflowing&&e&&(this._element.style.paddingLeft=this._scrollbarWidth+"px"),this._isBodyOverflowing&&!e&&(this._element.style.paddingRight=this._scrollbarWidth+"px")},A._resetAdjustments=function(){this._element.style.paddingLeft="",this._element.style.paddingRight=""},A._checkScrollbar=function(){var e=document.body.getBoundingClientRect();this._isBodyOverflowing=Math.round(e.left+e.right)<window.innerWidth,this._scrollbarWidth=this._getScrollbarWidth()},A._setScrollbar=function(){var e=this;if(this._isBodyOverflowing){var t=[].slice.call(document.querySelectorAll(T)),i=[].slice.call(document.querySelectorAll(E));r.default(t).each((function(t,i){var n=i.style.paddingRight,a=r.default(i).css("padding-right");r.default(i).data("padding-right",n).css("padding-right",parseFloat(a)+e._scrollbarWidth+"px")})),r.default(i).each((function(t,i){var n=i.style.marginRight,a=r.default(i).css("margin-right");r.default(i).data("margin-right",n).css("margin-right",parseFloat(a)-e._scrollbarWidth+"px")}));var n=document.body.style.paddingRight,a=r.default(document.body).css("padding-right");r.default(document.body).data("padding-right",n).css("padding-right",parseFloat(a)+this._scrollbarWidth+"px")}r.default(document.body).addClass(c)},A._resetScrollbar=function(){var e=[].slice.call(document.querySelectorAll(T));r.default(e).each((function(e,t){var i=r.default(t).data("padding-right");r.default(t).removeData("padding-right"),t.style.paddingRight=i||""}));var t=[].slice.call(document.querySelectorAll(".sticky-top"));r.default(t).each((function(e,t){var i=r.default(t).data("margin-right");void 0!==i&&r.default(t).css("margin-right",i).removeData("margin-right")}));var i=r.default(document.body).data("padding-right");r.default(document.body).removeData("padding-right"),document.body.style.paddingRight=i||""},A._getScrollbarWidth=function(){var e=document.createElement("div");e.className="modal-scrollbar-measure",document.body.appendChild(e);var t=e.getBoundingClientRect().width-e.clientWidth;return document.body.removeChild(e),t},e._jQueryInterface=function(t,i){return this.each((function(){var n=r.default(this).data(l),a=s({},S,r.default(this).data(),"object"==typeof t&&t?t:{});if(n||(n=new e(this,a),r.default(this).data(l,n)),"string"==typeof t){if(void 0===n[t])throw new TypeError('No method named "'+t+'"');n[t](i)}else a.show&&n.show(i)}))},t=e,u=[{key:"VERSION",get:function(){return"4.6.2"}},{key:"Default",get:function(){return S}}],(i=null)&&a(t.prototype,i),u&&a(t,u),Object.defineProperty(t,"prototype",{writable:!1}),e}();return r.default(document).on("click.bs.modal.data-api",'[data-toggle="modal"]',(function(e){var t,i=this,a=n.default.getSelectorFromElement(this);a&&(t=document.querySelector(a));var o=r.default(t).data(l)?"toggle":s({},r.default(t).data(),r.default(this).data());"A"!==this.tagName&&"AREA"!==this.tagName||e.preventDefault();var d=r.default(t).one(g,(function(e){e.isDefaultPrevented()||d.one(m,(function(){r.default(i).is(":visible")&&i.focus()}))}));A._jQueryInterface.call(r.default(t),o,this)})),r.default.fn.modal=A._jQueryInterface,r.default.fn.modal.Constructor=A,r.default.fn.modal.noConflict=function(){return r.default.fn.modal=u,A._jQueryInterface},A})),
/*!
  * Bootstrap dropdown.js v4.6.2 (https://getbootstrap.com/)
  * Copyright 2011-2022 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */
function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("jquery"),require("popper.js"),require("./util.js")):"function"==typeof define&&define.amd?define(["jquery","popper.js","./util"],t):(e="undefined"!=typeof globalThis?globalThis:e||self).Dropdown=t(e.jQuery,e.Popper,e.Util)}(this,(function(e,t,i){"use strict";function r(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var n=r(e),a=r(t),s=r(i);function o(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(){return(l=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e}).apply(this,arguments)}var d="dropdown",u="bs.dropdown",c="."+u,h=n.default.fn[d],f=new RegExp("38|40|27"),p="disabled",m="show",g="dropdown-menu-right",v="hide"+c,y="hidden"+c,b="click.bs.dropdown.data-api",w="keydown.bs.dropdown.data-api",_='[data-toggle="dropdown"]',T=".dropdown-menu",E={offset:0,flip:!0,boundary:"scrollParent",reference:"toggle",display:"dynamic",popperConfig:null},S={offset:"(number|string|function)",flip:"boolean",boundary:"(string|element)",reference:"(string|element)",display:"string",popperConfig:"(null|object)"},k=function(){function e(e,t){this._element=e,this._popper=null,this._config=this._getConfig(t),this._menu=this._getMenuElement(),this._inNavbar=this._detectNavbar(),this._addEventListeners()}var t,i,r,h=e.prototype;return h.toggle=function(){if(!this._element.disabled&&!n.default(this._element).hasClass(p)){var t=n.default(this._menu).hasClass(m);e._clearMenus(),t||this.show(!0)}},h.show=function(t){if(void 0===t&&(t=!1),!(this._element.disabled||n.default(this._element).hasClass(p)||n.default(this._menu).hasClass(m))){var i={relatedTarget:this._element},r=n.default.Event("show.bs.dropdown",i),o=e._getParentFromElement(this._element);if(n.default(o).trigger(r),!r.isDefaultPrevented()){if(!this._inNavbar&&t){if(void 0===a.default)throw new TypeError("Bootstrap's dropdowns require Popper (https://popper.js.org)");var l=this._element;"parent"===this._config.reference?l=o:s.default.isElement(this._config.reference)&&(l=this._config.reference,void 0!==this._config.reference.jquery&&(l=this._config.reference[0])),"scrollParent"!==this._config.boundary&&n.default(o).addClass("position-static"),this._popper=new a.default(l,this._menu,this._getPopperConfig())}"ontouchstart"in document.documentElement&&0===n.default(o).closest(".navbar-nav").length&&n.default(document.body).children().on("mouseover",null,n.default.noop),this._element.focus(),this._element.setAttribute("aria-expanded",!0),n.default(this._menu).toggleClass(m),n.default(o).toggleClass(m).trigger(n.default.Event("shown.bs.dropdown",i))}}},h.hide=function(){if(!this._element.disabled&&!n.default(this._element).hasClass(p)&&n.default(this._menu).hasClass(m)){var t={relatedTarget:this._element},i=n.default.Event(v,t),r=e._getParentFromElement(this._element);n.default(r).trigger(i),i.isDefaultPrevented()||(this._popper&&this._popper.destroy(),n.default(this._menu).toggleClass(m),n.default(r).toggleClass(m).trigger(n.default.Event(y,t)))}},h.dispose=function(){n.default.removeData(this._element,u),n.default(this._element).off(c),this._element=null,this._menu=null,null!==this._popper&&(this._popper.destroy(),this._popper=null)},h.update=function(){this._inNavbar=this._detectNavbar(),null!==this._popper&&this._popper.scheduleUpdate()},h._addEventListeners=function(){var e=this;n.default(this._element).on("click.bs.dropdown",(function(t){t.preventDefault(),t.stopPropagation(),e.toggle()}))},h._getConfig=function(e){return e=l({},this.constructor.Default,n.default(this._element).data(),e),s.default.typeCheckConfig(d,e,this.constructor.DefaultType),e},h._getMenuElement=function(){if(!this._menu){var t=e._getParentFromElement(this._element);t&&(this._menu=t.querySelector(T))}return this._menu},h._getPlacement=function(){var e=n.default(this._element.parentNode),t="bottom-start";return e.hasClass("dropup")?t=n.default(this._menu).hasClass(g)?"top-end":"top-start":e.hasClass("dropright")?t="right-start":e.hasClass("dropleft")?t="left-start":n.default(this._menu).hasClass(g)&&(t="bottom-end"),t},h._detectNavbar=function(){return n.default(this._element).closest(".navbar").length>0},h._getOffset=function(){var e=this,t={};return"function"==typeof this._config.offset?t.fn=function(t){return t.offsets=l({},t.offsets,e._config.offset(t.offsets,e._element)),t}:t.offset=this._config.offset,t},h._getPopperConfig=function(){var e={placement:this._getPlacement(),modifiers:{offset:this._getOffset(),flip:{enabled:this._config.flip},preventOverflow:{boundariesElement:this._config.boundary}}};return"static"===this._config.display&&(e.modifiers.applyStyle={enabled:!1}),l({},e,this._config.popperConfig)},e._jQueryInterface=function(t){return this.each((function(){var i=n.default(this).data(u);if(i||(i=new e(this,"object"==typeof t?t:null),n.default(this).data(u,i)),"string"==typeof t){if(void 0===i[t])throw new TypeError('No method named "'+t+'"');i[t]()}}))},e._clearMenus=function(t){if(!t||3!==t.which&&("keyup"!==t.type||9===t.which))for(var i=[].slice.call(document.querySelectorAll(_)),r=0,a=i.length;r<a;r++){var s=e._getParentFromElement(i[r]),o=n.default(i[r]).data(u),l={relatedTarget:i[r]};if(t&&"click"===t.type&&(l.clickEvent=t),o){var d=o._menu;if(n.default(s).hasClass(m)&&!(t&&("click"===t.type&&/input|textarea/i.test(t.target.tagName)||"keyup"===t.type&&9===t.which)&&n.default.contains(s,t.target))){var c=n.default.Event(v,l);n.default(s).trigger(c),c.isDefaultPrevented()||("ontouchstart"in document.documentElement&&n.default(document.body).children().off("mouseover",null,n.default.noop),i[r].setAttribute("aria-expanded","false"),o._popper&&o._popper.destroy(),n.default(d).removeClass(m),n.default(s).removeClass(m).trigger(n.default.Event(y,l)))}}}},e._getParentFromElement=function(e){var t,i=s.default.getSelectorFromElement(e);return i&&(t=document.querySelector(i)),t||e.parentNode},e._dataApiKeydownHandler=function(t){if(!(/input|textarea/i.test(t.target.tagName)?32===t.which||27!==t.which&&(40!==t.which&&38!==t.which||n.default(t.target).closest(T).length):!f.test(t.which))&&!this.disabled&&!n.default(this).hasClass(p)){var i=e._getParentFromElement(this),r=n.default(i).hasClass(m);if(r||27!==t.which){if(t.preventDefault(),t.stopPropagation(),!r||27===t.which||32===t.which)return 27===t.which&&n.default(i.querySelector(_)).trigger("focus"),void n.default(this).trigger("click");var a=[].slice.call(i.querySelectorAll(".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)")).filter((function(e){return n.default(e).is(":visible")}));if(0!==a.length){var s=a.indexOf(t.target);38===t.which&&s>0&&s--,40===t.which&&s<a.length-1&&s++,s<0&&(s=0),a[s].focus()}}}},t=e,r=[{key:"VERSION",get:function(){return"4.6.2"}},{key:"Default",get:function(){return E}},{key:"DefaultType",get:function(){return S}}],(i=null)&&o(t.prototype,i),r&&o(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();return n.default(document).on(w,_,k._dataApiKeydownHandler).on(w,T,k._dataApiKeydownHandler).on(b+" keyup.bs.dropdown.data-api",k._clearMenus).on(b,_,(function(e){e.preventDefault(),e.stopPropagation(),k._jQueryInterface.call(n.default(this),"toggle")})).on(b,".dropdown form",(function(e){e.stopPropagation()})),n.default.fn[d]=k._jQueryInterface,n.default.fn[d].Constructor=k,n.default.fn[d].noConflict=function(){return n.default.fn[d]=h,k._jQueryInterface},k})),
/*!
  * Bootstrap tooltip.js v4.6.2 (https://getbootstrap.com/)
  * Copyright 2011-2022 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */
function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("jquery"),require("popper.js"),require("./util.js")):"function"==typeof define&&define.amd?define(["jquery","popper.js","./util"],t):(e="undefined"!=typeof globalThis?globalThis:e||self).Tooltip=t(e.jQuery,e.Popper,e.Util)}(this,(function(e,t,i){"use strict";function r(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var n=r(e),a=r(t),s=r(i);function o(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(){return(l=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e}).apply(this,arguments)}var d=["background","cite","href","itemtype","longdesc","poster","src","xlink:href"],u={"*":["class","dir","id","lang","role",/^aria-[\w-]*$/i],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],div:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},c=/^(?:(?:https?|mailto|ftp|tel|file|sms):|[^#&/:?]*(?:[#/?]|$))/i,h=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[\d+/a-z]+=*$/i;function f(e,t,i){if(0===e.length)return e;if(i&&"function"==typeof i)return i(e);for(var r=(new window.DOMParser).parseFromString(e,"text/html"),n=Object.keys(t),a=[].slice.call(r.body.querySelectorAll("*")),s=function(e,i){var r=a[e],s=r.nodeName.toLowerCase();if(-1===n.indexOf(r.nodeName.toLowerCase()))return r.parentNode.removeChild(r),"continue";var o=[].slice.call(r.attributes),l=[].concat(t["*"]||[],t[s]||[]);o.forEach((function(e){(function(e,t){var i=e.nodeName.toLowerCase();if(-1!==t.indexOf(i))return-1===d.indexOf(i)||Boolean(c.test(e.nodeValue)||h.test(e.nodeValue));for(var r=t.filter((function(e){return e instanceof RegExp})),n=0,a=r.length;n<a;n++)if(r[n].test(i))return!0;return!1})(e,l)||r.removeAttribute(e.nodeName)}))},o=0,l=a.length;o<l;o++)s(o);return r.body.innerHTML}var p="tooltip",m="bs.tooltip",g="."+m,v=n.default.fn[p],y=new RegExp("(^|\\s)bs-tooltip\\S+","g"),b=["sanitize","whiteList","sanitizeFn"],w="fade",_="show",T="show",E="out",S="hover",k="focus",A={AUTO:"auto",TOP:"top",RIGHT:"right",BOTTOM:"bottom",LEFT:"left"},C={animation:!0,template:'<div class="tooltip" role="tooltip"><div class="arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,selector:!1,placement:"top",offset:0,container:!1,fallbackPlacement:"flip",boundary:"scrollParent",customClass:"",sanitize:!0,sanitizeFn:null,whiteList:u,popperConfig:null},R={animation:"boolean",template:"string",title:"(string|element|function)",trigger:"string",delay:"(number|object)",html:"boolean",selector:"(string|boolean)",placement:"(string|function)",offset:"(number|string|function)",container:"(string|element|boolean)",fallbackPlacement:"(string|array)",boundary:"(string|element)",customClass:"(string|function)",sanitize:"boolean",sanitizeFn:"(null|function)",whiteList:"object",popperConfig:"(null|object)"},L={HIDE:"hide"+g,HIDDEN:"hidden"+g,SHOW:"show"+g,SHOWN:"shown"+g,INSERTED:"inserted"+g,CLICK:"click"+g,FOCUSIN:"focusin"+g,FOCUSOUT:"focusout"+g,MOUSEENTER:"mouseenter"+g,MOUSELEAVE:"mouseleave"+g},D=function(){function e(e,t){if(void 0===a.default)throw new TypeError("Bootstrap's tooltips require Popper (https://popper.js.org)");this._isEnabled=!0,this._timeout=0,this._hoverState="",this._activeTrigger={},this._popper=null,this.element=e,this.config=this._getConfig(t),this.tip=null,this._setListeners()}var t,i,r,d=e.prototype;return d.enable=function(){this._isEnabled=!0},d.disable=function(){this._isEnabled=!1},d.toggleEnabled=function(){this._isEnabled=!this._isEnabled},d.toggle=function(e){if(this._isEnabled)if(e){var t=this.constructor.DATA_KEY,i=n.default(e.currentTarget).data(t);i||(i=new this.constructor(e.currentTarget,this._getDelegateConfig()),n.default(e.currentTarget).data(t,i)),i._activeTrigger.click=!i._activeTrigger.click,i._isWithActiveTrigger()?i._enter(null,i):i._leave(null,i)}else{if(n.default(this.getTipElement()).hasClass(_))return void this._leave(null,this);this._enter(null,this)}},d.dispose=function(){clearTimeout(this._timeout),n.default.removeData(this.element,this.constructor.DATA_KEY),n.default(this.element).off(this.constructor.EVENT_KEY),n.default(this.element).closest(".modal").off("hide.bs.modal",this._hideModalHandler),this.tip&&n.default(this.tip).remove(),this._isEnabled=null,this._timeout=null,this._hoverState=null,this._activeTrigger=null,this._popper&&this._popper.destroy(),this._popper=null,this.element=null,this.config=null,this.tip=null},d.show=function(){var e=this;if("none"===n.default(this.element).css("display"))throw new Error("Please use show on visible elements");var t=n.default.Event(this.constructor.Event.SHOW);if(this.isWithContent()&&this._isEnabled){n.default(this.element).trigger(t);var i=s.default.findShadowRoot(this.element),r=n.default.contains(null!==i?i:this.element.ownerDocument.documentElement,this.element);if(t.isDefaultPrevented()||!r)return;var o=this.getTipElement(),l=s.default.getUID(this.constructor.NAME);o.setAttribute("id",l),this.element.setAttribute("aria-describedby",l),this.setContent(),this.config.animation&&n.default(o).addClass(w);var d="function"==typeof this.config.placement?this.config.placement.call(this,o,this.element):this.config.placement,u=this._getAttachment(d);this.addAttachmentClass(u);var c=this._getContainer();n.default(o).data(this.constructor.DATA_KEY,this),n.default.contains(this.element.ownerDocument.documentElement,this.tip)||n.default(o).appendTo(c),n.default(this.element).trigger(this.constructor.Event.INSERTED),this._popper=new a.default(this.element,o,this._getPopperConfig(u)),n.default(o).addClass(_),n.default(o).addClass(this.config.customClass),"ontouchstart"in document.documentElement&&n.default(document.body).children().on("mouseover",null,n.default.noop);var h=function(){e.config.animation&&e._fixTransition();var t=e._hoverState;e._hoverState=null,n.default(e.element).trigger(e.constructor.Event.SHOWN),t===E&&e._leave(null,e)};if(n.default(this.tip).hasClass(w)){var f=s.default.getTransitionDurationFromElement(this.tip);n.default(this.tip).one(s.default.TRANSITION_END,h).emulateTransitionEnd(f)}else h()}},d.hide=function(e){var t=this,i=this.getTipElement(),r=n.default.Event(this.constructor.Event.HIDE),a=function(){t._hoverState!==T&&i.parentNode&&i.parentNode.removeChild(i),t._cleanTipClass(),t.element.removeAttribute("aria-describedby"),n.default(t.element).trigger(t.constructor.Event.HIDDEN),null!==t._popper&&t._popper.destroy(),e&&e()};if(n.default(this.element).trigger(r),!r.isDefaultPrevented()){if(n.default(i).removeClass(_),"ontouchstart"in document.documentElement&&n.default(document.body).children().off("mouseover",null,n.default.noop),this._activeTrigger.click=!1,this._activeTrigger.focus=!1,this._activeTrigger.hover=!1,n.default(this.tip).hasClass(w)){var o=s.default.getTransitionDurationFromElement(i);n.default(i).one(s.default.TRANSITION_END,a).emulateTransitionEnd(o)}else a();this._hoverState=""}},d.update=function(){null!==this._popper&&this._popper.scheduleUpdate()},d.isWithContent=function(){return Boolean(this.getTitle())},d.addAttachmentClass=function(e){n.default(this.getTipElement()).addClass("bs-tooltip-"+e)},d.getTipElement=function(){return this.tip=this.tip||n.default(this.config.template)[0],this.tip},d.setContent=function(){var e=this.getTipElement();this.setElementContent(n.default(e.querySelectorAll(".tooltip-inner")),this.getTitle()),n.default(e).removeClass("fade show")},d.setElementContent=function(e,t){"object"!=typeof t||!t.nodeType&&!t.jquery?this.config.html?(this.config.sanitize&&(t=f(t,this.config.whiteList,this.config.sanitizeFn)),e.html(t)):e.text(t):this.config.html?n.default(t).parent().is(e)||e.empty().append(t):e.text(n.default(t).text())},d.getTitle=function(){var e=this.element.getAttribute("data-original-title");return e||(e="function"==typeof this.config.title?this.config.title.call(this.element):this.config.title),e},d._getPopperConfig=function(e){var t=this;return l({},{placement:e,modifiers:{offset:this._getOffset(),flip:{behavior:this.config.fallbackPlacement},arrow:{element:".arrow"},preventOverflow:{boundariesElement:this.config.boundary}},onCreate:function(e){e.originalPlacement!==e.placement&&t._handlePopperPlacementChange(e)},onUpdate:function(e){return t._handlePopperPlacementChange(e)}},this.config.popperConfig)},d._getOffset=function(){var e=this,t={};return"function"==typeof this.config.offset?t.fn=function(t){return t.offsets=l({},t.offsets,e.config.offset(t.offsets,e.element)),t}:t.offset=this.config.offset,t},d._getContainer=function(){return!1===this.config.container?document.body:s.default.isElement(this.config.container)?n.default(this.config.container):n.default(document).find(this.config.container)},d._getAttachment=function(e){return A[e.toUpperCase()]},d._setListeners=function(){var e=this;this.config.trigger.split(" ").forEach((function(t){if("click"===t)n.default(e.element).on(e.constructor.Event.CLICK,e.config.selector,(function(t){return e.toggle(t)}));else if("manual"!==t){var i=t===S?e.constructor.Event.MOUSEENTER:e.constructor.Event.FOCUSIN,r=t===S?e.constructor.Event.MOUSELEAVE:e.constructor.Event.FOCUSOUT;n.default(e.element).on(i,e.config.selector,(function(t){return e._enter(t)})).on(r,e.config.selector,(function(t){return e._leave(t)}))}})),this._hideModalHandler=function(){e.element&&e.hide()},n.default(this.element).closest(".modal").on("hide.bs.modal",this._hideModalHandler),this.config.selector?this.config=l({},this.config,{trigger:"manual",selector:""}):this._fixTitle()},d._fixTitle=function(){var e=typeof this.element.getAttribute("data-original-title");(this.element.getAttribute("title")||"string"!==e)&&(this.element.setAttribute("data-original-title",this.element.getAttribute("title")||""),this.element.setAttribute("title",""))},d._enter=function(e,t){var i=this.constructor.DATA_KEY;(t=t||n.default(e.currentTarget).data(i))||(t=new this.constructor(e.currentTarget,this._getDelegateConfig()),n.default(e.currentTarget).data(i,t)),e&&(t._activeTrigger["focusin"===e.type?k:S]=!0),n.default(t.getTipElement()).hasClass(_)||t._hoverState===T?t._hoverState=T:(clearTimeout(t._timeout),t._hoverState=T,t.config.delay&&t.config.delay.show?t._timeout=setTimeout((function(){t._hoverState===T&&t.show()}),t.config.delay.show):t.show())},d._leave=function(e,t){var i=this.constructor.DATA_KEY;(t=t||n.default(e.currentTarget).data(i))||(t=new this.constructor(e.currentTarget,this._getDelegateConfig()),n.default(e.currentTarget).data(i,t)),e&&(t._activeTrigger["focusout"===e.type?k:S]=!1),t._isWithActiveTrigger()||(clearTimeout(t._timeout),t._hoverState=E,t.config.delay&&t.config.delay.hide?t._timeout=setTimeout((function(){t._hoverState===E&&t.hide()}),t.config.delay.hide):t.hide())},d._isWithActiveTrigger=function(){for(var e in this._activeTrigger)if(this._activeTrigger[e])return!0;return!1},d._getConfig=function(e){var t=n.default(this.element).data();return Object.keys(t).forEach((function(e){-1!==b.indexOf(e)&&delete t[e]})),"number"==typeof(e=l({},this.constructor.Default,t,"object"==typeof e&&e?e:{})).delay&&(e.delay={show:e.delay,hide:e.delay}),"number"==typeof e.title&&(e.title=e.title.toString()),"number"==typeof e.content&&(e.content=e.content.toString()),s.default.typeCheckConfig(p,e,this.constructor.DefaultType),e.sanitize&&(e.template=f(e.template,e.whiteList,e.sanitizeFn)),e},d._getDelegateConfig=function(){var e={};if(this.config)for(var t in this.config)this.constructor.Default[t]!==this.config[t]&&(e[t]=this.config[t]);return e},d._cleanTipClass=function(){var e=n.default(this.getTipElement()),t=e.attr("class").match(y);null!==t&&t.length&&e.removeClass(t.join(""))},d._handlePopperPlacementChange=function(e){this.tip=e.instance.popper,this._cleanTipClass(),this.addAttachmentClass(this._getAttachment(e.placement))},d._fixTransition=function(){var e=this.getTipElement(),t=this.config.animation;null===e.getAttribute("x-placement")&&(n.default(e).removeClass(w),this.config.animation=!1,this.hide(),this.show(),this.config.animation=t)},e._jQueryInterface=function(t){return this.each((function(){var i=n.default(this),r=i.data(m),a="object"==typeof t&&t;if((r||!/dispose|hide/.test(t))&&(r||(r=new e(this,a),i.data(m,r)),"string"==typeof t)){if(void 0===r[t])throw new TypeError('No method named "'+t+'"');r[t]()}}))},t=e,r=[{key:"VERSION",get:function(){return"4.6.2"}},{key:"Default",get:function(){return C}},{key:"NAME",get:function(){return p}},{key:"DATA_KEY",get:function(){return m}},{key:"Event",get:function(){return L}},{key:"EVENT_KEY",get:function(){return g}},{key:"DefaultType",get:function(){return R}}],(i=null)&&o(t.prototype,i),r&&o(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();return n.default.fn[p]=D._jQueryInterface,n.default.fn[p].Constructor=D,n.default.fn[p].noConflict=function(){return n.default.fn[p]=v,D._jQueryInterface},D})),
/*!
  * Bootstrap popover.js v4.6.2 (https://getbootstrap.com/)
  * Copyright 2011-2022 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */
function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("jquery"),require("./tooltip.js")):"function"==typeof define&&define.amd?define(["jquery","./tooltip"],t):(e="undefined"!=typeof globalThis?globalThis:e||self).Popover=t(e.jQuery,e.Tooltip)}(this,(function(e,t){"use strict";function i(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var r=i(e),n=i(t);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(){return(s=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e}).apply(this,arguments)}function o(e,t){return(o=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var l="popover",d="bs.popover",u="."+d,c=r.default.fn[l],h=new RegExp("(^|\\s)bs-popover\\S+","g"),f=s({},n.default.Default,{placement:"right",trigger:"click",content:"",template:'<div class="popover" role="tooltip"><div class="arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>'}),p=s({},n.default.DefaultType,{content:"(string|element|function)"}),m={HIDE:"hide"+u,HIDDEN:"hidden"+u,SHOW:"show"+u,SHOWN:"shown"+u,INSERTED:"inserted"+u,CLICK:"click"+u,FOCUSIN:"focusin"+u,FOCUSOUT:"focusout"+u,MOUSEENTER:"mouseenter"+u,MOUSELEAVE:"mouseleave"+u},g=function(e){var t,i;function n(){return e.apply(this,arguments)||this}i=e,(t=n).prototype=Object.create(i.prototype),t.prototype.constructor=t,o(t,i);var s,c,g,v=n.prototype;return v.isWithContent=function(){return this.getTitle()||this._getContent()},v.addAttachmentClass=function(e){r.default(this.getTipElement()).addClass("bs-popover-"+e)},v.getTipElement=function(){return this.tip=this.tip||r.default(this.config.template)[0],this.tip},v.setContent=function(){var e=r.default(this.getTipElement());this.setElementContent(e.find(".popover-header"),this.getTitle());var t=this._getContent();"function"==typeof t&&(t=t.call(this.element)),this.setElementContent(e.find(".popover-body"),t),e.removeClass("fade show")},v._getContent=function(){return this.element.getAttribute("data-content")||this.config.content},v._cleanTipClass=function(){var e=r.default(this.getTipElement()),t=e.attr("class").match(h);null!==t&&t.length>0&&e.removeClass(t.join(""))},n._jQueryInterface=function(e){return this.each((function(){var t=r.default(this).data(d),i="object"==typeof e?e:null;if((t||!/dispose|hide/.test(e))&&(t||(t=new n(this,i),r.default(this).data(d,t)),"string"==typeof e)){if(void 0===t[e])throw new TypeError('No method named "'+e+'"');t[e]()}}))},s=n,g=[{key:"VERSION",get:function(){return"4.6.2"}},{key:"Default",get:function(){return f}},{key:"NAME",get:function(){return l}},{key:"DATA_KEY",get:function(){return d}},{key:"Event",get:function(){return m}},{key:"EVENT_KEY",get:function(){return u}},{key:"DefaultType",get:function(){return p}}],(c=null)&&a(s.prototype,c),g&&a(s,g),Object.defineProperty(s,"prototype",{writable:!1}),n}(n.default);return r.default.fn[l]=g._jQueryInterface,r.default.fn[l].Constructor=g,r.default.fn[l].noConflict=function(){return r.default.fn[l]=c,g._jQueryInterface},g})),function(e,t){"use strict";e.wp=e.wp||{},e.wp.hooks=e.wp.hooks||new function(){var e=Array.prototype.slice,t={removeFilter:function(e,i){"string"==typeof e&&r("filters",e,i);return t},applyFilters:function(){var i=e.call(arguments),r=i.shift();if("string"==typeof r)return a("filters",r,i);return t},addFilter:function(e,i,r,a){"string"==typeof e&&"function"==typeof r&&(a=parseInt(a||10,10),n("filters",e,i,r,a));return t},removeAction:function(e,i){"string"==typeof e&&r("actions",e,i);return t},doAction:function(){var i=e.call(arguments),r=i.shift();"string"==typeof r&&a("actions",r,i);return t},addAction:function(e,i,r,a){"string"==typeof e&&"function"==typeof r&&(a=parseInt(a||10,10),n("actions",e,i,r,a));return t}},i={actions:{},filters:{}};function r(e,t,r){var n,a;if(i[e][t])if(r)for(a=(n=i[e][t]).length;a--;)n[a].namespace===r&&n.splice(a,1);else i[e][t]=[]}function n(e,t,r,n,a){var s={callback:n,priority:a,namespace:r},o=i[e][t];o?(o.push(s),o=function(e){for(var t,i,r,n=1,a=e.length;n<a;n++){for(t=e[n],i=n;(r=e[i-1])&&r.priority>t.priority;)e[i]=e[i-1],--i;e[i]=t}return e}(o)):o=[s],i[e][t]=o}function a(e,t,r){var n,a,s=i[e][t];if(!s)return"filters"===e&&r[0];if(a=s.length,"filters"===e)for(n=0;n<a;n++)r[0]=s[n].callback.apply(s[n].namespace,r);else for(n=0;n<a;n++)s[n].callback.apply(s[n].namespace,r);return"filters"!==e||r[0]}return t}}(window),function($,window){"use strict";var upload={el:"#upload-modal",el_msg:".form-message",url:"",server:"",trigger:"",type:"",items:[],init:function(){var e=this;this.setUrl=this.setUrl.bind(this),this.sortable=this.sortable.bind(this),this.sortable(),$(document).on("click",'.form-validate input[type="submit"], #commentform input[type="submit"]',(function(t){var i=$(this).closest("form");e.validate(i)})),$(document).on("click",".btn-edit, .btn-upload",(function(t){if(t.preventDefault(),play.is_user_logged_in){e.items=[];var i=$(this).closest("[data-play-id]").attr("data-play-id");$(e.el).remove(),getModal(e.el,{name:"upload_form",post_id:i},e.sortable)}})),$(document).on("click",".track-list .remove",(function(t){$(this).parent().remove(),e.updateList()})),$(document).on("change",'input[type="file"]',(function(e){var t=$(this)[0];if(t.files&&t.files[0]){var i=t.files[0],r=$(this).parent().find("img");0==r.length&&(r=$("<img>"),$(this).next(".post-thumbnail").html(r));try{var n=new FileReader;n.onload=function(e){r.removeAttr("srcset"),r.attr("src",e.target.result)},n.readAsDataURL(i)}catch(e){}}})),$(document).on("change",'[name="stream_url"]',(function(t){$(this).val().match(/(http(s)?:\/\/.)?(www\.)?[-a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,6}\b([-a-zA-Z0-9@:%_\+.~#?&//=]*)/g)&&(e.url=$(this).val(),$(e.el).remove(),getModal(e.el,{name:"upload_form",form:!0},e.setUrl),$(this).val(""))})),$(document).on("dragover",".dragdrop-upload",(function(e){e.stopPropagation(),e.preventDefault(),$(this).addClass("dropover")})),$(document).on("drop",".dragdrop-upload",(function(t){t.stopPropagation(),t.preventDefault(),$(this).removeClass("dropover");for(var i=t.originalEvent.dataTransfer.files,r=[],n=["mp3","m4a","ogg","wav","mp4","m4v","mov","wmv","avi","mpg","ogv","3gp","3g2"],a=i.length-1;a>=0;a--)n.includes(i[a].name.split(".").pop())&&r.push(i[a]);r.length>0&&e.bulkUpload(r)})),$(document).on("change",'[name="stream_file"]',(function(t){e.trigger=$(this);var i=$(this)[0].files;e.bulkUpload(i)})),$(document).on("change",'[name="upload_file"]',(function(t){e.trigger=$(this),e.type="","single"==$(this).attr("data-type")&&(e.type="single");var i=$(this)[0].files[0];i.el=$(this).next(".progress"),i.title=i.name.replace(/\.[^/.]+$/,"").replace(/[\-_]/g," "),e.uploadFile(i)})),$(document).on("click",'#upload [type="submit"]',(function(t){t.preventDefault(),$(e.el_msg,e.el).html("");var i=$(this).closest("form"),r=[];if(e.items.length>1&&($(".track-list li").each((function(t){var i=$(this),n=i.attr("id"),a=e.getItem(n);r[t]={},r[t].title=i.find("input").val(),a&&(r[t].url=a.url,r[t].metadata=a.metadata,a.waveform&&(r[t].waveform=a.waveform.join(",")))})),!e.getUploaded(e.items)))return i.removeClass("processing"),i.find(".file-uploading").show(),!1;if(!e.validate(i))return!1;var n=new FormData(i[0]);return r.length&&n.append("tracks",JSON.stringify(r)),$.ajax({url:play.rest.endpoints.upload,data:n,type:"POST",processData:!1,contentType:!1,cache:!1,beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",play.nonce)}}).then((function(t){"success"==t.status?($(e.el_msg,i).first().append('<div class="success">'+t.msg+"</div>"),setTimeout((function(){var e=$(i).closest(".modal");e.length&&e.modal("hide"),t.redirect&&redirect(t.redirect)}),3e3)):"error"==t.status&&$(e.el_msg,i).first().append('<div class="error">'+t.msg+"</div>"),i.removeClass("processing")})),!1}))},bulkUpload:function(e){this.items=e,this.items.length>1?this.type="multiple":this.type="single",this.upload=this.upload.bind(this),$(this.el).remove(),getModal(this.el,{name:"upload_form",form:!0,type:this.items.length>1?"playlist":"single"},this.upload)},upload:function(){"single"==this.type&&$(".tracks").append('<ul class="track-list single"></ul>');for(var e=this.items.length-1;e>=0;e--)this.items[e].id=e,this.items[e].title=this.items[e].name.replace(/\.[^/.]+$/,"").replace(/[\-_]/g," "),this.items[e].el=$('<li id="'+e+'" class="input"><div class="progress"><div class="progress-bar"></div></div><span class="handle"></span><input class="track-list-title" value="'+this.items[e].title+'" /><span class="remove">×</span></div>'),$(".track-list").append(this.items[e].el),this.uploadFile(this.items[e],e);this.sortable()},uploadFile:function(e){var t=this;if(play.waveform){var i=new FileReader;i.onload=function(t){e.waveform=[];var i=new(window.AudioContext||window.webkitAudioContext);try{i.decodeAudioData(t.target.result,(function(t){var i=new Waveform;e.waveform=i.parsePeaks(t),e.bpm=DetectBPM(t)}))}catch(e){}},i.readAsArrayBuffer(e)}var r=new FormData;r.append("action","upload_stream"),r.append("file",e),e.uploading=!0,$(t.el_msg,t.el).html(""),$.ajax({url:play.rest.endpoints.upload_stream,type:"POST",data:r,processData:!1,contentType:!1,enctype:"multipart/form-data",beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",play.nonce)},xhr:function(){var t=$.ajaxSettings.xhr();return t.upload&&t.upload.addEventListener("progress",(function(t){if(t.lengthComputable){var i=t.loaded/t.total;i=parseInt(100*i),e.el&&e.el.find(".progress-bar").css("width",i+"%")}}),!1),t}}).then((function(i){e.el&&e.el.find(".progress-bar").css("width","0"),"success"==i.status?(e.url=i.url,e.metadata=i.metadata,t.setUpload(e)):"error"==i.status&&$(t.el_msg,t.el).first().append('<div class="error">'+i.msg+"</div>")})).always((function(){e.uploading=!1,t.items.length>1&&t.getUploaded(t.items)&&($(".file-uploading").hide(),$(".file-uploaded").show())}))},getUploaded:function(e){for(var t=!0,i=e.length-1;i>=0;i--)e[i].uploading&&(t=!1);return t},setUpload:function(e){if(this.trigger&&this.trigger.parent().hasClass("file-upload")&&this.trigger.parent().prev("input").val(e.url),"single"==this.type){var t=$(".form");t.find('[name="title"]').val(e.title),t.find('[name="stream"]').val(e.url),e.metadata.title&&t.find('[name="title"]').val(e.metadata.title),e.metadata.length_formatted&&t.find('[name="duration"]').val(e.metadata.length_formatted),e.metadata.artist&&t.find('[name="artist"]').val(e.metadata.artist),e.metadata.media_type&&t.append('<input type="hidden" name="media_type" value="'+e.metadata.media_type+'" />'),e.waveform&&e.waveform.length&&t.append('<input type="hidden" name="waveform" value="'+e.waveform.join(",")+'" />'),e.bpm&&t.append('<input type="hidden" name="bpm" value="'+e.bpm+'" />')}else e.metadata.title&&e.el.find(".track-list-title").val(e.metadata.title)},getItem:function(e){for(var t=0;t<this.items.length;t++)if(parseInt(this.items[t].id)===parseInt(e))return this.items[t]},validate:function(e){var t=!0;return e.find("[required]").each((function(){if(!$.trim($(this).val()))return $(this).focus(),t=!1,!1;t=!0})),t&&e.addClass("processing"),t},setUrl:function(){$('[name="stream"]').val(this.url),playImport(this.url,{},(function(e){var t=new Waveform;if(e.title&&$('[name="title"]').val(e.title),e.description&&$('[name="content"]').val(e.description),e.duration&&$('[name="duration"]').val(t.msToTime(e.duration)),e.tags&&$('[name="tag"]').val(e.tags),e.publishedAt&&$('[name="post_date"]').val(new Date(e.publishedAt).toLocaleDateString("sv-SE")),e.stream_url&&$('[name="upload"]').append('<input type="hidden" name="stream_url" value="'+e.stream_url+'"/>'),e.waveform_data&&($('[name="upload"] [name="waveform"]').remove(),$('[name="upload"]').append('<input type="hidden" name="waveform" value="'+e.waveform_data+'"/>')),e.blob){var i=new DataTransfer;i.items.add(e.blob),$('.file-upload input[name="image"]')[0].files=i.files,e.artwork_url&&($(".file-upload img").attr("src",e.artwork_url),$(".file-upload input").removeAttr("required"))}}))},sortable:function(){var e=this;$(".track-list").length&&sortable(".track-list",{handle:".handle"})[0].addEventListener("sortupdate",(function(t){e.updateList()}))},updateList:function(){var e=$(".track-list li[id]").map((function(){return this.id})).get();$('[name="post"]').val(e.join())},import:function(url,obj,callback){var proxyServer=play.rest.endpoints.proxy+"?url=",server="";-1!==url.indexOf("soundcloud.com")&&(server="soundcloud",url=proxyServer+url),-1!==url.indexOf("mixcloud.com")&&(server="mixcloud",url=url.replace("https://www.mixcloud.com/","https://api.mixcloud.com/")),-1!==url.indexOf("hearthis.at")&&(server="hearthis",url=url.replace("https://hearthis.at/","https://api-v2.hearthis.at/")),url=url.replace("/shorts/","/embed/"),url.match(/(http:|https:|)\/\/(player.|www.|music.|m.)?(vimeo\.com|youtu(be\.com|\.be|be\.googleapis\.com))\/(video\/|embed\/|watch\?v=|v\/)?([A-Za-z0-9._%-]*)(\&\S+)?/),RegExp.$3.indexOf("youtu")>-1&&(server="youtube",url="https://www.googleapis.com/youtube/v3/videos?id="+RegExp.$6+"&key="+play.youtube_api_key+"&part=snippet,contentDetails,statistics,status"),RegExp.$3.indexOf("vimeo")>-1&&(server="vimeo",url="https://vimeo.com/api/v2/video/"+RegExp.$6+".json"),obj.url=url,$.ajax(obj).then((function(data){if($.isArray(data)&&(data=data[0]),"soundcloud"==server){var m=data.match(/window\.__sc_hydration = (.*);<\/script>/);if(m)for(var n=eval(m[1]),i=0;i<n.length;i++)if("sound"===n[i].hydratable){data=n[i].data;var tags=data.tag_list.match(/\w+|"[^"]+"/g);tags&&(data.tags=tags.join(", ").replaceAll('"',""))}}if("hearthis"==server&&(data.duration=1e3*data.duration,data.artwork_url=proxyServer+data.artwork_url),"mixcloud"==server&&(data=JSON.parse(data),data.title=data.name,data.artwork_url=data.pictures.extra_large,data.duration=1e3*data.audio_length,data.tags)){var tags=data.tags.map((function(e){return e.name}));data.tags=tags.join(", ")}"soundcloud"==server&&data.artwork_url&&(data.artwork_url=data.artwork_url.replace("-large","-t500x500")),"vimeo"==server&&(data.duration=1e3*data.duration,data.artwork_url=data.thumbnail_large);var WF=new Waveform;if("youtube"==server&&data.items){var item=data.items[0];data.title=item.snippet.title,data.description=item.snippet.description,data.artwork_url=proxyServer+(item.snippet.thumbnails.maxres?item.snippet.thumbnails.maxres.url:item.snippet.thumbnails.standard.url),data.duration=WF.timeToMS(item.contentDetails.duration),data.publishedAt=item.snippet.publishedAt,data.tags=item.snippet.tags}if(callback&&(data.type="single",callback(data)),data.artwork_url){var xhr=new XMLHttpRequest;xhr.onload=function(){var e=new FileReader;e.onloadend=function(){for(var t=e.result.split(","),i=t[1].replace(/\s/g,""),r=t[0].split(":")[1].split(";")[0],n=atob(i),a=n.length,s=new Uint8Array(a);a--;)s[a]=n.charCodeAt(a);var o=data.title+"."+r.replace("image/",""),l=new File([s],o,{type:r}),d={};d.blob=l,d.artwork_url=data.artwork_url,callback&&callback(d)},e.readAsDataURL(xhr.response)},xhr.open("GET",data.artwork_url),xhr.responseType="blob",xhr.send()}if(data.waveform_url){var obj={},url=data.waveform_url.replace(".png",".json"),d=[];data.waveform_data&&(url=data.waveform_data),"hearthis"==server&&(url=proxyServer+url),obj.url=url,$.ajax(obj).then((function(data){var obj={};d=data.samples?data.samples:eval(data),obj.waveform_data=WF.resizeData(d,WF.options.waveLength),callback&&callback(obj)}))}}))}};function redirect(e){void 0!==typeof Pjax&&-1===e.toLowerCase().indexOf("reload")?$(document).trigger("reload",[e]):location.href=e}upload.init(),window.playImport=upload.import;var timeoutID=null;function search(e){var t=e.parent().find(".dropdown-menu"),i=e.val();$.ajax({url:play.rest.endpoints.search,datatype:"json",type:"get",data:{search:i},beforeSend:function(){t.html("")}}).then((function(i){var r="";$.each(i,(function(e,t){r+='<a class="dropdown-item '+("user"==t.type?"dropdown-user":"")+'" href="'+t.url+'">'+t.thumbnail+"<span><span>"+t.title+'</span><span class="author">'+t.author+"</span></span></a>"})),e.parent().removeClass("search-loading"),t.append(r),$(document).trigger("refresh")}))}if($(document).on("click","#icon-search",(function(e){setTimeout((function(){$('[name="s"]').focus()}),0)})),$(document).on("keyup","#header-search-form input, .search-form input",(function(e){var t=$(this);t.val().length<1||(t.parent().addClass("search-loading"),t.parent().find(".dropdown-menu").dropdown("show"),clearTimeout(timeoutID),timeoutID=setTimeout((function(){search(t)}),1e3))})),$(document).on("keypress","#header-search-form input, .search-form input",(function(e){13==e.which&&$(this).blur().parent().find(".dropdown-menu").dropdown("hide")})),$(document).on("click","#header-search-form .dropdown-item",(function(e){$(this).parent(".dropdown-menu").dropdown("hide")})),$(document).on("click",".btn-comment",(function(e){if($("body").addClass("open-comment"),$(this).closest(".block-loop-items").length>0){var t=$(this).attr("data-comment-id");$("#ajax-comment").remove(),getModal("#ajax-comment",{name:"comment",post_id:t},callPlugin)}})),$(document).on("click",".comments-backdrop, .comments-title .close",(function(e){$("body").removeClass("open-comment"),$("#ajax-comment").modal("hide")})),$(document).on("click","#commentform #submit",(function(e){var t=$(this),i=t.closest("#commentform"),r=$("#comment").val(),n=parseInt($('[name="comment_post_ID"]').val()),a=$('<div class="comment-message"></div>');if(""==$.trim(r))return!1;i.find(".comment-message").remove(),a.insertBefore(".comment-form-comment"),t.prop("disabled",!0);var s=i.serialize(),o=i.attr("action");return $.ajax({type:"post",url:o,data:s,error:function(e,r,n){var a=e.responseText.match(/<body id="error-page">([\s\S^<]*?)<\/body>/);i.find(".comment-message").html("").append(a[0]).addClass("error"),t.prop("disabled",!1),i.removeClass("processing")}}).then((function(e,r,a){t.prop("disabled",!1);var s=e.match(/<body id="error-page">([\s\S^<]*?)<\/body>/);if(s)i.find(".comment-message").html("").append(s[0]).addClass("error");else{var o=play.rest.endpoints.modal;$.ajax({type:"GET",url:o,data:{name:"comment",post_id:n},beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",play.nonce)}}).then((function(e){e&&($("#comments").replaceWith(e.content),window.dispatchEvent(new CustomEvent("call:plugin")))}))}})),!1})),"undefined"!=typeof EventTarget){var func=EventTarget.prototype.addEventListener;EventTarget.prototype.addEventListener=function(e,t,i){this.func=func,"boolean"!=typeof i&&((i=i||{}).passive=!1),this.func(e,t,i)}}var popper=null,popper_el="dropdown-more";function destory_popper(){popper&&(popper.destroy(),popper=null)}$(document).on("click",".btn-more",(function(e){e.preventDefault(),e.stopPropagation(),destory_popper();var t=$(this).closest("[data-play-id]").attr("data-play-id")||$(this).attr("data-id"),i=$("#"+popper_el);i.length>0?(i.attr("data-play-id",t),i.html(play.el_more)):(i=$('<div id="'+popper_el+'" class="dropdown-menu" data-window data-play-id="'+t+'">'+play.el_more+'</div><div class="dropdown-backdrop"></div>'),$("body").append(i));var r=i.find(".btn-edit, .btn-remove");play.is_user_logged_in&&"true"==$(this).attr("data-editable")?r.each((function(){var e=play.edit_url+t+"&action="+$(this).attr("data-action");$(this).attr("data-url",e)})):r.remove(),("false"==$(this).attr("data-playable")||$(this).closest(".block-loop-short-item").length>0||$(this).closest(".header-station").length>0&&$("body.single-station .plyr-theme-video").length>0)&&i.find(".btn-next-play, .btn-queue, .btn-play-now, .dropdown-divider").remove();var n=$(this).attr("data-type");"playlist"!=n&&"album"!=n||i.find(".btn-playlist").remove(),"user"==n&&(i.find(".btn-playlist").remove(),i.find(".btn-next-play, .btn-queue, .btn-play-now").attr("data-user-id",t)),i.find(".btn-like").attr("data-id",t),i.find(".btn-share").attr("data-share-type",n).attr("data-url",$(this).attr("data-url")).attr("data-embed-url",$(this).attr("data-embed-url")),popper=new Popper($(this),i,{modifiers:{preventOverflow:{enabled:!0}}}),i.addClass("show"),$("body").addClass("dropdown-open")})),$(document).on("click",(function(e){destory_popper(),$("#"+popper_el).removeClass("show"),$("body").removeClass("dropdown-open")})),$(document).on("click",".btn-delete-account",(function(e){e.preventDefault(),getModal("#remove-modal",{name:"delete-account"})})),$(document).on("click",'#your-profile [type="submit"]',(function(e){e.preventDefault();var t=$(this).closest("form"),i=new FormData(t[0]),r=".form-message";return $(r,t).html(""),t.addClass("processing"),$.ajax({url:play.rest.endpoints.profile,data:i,type:"POST",processData:!1,contentType:!1,cache:!1,beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",play.nonce)}}).then((function(e){"success"==e.status?($(r,t).first().append('<div class="success">'+e.msg+"</div>"),redirect(location.href)):"error"==e.status&&$(r,t).first().append('<div class="error">'+e.msg+"</div>"),t.removeClass("processing")})).fail((function(){t.removeClass("processing"),redirect(location.href)})),!1})),$(document).on("click",".btn-like, .btn-follow",(function(e){if(play.is_user_logged_in){e.preventDefault();var t=$(this),i=t.attr("data-id"),r=t.attr("data-action"),n=t.attr("data-type");t.attr("disabled","disabled"),$.ajax({url:play.rest.endpoints[r],datatype:"json",type:"get",data:{type:n,action:r,nonce:play.nonce,id:i,url:location.href},beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",play.nonce)}}).then((function(e){if(t.attr("disabled",!1),e.error)e.url;else{var a=$('[data-id="'+i+'"][data-action="'+r+'"][data-type="'+n+'"]');1==e.status?a.addClass("active"):a.removeClass("active"),t.find(".count").text(e.count),$(document).trigger(r+".play",[i,e.status,e.type])}}))}})),$(document.body).on("click",".edd-add-to-cart",(function(e){if(edd_scripts&&edd_scripts.ajaxurl&&play.rest.endpoints.cart){var t=edd_scripts.ajaxurl;edd_scripts.ajaxurl=play.rest.endpoints.cart,setTimeout((function(){edd_scripts.ajaxurl=t}),500)}})),$(document.body).on("click",".edd-reviews-star-rating",(function(){$(".edd-reviews-stars-filled").width(25*$(this).attr("data-rating")),$("input#edd-reviews-star-rating").val($(this).attr("data-rating"))})),$(document.body).on("click",".edd_review .comment-reply-link",(function(){return $("#edd-reviews-respond").hide(),$("#edd-reviews-reply").show(),!1})),$(document.body).on("click",".edd-reviews-review-form-submit",(function(e){var t=$(this),i=t.closest("form"),r=!0;if(i.find('input[name="edd-reviews-review-rating"], [required]').each((function(){var e=$(this);if(!$.trim(e.val()))return e.focus(),r=!1,!1;r=!0})),!r)return!1;i.addClass("processing"),t.prop("disabled",!0);var n=new FormData(i[0]);return $.ajax({url:play.rest.endpoints.review,data:n,type:"POST",processData:!1,contentType:!1,cache:!1}).then((function(e){i.removeClass("processing"),t.prop("disabled",!1),$(document).trigger("reload",[window.location.href.replace(window.location.hash,"")+"#edd-reviews"])})).fail((function(){})),!1}));var pwdmeter={el:"#login-form",el_field:"",el_strength:".pwd-strength",el_hint:".pwd-hint",init:function(){var e=this;$(document).on("keyup change",'#registerform [name="pwd"], #resetpasswordform [name="pwd"]',e.strengthMeter),$('#resetpasswordform [name="pwd"]').trigger("change"),$(document).on("click",".btn-toggle-pwd",e.toggle),$(document).on("click",".btn-generate-pwd",e.generatePwd),e.toggleBtn(),$(document).on("pjax:complete loginModal:loaded",(function(){e.toggleBtn()}))},toggleBtn:function(){$('[type="password"]:not(".is-toggled")').addClass("is-toggled").after('<button type="button" class="button btn-toggle-pwd"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-eye"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z" class="eye-on"></path><circle cx="12" cy="12" r="3" class="eye-on"></circle><path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24" class="eye-off"></path><line x1="1" y1="1" x2="23" y2="23" class="eye-off"></line></svg></button>')},toggle:function(){var e=$(this).prev("input"),t="password"==e.attr("type")?"text":"password";e.attr("type",t)},includeMeter:function(e,t){var i=e.find(this.el_strength);""===t.val()?(i.hide(),$(document).trigger("pwd-strength-hide")):0===i.length?(t.parent().after('<p class="pwd-strength" aria-live="polite"></p>'),$(document).trigger("pwd-strength-added")):(i.show(),$(document).trigger("pwd-strength-show"))},strengthMeter:function(){var e,t=$(this),i=t.closest("form"),r=$('button[type="submit"]',i),n=t.val();pwdmeter.includeMeter(i,t),e=pwdmeter.checkPasswordStrength(i,t),n.length>0&&e<play.min_password_strength&&-1!==e?r.attr("disabled","disabled").addClass("disabled"):r.prop("disabled",!1).removeClass("disabled")},checkPasswordStrength:function(e,t){var i=e.find(this.el_strength),r=e.find(this.el_hint),n='<p class="pwd-hint">'+play.i18n.pwd.hint+"</p>",a=pwdmeter.meter(t.val());if(i.removeClass("short bad good strong"),r.remove(),i.is(":hidden"))return a;switch(a){case 0:i.addClass("short").html(play.i18n.pwd.short+""),i.after(n);break;case 1:case 2:i.addClass("bad").html(play.i18n.pwd.bad+""),i.after(n);break;case 3:i.addClass("good").html(play.i18n.pwd.good+"");break;case 4:i.addClass("strong").html(play.i18n.pwd.strong+"");break;case 5:i.addClass("short").html(play.i18n.pwd.mismatch)}return a},generatePwd:function(){var e=$(this);$.ajax({url:play.rest.endpoints.generatepwd,type:"GET",processData:!1,contentType:!1,cache:!1}).then((function(t){var i=e.closest("form").find('[name="pwd"]');i.val(t.data),i.trigger("change")}))},meter:function(e,t){return e!=t&&t&&t.length>0?5:void 0===window.zxcvbn?-1:zxcvbn(e,[]).score}};pwdmeter.init();var login={el:"#login-form",el_modal:"#login-modal",el_msg:".form-message",btn:null,action:"login",init:function(){this.initEvents()},initEvents:function(){var e=this;$(document).on("click",".btn-like, .btn-playlist, .btn-follow, .btn-ajax-login, .btn-ajax-register, .btn-ajax-login a, .btn-ajax-register a",(function(t){play.is_user_logged_in||(t.preventDefault(),e.action=$(this).hasClass("btn-ajax-register")||$(this).parent().hasClass("btn-ajax-register")?"register":"login",e.showModal())})),$(document).on("click",e.el+' a[class*="btn-"]',(function(t){t.preventDefault();var i=$(this).attr("href");e.action=e.getURLParameter(i,"action"),e.showForm()})),$(document).on("click",e.el+' button[type="submit"]',(function(t){t.preventDefault(),e.btn=$(this),e.ajaxForm()})),$(document).on("require_login",(function(t){play.is_user_logged_in||e.showModal()}))},showModal:function(){var e=this;"1"!=play.disable_login_modal?$(e.el).length>0&&0==$(e.el).closest(e.el_modal).length||(this.showForm=this.showForm.bind(this),getModal(e.el_modal,{name:"login_form"},e.showForm)):redirect(play.login_url)},getURLParameter:function(e,t){return(RegExp(t+"=(.+?)(&|$)").exec(e)||[,null])[1]},ajaxForm:function(){var e=this,t=$(e.btn).closest("form"),i=!0;t.find('[name="redirect_to"]').val();if(e.action=t.find('[name="form-action"]').val(),$(e.el_msg,e.el).html(""),t.find('input[type="text"], input[type="password"], input[type="email"], [required]').each((function(){var e=$(this);if("user_login"==e.attr("name")){var t=e.val().toLowerCase();e.val(t)}if("pass2"==e.attr("name")){t=document.querySelector("#pass1").value;e.val(t)}if(!$.trim(e.val())||"email"==e.attr("type")&&!/^([a-zA-Z0-9_.+-])+\@(([a-zA-Z0-9-])+\.)+([a-zA-Z0-9]{2,4})+$/.test(e.val()))return e.focus(),i=!1,!1;i=!0})),!i)return!1;t.addClass("processing"),e.btn.prop("disabled",!0);var r=new FormData(t[0]);$.ajax({url:play.rest.endpoints.auth,data:r,type:"POST",processData:!1,contentType:!1,cache:!1}).then((function(i){t.removeClass("processing"),e.btn.prop("disabled",!1),t.find('input[type="text"], input[type="email"], input[type="password"]').val(""),"error"==i.status?($(document).trigger("login:error"),$(e.el_msg,t).first().append('<div class="error">'+i.msg+"</div>")):"success"==i.status&&($(document).trigger("login:success"),$(e.el_msg,t).first().append('<div class="success">'+i.msg+"</div>"),"register"==e.action&&$(e.el_msg,t).nextAll("p").addClass("hideme").hide(),setTimeout((function(){var t=$(e.btn).closest(".modal");if(t.length){var r=window.location.href;i.redirect.indexOf("reload")>-1&&(r+="?reload"),i.redirect=r,t.modal("hide")}i.nonce&&""!==i.nonce&&play&&(play.is_user_logged_in=!0,play.nonce=i.nonce),i.redirect&&redirect(i.redirect)}),play.rest.timeout_redirect))})).fail((function(){location.reload()}))},showForm:function(){var e=this,t=$(e.el+" #"+e.action+"form");t.length&&($(e.el_msg,e.el).html(""),$(e.el+" form").hide(),t.find(".hideme").show(),t.show()),$(document).trigger("loginModal:loaded")}};login.init();var playlist={id:0,data:[],el:"#playlist-modal",btn:null,link:"",init:function(){var e=this;this.r=this.r.bind(this),this.setLink=this.setLink.bind(this),$(document).on("click",".btn-playlist",(function(t){if(play.is_user_logged_in){t.preventDefault();var i=$(this).closest("[data-play-id]").attr("data-play-id");i&&(e.id=i),getModal(e.el,{name:"playlist"},e.r),$(e.el).find("form").show()}})),$(document).on("click",e.el+" .btn-new",(function(t){t.preventDefault(),e.btn=$(this),e.c()})),$(document).on("click",e.el+" .btn-remove",(function(t){t.preventDefault(),e.btn=$(this),e.d()})),$(document).on("click",e.el+" .btn-add, "+e.el+" .btn-added",(function(t){t.preventDefault(),e.btn=$(this),e.u()})),$(document).on("click",e.el+" a",(function(e){$(e.target).closest(".modal").modal("hide")})),$(document).on("click",".btn-remove",(function(t){t.preventDefault(),e.link=$(this).attr("data-url"),getModal("#remove-modal",{name:"remove"},e.setLink)}))},c:function(){var e=this,t=$(e.el).find("form"),i=t.find("input");""!=$.trim(i.val())&&(e.btn.prop("disabled","disabled"),$.ajax({type:"GET",dataType:"json",url:play.rest.endpoints.playlist,data:{nonce:play.nonce,post_id:e.id,title:i.val(),type:"c"},beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",play.nonce)}}).then((function(r){e.data.unshift(r.data),t.hide(),e.btn.prop("disabled",!1),i.val(""),e.render()})))},r:function(){var e=this;$.ajax({type:"GET",dataType:"json",url:play.rest.endpoints.playlist,data:{nonce:play.nonce,post_id:e.id,type:"r"},beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",play.nonce)}}).then((function(t){"success"==t.status&&(e.data=t.data,e.render())}))},u:function(){var e=this,t=e.btn.closest("[data-play-id]").attr("data-play-id"),i=e.getObj(t,e.data);e.btn.prop("disabled","disabled"),e.btn.is(".btn-add")?i.post.push(e.id):i.post.splice($.inArray(e.id,i.post),1),$.ajax({type:"GET",dataType:"json",url:play.rest.endpoints.playlist,data:{nonce:play.nonce,post_id:t,post:i.post,type:"u"},beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",play.nonce)}}).then((function(t){e.btn.prop("disabled",!1),"success"==t.status&&e.render()}))},d:function(){var e=this,t=e.btn.closest("[data-play-id]").attr("data-play-id");e.btn.prop("disabled","disabled"),$.ajax({type:"GET",dataType:"json",url:play.rest.endpoints.playlist,data:{nonce:play.nonce,post_id:t,type:"d"},beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",play.nonce)}}).then((function(i){e.btn.prop("disabled",!1),"success"==i.status&&($.each(e.data,(function(i,r){if(t==e.data[i].id)return e.data.splice(i,1),!1})),e.render())}))},render:function(){var e=this,t=$(e.el+" .block-loop-items");t.empty(),$.each(e.data,(function(i,r){var n=$("#tpl-item").clone();n.attr("id","").attr("style",""),n.attr("data-play-id",r.id),r.thumb&&n.find("img").attr("src",r.thumb),n.find(".entry-title").html(r.title).attr("href",r.url),n.find(".count").html(r.post.length),n.find(".post-thumbnail a").attr("href",r.url),n.find(".btn-add, .btn-added").hide(),e.id>0&&(-1!==$.inArray(e.id,r.post)?(n.find(".btn-add").hide(),n.find(".btn-added").show()):(n.find(".btn-added").hide(),n.find(".btn-add").show())),$(t).append(n)})),$(document).trigger("refresh")},getObj:function(e,t){var i=!1;return $.each(t,(function(r,n){e!=t[r].id||(i=t[r])})),i},setLink:function(){$("[data-remove]").attr("href",this.link)}};playlist.init();var share={el:"#share-modal",el_embed:".share-embed",el_url:"#share-url",link:"",embed:"",type:"",init:function(){var e=this;this.setUrl=this.setUrl.bind(this),$(document).on("click",".btn-share",(function(t){var i=$(e.el_embed).find("iframe");if(i.length>0){var r=i[0].outerHTML;i.remove(),$(e.el_embed).append(r)}e.type=$(this).attr("data-share-type"),e.link=$(this).attr("data-url")||$(this).parent().prev().attr("data-url"),e.embed=$(this).attr("data-embed-url"),e.link||(e.link=location.href),getModal(e.el,{name:"share"},e.setUrl,e.close)})),$(document).on("click","#share-url, #embed-code",(function(e){$(this).select(),document.execCommand("copy")}))},setUrl:function(){var e=this;$(".share-list a").each((function(t){$(this).attr("href",$(this).attr("data-url")+encodeURIComponent(e.link))})),$(e.el_url).val(e.link),$(".share-embed iframe").length>0&&($(".share-embed iframe").attr("src",e.embed).attr("type",e.type),$("#embed-code").val($(".share-embed iframe")[0].outerHTML))},close:function(){$(".share-embed iframe").attr("src"," ")}};share.init();var notification={inter:play.rest.timeout_notify,timeout:null,el:"#dropdown-notification",init:function(){this.initEvent(),play.is_user_logged_in&&this.getNotification()},initEvent:function(){var e=this;$(document).on("click",e.el,(function(t){e.getNotification()}))},getNotification:function(){var e=this;clearTimeout(e.timeout),$.ajax({url:play.rest.endpoints.notification,type:"GET",beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",play.nonce)}}).then((function(t){$(".dropdown-notification-list").html(t.content),$(document).trigger("refresh");var i=$(t.content).find(".is-new").length;i>0?$(e.el).find(".count").html(i):$(e.el).find(".count").html(""),setTimeout((function(){e.getNotification()}),e.inter)}))}};notification.init();var callPlugin=function(){window.dispatchEvent(new CustomEvent("call:plugin"))},getModal=function(e,t,i,r){if($(e).length)i&&i();else{var n=$('<div class="modal fade modal-loading" id="'+e.substr(1)+'"><div class="modal-dialog"><div class="modal-content"><div class="modal-body"><div class="spinner"></div></div></div></div></div>');$("body").append(n);var a=play.rest.endpoints.modal;$.ajax({type:"GET",url:a,data:t,beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",play.nonce)}}).then((function(t){t?(n.removeClass("modal-loading").find(".modal-content").html(t.content),i&&i()):$(e).modal("hide")}))}$(e).modal("show"),$(e).on("hidden.bs.modal",(function(e){r&&r()})),$(document).trigger("modal:loaded")}}(jQuery,window),window.playlist=!1,function($){"use strict";function createPlyr(e){if(playlist)return playlist;if(play.is_user_logged_in||"1"!=play.login_to_play){$('<div class="plyr-playlist player fixed-bottom" id="plyr-playlist"><audio playsinline id="player"></audio></div>').appendTo("body");return $("html").addClass("open-player"),playlist=new Playlist({playlist:"#plyr-playlist",player:"#player"},e,{theme:play.player_theme,timeoutCount:play.rest.timeout_count,iconUrl:play.url+"libs/plyr/plyr.svg",blankVideo:play.url+"libs/plyr/blank.mp4",history:play.player_history,adsInterval:play.ad_interval?play.ad_interval:3,ads:{enabled:!!play.ad_tagurl,tagUrl:play.ad_tagurl},i18n:play.i18n,autoplay:!1,playsinline:!0,debug:!1}),playlist.player.on("timeupdate",(function(e){var t=playlist.getCurrent();if(t){var i=playlist.player.currentTime/playlist.player.duration,r=$(".waveform .waveform_wrap"),n=$('[data-id="'+t.id+'"].waveform_wrap');r.not(n).trigger("timeupdate",0),n&&i&&n.trigger("timeupdate",[i,playlist.player.paused])}})),playlist}$(document).trigger("require_login")}function waveform(){$(".waveform").each((function(){var $this=$(this),$color=$this.css("color"),$data=$this.attr("data-waveform");if($data){$data=eval("["+$data+"]");var opt={container:$this.find(".waveform-container"),id:$this.attr("data-id"),duration:$this.attr("data-duration")},wf=new Waveform($.extend(!0,{},opt,play.waveform_option));wf.load($data),$(wf.wrap).on("update",(function(e,t,i){playlist&&(i==playlist.getCurrent().id&&(playlist.player.currentTime=playlist.player.duration*t))})),$this.removeAttr("data-waveform")}}))}function init(){$.fn.popover&&$('[data-toggle="popover"]').popover(),$.fn.tooltip&&$('[data-toggle="tooltip"]').tooltip(),waveform(),shortPlay()}function startShortPlay(){$(".block-loop-short-item").first().find("[data-play-id]").trigger("click")}function shortPlay(){var e=$(".block-loop-short-item"),t="plyr-scrolling";if(0!=e.length){e.parent().css("height",e.parent().height());var i=window,r=getComputedStyle(e.parent()[0]).getPropertyValue("overflow-y");"scroll"!=r&&"auto"!=r||(i=e.parent()[0]),i.addEventListener("scroll",debounce((function(){for(var r=0;r<e.length;r++){var n=isVisible(e[r],i),a=e[r];n&&!a.inView&&(a.inView=!0,$(e[r]).find("[data-play-id]").trigger("click"),setTimeout((function(){resizeShortPlay(),$(".plyr-short").removeClass(t)}),1e3)),!n&&a.inView&&(a.inView=!1)}}),100),!1),i.addEventListener("scroll",(function(){$(".plyr-short").addClass(t)})),window.addEventListener("resize",debounce(resizeShortPlay,100),!1)}}function resizeShortPlay(){var e=$(".block-loop-short-item");if(0!=e.length){var t=e.parent().offset().top,i=e[0].getBoundingClientRect();$(".plyr-short").css("--top",t+"px").css("--left",i.left+"px").css("--width",i.width+"px").css("--height",i.height+"px")}}function isVisible(e,t,i){var r=e.offsetTop,n=r+e.clientHeight,a=t.pageYOffset?t.pageYOffset:t.scrollTop,s=a+(t.pageYOffset?t.innerHeight:t.clientHeight);return r>=a&&n<=s||i&&(r<a&&n>a||n>s&&r<s)}function debounce(e,t,i){var r,n;return function(){var a,s,o=this,l=arguments;return a=function(){r=null,i||(n=e.apply(o,l))},s=i&&!r,clearTimeout(r),r=setTimeout(a,t),s&&(n=e.apply(o,l)),n}}$(document).on("click.play",".btn-play, .btn-play-now, .btn-next-play, .btn-queue",(function(e){if(e.preventDefault(),createPlyr([]),playlist){var t=$(this).closest("[data-play-id]").attr("data-play-id")||$(this).attr("data-user-id"),i=$(this).attr("data-user-id")?"user":"post",r=$(this).closest(".is-album").attr("data-play-id")||$(this).closest(".is-playlist").attr("data-play-id"),n=$(this).attr("data-index")||0,a=[];if($(this).hasClass("active"))playlist.pause();else if($(this).closest(".block-loop-short-item").length>0?(playlist.repeat=!0,$(".plyr-playlist").addClass("plyr-short"),resizeShortPlay()):(playlist.repeat=!1,$(".plyr-playlist").removeClass("plyr-short")),"post"==i&&playlist.getIndex(t)>-1)playlist.play({id:t},n);else{var s=play.rest.endpoints.play+"/"+t,o={type:i};if($(this).closest(".album-tracks").length&&r&&(o.from=r,n=$(this).closest(".album-track").index()),$(".btn-play[data-play-id="+t+"]").hasClass("btn-play-auto")||$(this).closest(".album-tracks").length&&$(".btn-play-auto").length){a=[];$(".album-track").each((function(e,t){a.push(parseInt($(t).attr("data-play-id")))})),o.ids=a}$.ajax({url:s,type:"get",datatype:"json",data:o,beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",play.nonce)}}).then((function(e){playlist.play(e,n)}))}}})),$(document).on("playlist",(function(e){createPlyr()})),$(document).on("player_preview_end",(function(e){$(document).trigger("require_login")})),$(document).on("pjax:end, refresh",(function(e){init()})),$(window).on("load",(function(){init();try{if($(".no-player").length>0)return;if(play.default_id){createPlyr(play.default_id);return}var e=localStorage.getItem("plyr");if(e&&(e=JSON.parse(e)).items.length>0&&play.player_history)createPlyr(e.items)}catch(e){}startShortPlay()})),$(document).on("like.play",(function(e,t,i,r){if(playlist&&"post"===r){var n=playlist.getItem(t);n&&(n.like=i)}})),$(document).on("complete.play",(function(e,t){var i=t.ids.slice(-1).pop(),r=play.rest.endpoints.play+"/"+i;$.ajax({url:r,type:"get",datatype:"json",data:{type:"next",ids:t.ids}}).then((function(e){!1!==e&&playlist.play(e,0)}))})),$(document).on("played",(function(e,t){var i=t.id,r=play.rest.endpoints.play+"/"+i;$.ajax({url:r,type:"get",datatype:"json",data:{type:"played",nonce:play.nonce},beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",play.nonce)}})})),$(document).on("pjax:complete",(function(){0==$(".block-loop-short-item").length&&(playlist&&(playlist.repeat=!1),$(".plyr-playlist").removeClass("plyr-short"))})),$(document).on("pjax:complete",(function(e){startShortPlay()}))}(jQuery);